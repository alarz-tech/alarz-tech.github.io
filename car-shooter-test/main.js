(()=>{var cy=Object.create;var Il=Object.defineProperty;var uy=Object.getOwnPropertyDescriptor;var dy=Object.getOwnPropertyNames;var py=Object.getPrototypeOf,fy=Object.prototype.hasOwnProperty;var pt=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),my=(r,t)=>{for(var e in t)Il(r,e,{get:t[e],enumerable:!0})},gy=(r,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of dy(t))!fy.call(r,s)&&s!==e&&Il(r,s,{get:()=>t[s],enumerable:!(i=uy(t,s))||i.enumerable});return r};var Pl=(r,t,e)=>(e=r!=null?cy(py(r)):{},gy(t||!r||!r.__esModule?Il(e,"default",{value:r,enumerable:!0}):e,r));var rd=pt((MC,Bl)=>{"use strict";var vy=Object.prototype.hasOwnProperty,ie="~";function zs(){}Object.create&&(zs.prototype=Object.create(null),new zs().__proto__||(ie=!1));function by(r,t,e){this.fn=r,this.context=t,this.once=e||!1}function ed(r,t,e,i,s){if(typeof e!="function")throw new TypeError("The listener must be a function");var o=new by(e,i||r,s),n=ie?ie+t:t;return r._events[n]?r._events[n].fn?r._events[n]=[r._events[n],o]:r._events[n].push(o):(r._events[n]=o,r._eventsCount++),r}function xn(r,t){--r._eventsCount===0?r._events=new zs:delete r._events[t]}function Yt(){this._events=new zs,this._eventsCount=0}Yt.prototype.eventNames=function(){var t=[],e,i;if(this._eventsCount===0)return t;for(i in e=this._events)vy.call(e,i)&&t.push(ie?i.slice(1):i);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t};Yt.prototype.listeners=function(t){var e=ie?ie+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,o=i.length,n=new Array(o);s<o;s++)n[s]=i[s].fn;return n};Yt.prototype.listenerCount=function(t){var e=ie?ie+t:t,i=this._events[e];return i?i.fn?1:i.length:0};Yt.prototype.emit=function(t,e,i,s,o,n){var a=ie?ie+t:t;if(!this._events[a])return!1;var l=this._events[a],h=arguments.length,c,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,i),!0;case 4:return l.fn.call(l.context,e,i,s),!0;case 5:return l.fn.call(l.context,e,i,s,o),!0;case 6:return l.fn.call(l.context,e,i,s,o,n),!0}for(u=1,c=new Array(h-1);u<h;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var d=l.length,p;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,i);break;case 4:l[u].fn.call(l[u].context,e,i,s);break;default:if(!c)for(p=1,c=new Array(h-1);p<h;p++)c[p-1]=arguments[p];l[u].fn.apply(l[u].context,c)}}return!0};Yt.prototype.on=function(t,e,i){return ed(this,t,e,i,!1)};Yt.prototype.once=function(t,e,i){return ed(this,t,e,i,!0)};Yt.prototype.removeListener=function(t,e,i,s){var o=ie?ie+t:t;if(!this._events[o])return this;if(!e)return xn(this,o),this;var n=this._events[o];if(n.fn)n.fn===e&&(!s||n.once)&&(!i||n.context===i)&&xn(this,o);else{for(var a=0,l=[],h=n.length;a<h;a++)(n[a].fn!==e||s&&!n[a].once||i&&n[a].context!==i)&&l.push(n[a]);l.length?this._events[o]=l.length===1?l[0]:l:xn(this,o)}return this};Yt.prototype.removeAllListeners=function(t){var e;return t?(e=ie?ie+t:t,this._events[e]&&xn(this,e)):(this._events=new zs,this._eventsCount=0),this};Yt.prototype.off=Yt.prototype.removeListener;Yt.prototype.addListener=Yt.prototype.on;Yt.prefixed=ie;Yt.EventEmitter=Yt;typeof Bl<"u"&&(Bl.exports=Yt)});var ad=pt((RC,Nl)=>{"use strict";Nl.exports=_n;Nl.exports.default=_n;function _n(r,t,e){e=e||2;var i=t&&t.length,s=i?t[0]*e:r.length,o=sd(r,0,s,e,!0),n=[];if(!o||o.next===o.prev)return n;var a,l,h,c,u,d,p;if(i&&(o=Sy(r,t,o,e)),r.length>80*e){a=h=r[0],l=c=r[1];for(var f=e;f<s;f+=e)u=r[f],d=r[f+1],u<a&&(a=u),d<l&&(l=d),u>h&&(h=u),d>c&&(c=d);p=Math.max(h-a,c-l),p=p!==0?32767/p:0}return js(o,n,e,a,l,p,0),n}function sd(r,t,e,i,s){var o,n;if(s===Dl(r,t,e,i)>0)for(o=t;o<e;o+=i)n=id(o,r[o],r[o+1],n);else for(o=e-i;o>=t;o-=i)n=id(o,r[o],r[o+1],n);return n&&wn(n,n.next)&&(Hs(n),n=n.next),n}function Hr(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(wn(e,e.next)||vt(e.prev,e,e.next)===0)){if(Hs(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function js(r,t,e,i,s,o,n){if(r){!n&&o&&My(r,i,s,o);for(var a=r,l,h;r.prev!==r.next;){if(l=r.prev,h=r.next,o?wy(r,i,s,o):_y(r)){t.push(l.i/e|0),t.push(r.i/e|0),t.push(h.i/e|0),Hs(r),r=h.next,a=h.next;continue}if(r=h,r===a){n?n===1?(r=Ty(Hr(r),t,e),js(r,t,e,i,s,o,2)):n===2&&Cy(r,t,e,i,s,o):js(Hr(r),t,e,i,s,o,1);break}}}}function _y(r){var t=r.prev,e=r,i=r.next;if(vt(t,e,i)>=0)return!1;for(var s=t.x,o=e.x,n=i.x,a=t.y,l=e.y,h=i.y,c=s<o?s<n?s:n:o<n?o:n,u=a<l?a<h?a:h:l<h?l:h,d=s>o?s>n?s:n:o>n?o:n,p=a>l?a>h?a:h:l>h?l:h,f=i.next;f!==t;){if(f.x>=c&&f.x<=d&&f.y>=u&&f.y<=p&&Ii(s,a,o,l,n,h,f.x,f.y)&&vt(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function wy(r,t,e,i){var s=r.prev,o=r,n=r.next;if(vt(s,o,n)>=0)return!1;for(var a=s.x,l=o.x,h=n.x,c=s.y,u=o.y,d=n.y,p=a<l?a<h?a:h:l<h?l:h,f=c<u?c<d?c:d:u<d?u:d,m=a>l?a>h?a:h:l>h?l:h,x=c>u?c>d?c:d:u>d?u:d,y=kl(p,f,t,e,i),_=kl(m,x,t,e,i),g=r.prevZ,v=r.nextZ;g&&g.z>=y&&v&&v.z<=_;){if(g.x>=p&&g.x<=m&&g.y>=f&&g.y<=x&&g!==s&&g!==n&&Ii(a,c,l,u,h,d,g.x,g.y)&&vt(g.prev,g,g.next)>=0||(g=g.prevZ,v.x>=p&&v.x<=m&&v.y>=f&&v.y<=x&&v!==s&&v!==n&&Ii(a,c,l,u,h,d,v.x,v.y)&&vt(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;g&&g.z>=y;){if(g.x>=p&&g.x<=m&&g.y>=f&&g.y<=x&&g!==s&&g!==n&&Ii(a,c,l,u,h,d,g.x,g.y)&&vt(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;v&&v.z<=_;){if(v.x>=p&&v.x<=m&&v.y>=f&&v.y<=x&&v!==s&&v!==n&&Ii(a,c,l,u,h,d,v.x,v.y)&&vt(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Ty(r,t,e){var i=r;do{var s=i.prev,o=i.next.next;!wn(s,o)&&od(s,i,i.next,o)&&Vs(s,o)&&Vs(o,s)&&(t.push(s.i/e|0),t.push(i.i/e|0),t.push(o.i/e|0),Hs(i),Hs(i.next),i=r=o),i=i.next}while(i!==r);return Hr(i)}function Cy(r,t,e,i,s,o){var n=r;do{for(var a=n.next.next;a!==n.prev;){if(n.i!==a.i&&Ly(n,a)){var l=nd(n,a);n=Hr(n,n.next),l=Hr(l,l.next),js(n,t,e,i,s,o,0),js(l,t,e,i,s,o,0);return}a=a.next}n=n.next}while(n!==r)}function Sy(r,t,e,i){var s=[],o,n,a,l,h;for(o=0,n=t.length;o<n;o++)a=t[o]*i,l=o<n-1?t[o+1]*i:r.length,h=sd(r,a,l,i,!1),h===h.next&&(h.steiner=!0),s.push(Fy(h));for(s.sort(Ey),o=0;o<s.length;o++)e=Ay(s[o],e);return e}function Ey(r,t){return r.x-t.x}function Ay(r,t){var e=Iy(r,t);if(!e)return t;var i=nd(e,r);return Hr(i,i.next),Hr(e,e.next)}function Iy(r,t){var e=t,i=r.x,s=r.y,o=-1/0,n;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var a=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>o&&(o=a,n=e.x<e.next.x?e:e.next,a===i))return n}e=e.next}while(e!==t);if(!n)return null;var l=n,h=n.x,c=n.y,u=1/0,d;e=n;do i>=e.x&&e.x>=h&&i!==e.x&&Ii(s<c?i:o,s,h,c,s<c?o:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),Vs(e,r)&&(d<u||d===u&&(e.x>n.x||e.x===n.x&&Py(n,e)))&&(n=e,u=d)),e=e.next;while(e!==l);return n}function Py(r,t){return vt(r.prev,r,t.prev)<0&&vt(t.next,r,r.next)<0}function My(r,t,e,i){var s=r;do s.z===0&&(s.z=kl(s.x,s.y,t,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,Ry(s)}function Ry(r){var t,e,i,s,o,n,a,l,h=1;do{for(e=r,r=null,o=null,n=0;e;){for(n++,i=e,a=0,t=0;t<h&&(a++,i=i.nextZ,!!i);t++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,a--):(s=i,i=i.nextZ,l--),o?o.nextZ=s:r=s,s.prevZ=o,o=s;e=i}o.nextZ=null,h*=2}while(n>1);return r}function kl(r,t,e,i,s){return r=(r-e)*s|0,t=(t-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function Fy(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Ii(r,t,e,i,s,o,n,a){return(s-n)*(t-a)>=(r-n)*(o-a)&&(r-n)*(i-a)>=(e-n)*(t-a)&&(e-n)*(o-a)>=(s-n)*(i-a)}function Ly(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!By(r,t)&&(Vs(r,t)&&Vs(t,r)&&ky(r,t)&&(vt(r.prev,r,t.prev)||vt(r,t.prev,t))||wn(r,t)&&vt(r.prev,r,r.next)>0&&vt(t.prev,t,t.next)>0)}function vt(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function wn(r,t){return r.x===t.x&&r.y===t.y}function od(r,t,e,i){var s=bn(vt(r,t,e)),o=bn(vt(r,t,i)),n=bn(vt(e,i,r)),a=bn(vt(e,i,t));return!!(s!==o&&n!==a||s===0&&vn(r,e,t)||o===0&&vn(r,i,t)||n===0&&vn(e,r,i)||a===0&&vn(e,t,i))}function vn(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function bn(r){return r>0?1:r<0?-1:0}function By(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&od(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function Vs(r,t){return vt(r.prev,r,r.next)<0?vt(r,t,r.next)>=0&&vt(r,r.prev,t)>=0:vt(r,t,r.prev)<0||vt(r,r.next,t)<0}function ky(r,t){var e=r,i=!1,s=(r.x+t.x)/2,o=(r.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&s<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function nd(r,t){var e=new Ol(r.i,r.x,r.y),i=new Ol(t.i,t.x,t.y),s=r.next,o=t.prev;return r.next=t,t.prev=r,e.next=s,s.prev=e,i.next=e,e.prev=i,o.next=i,i.prev=o,i}function id(r,t,e,i){var s=new Ol(r,t,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function Hs(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Ol(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}_n.deviation=function(r,t,e,i){var s=t&&t.length,o=s?t[0]*e:r.length,n=Math.abs(Dl(r,0,o,e));if(s)for(var a=0,l=t.length;a<l;a++){var h=t[a]*e,c=a<l-1?t[a+1]*e:r.length;n-=Math.abs(Dl(r,h,c,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,p=i[a+1]*e,f=i[a+2]*e;u+=Math.abs((r[d]-r[f])*(r[p+1]-r[d+1])-(r[d]-r[p])*(r[f+1]-r[d+1]))}return n===0&&u===0?0:Math.abs((u-n)/n)};function Dl(r,t,e,i){for(var s=0,o=t,n=e-i;o<e;o+=i)s+=(r[n]-r[o])*(r[o+1]+r[n+1]),n=o;return s}_n.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,s=0;s<r.length;s++){for(var o=0;o<r[s].length;o++)for(var n=0;n<t;n++)e.vertices.push(r[s][o][n]);s>0&&(i+=r[s-1].length,e.holes.push(i))}return e}});var ld=pt((Pi,Mi)=>{(function(r){var t=typeof Pi=="object"&&Pi&&!Pi.nodeType&&Pi,e=typeof Mi=="object"&&Mi&&!Mi.nodeType&&Mi,i=typeof global=="object"&&global;(i.global===i||i.window===i||i.self===i)&&(r=i);var s,o=2147483647,n=36,a=1,l=26,h=38,c=700,u=72,d=128,p="-",f=/^xn--/,m=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=n-a,g=Math.floor,v=String.fromCharCode,U;function V(E){throw new RangeError(y[E])}function L(E,D){for(var q=E.length,rt=[];q--;)rt[q]=D(E[q]);return rt}function k(E,D){var q=E.split("@"),rt="";q.length>1&&(rt=q[0]+"@",E=q[1]),E=E.replace(x,".");var gt=E.split("."),St=L(gt,D).join(".");return rt+St}function X(E){for(var D=[],q=0,rt=E.length,gt,St;q<rt;)gt=E.charCodeAt(q++),gt>=55296&&gt<=56319&&q<rt?(St=E.charCodeAt(q++),(St&64512)==56320?D.push(((gt&1023)<<10)+(St&1023)+65536):(D.push(gt),q--)):D.push(gt);return D}function Z(E){return L(E,function(D){var q="";return D>65535&&(D-=65536,q+=v(D>>>10&1023|55296),D=56320|D&1023),q+=v(D),q}).join("")}function lt(E){return E-48<10?E-22:E-65<26?E-65:E-97<26?E-97:n}function Tt(E,D){return E+22+75*(E<26)-((D!=0)<<5)}function G(E,D,q){var rt=0;for(E=q?g(E/c):E>>1,E+=g(E/D);E>_*l>>1;rt+=n)E=g(E/_);return g(rt+(_+1)*E/(E+h))}function O(E){var D=[],q=E.length,rt,gt=0,St=d,xt=u,Xt,ae,te,le,Pt,Et,Mt,Wt,ee;for(Xt=E.lastIndexOf(p),Xt<0&&(Xt=0),ae=0;ae<Xt;++ae)E.charCodeAt(ae)>=128&&V("not-basic"),D.push(E.charCodeAt(ae));for(te=Xt>0?Xt+1:0;te<q;){for(le=gt,Pt=1,Et=n;te>=q&&V("invalid-input"),Mt=lt(E.charCodeAt(te++)),(Mt>=n||Mt>g((o-gt)/Pt))&&V("overflow"),gt+=Mt*Pt,Wt=Et<=xt?a:Et>=xt+l?l:Et-xt,!(Mt<Wt);Et+=n)ee=n-Wt,Pt>g(o/ee)&&V("overflow"),Pt*=ee;rt=D.length+1,xt=G(gt-le,rt,le==0),g(gt/rt)>o-St&&V("overflow"),St+=g(gt/rt),gt%=rt,D.splice(gt++,0,St)}return Z(D)}function bt(E){var D,q,rt,gt,St,xt,Xt,ae,te,le,Pt,Et=[],Mt,Wt,ee,Us;for(E=X(E),Mt=E.length,D=d,q=0,St=u,xt=0;xt<Mt;++xt)Pt=E[xt],Pt<128&&Et.push(v(Pt));for(rt=gt=Et.length,gt&&Et.push(p);rt<Mt;){for(Xt=o,xt=0;xt<Mt;++xt)Pt=E[xt],Pt>=D&&Pt<Xt&&(Xt=Pt);for(Wt=rt+1,Xt-D>g((o-q)/Wt)&&V("overflow"),q+=(Xt-D)*Wt,D=Xt,xt=0;xt<Mt;++xt)if(Pt=E[xt],Pt<D&&++q>o&&V("overflow"),Pt==D){for(ae=q,te=n;le=te<=St?a:te>=St+l?l:te-St,!(ae<le);te+=n)Us=ae-le,ee=n-le,Et.push(v(Tt(le+Us%ee,0))),ae=g(Us/ee);Et.push(v(Tt(ae,0))),St=G(q,Wt,rt==gt),q=0,++rt}++q,++D}return Et.join("")}function Ft(E){return k(E,function(D){return f.test(D)?O(D.slice(4).toLowerCase()):D})}function R(E){return k(E,function(D){return m.test(D)?"xn--"+bt(D):D})}if(s={version:"1.4.1",ucs2:{decode:X,encode:Z},decode:O,encode:bt,toASCII:R,toUnicode:Ft},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return s});else if(t&&e)if(Mi.exports==t)e.exports=s;else for(U in s)s.hasOwnProperty(U)&&(t[U]=s[U]);else r.punycode=s})(Pi)});var cd=pt((FC,hd)=>{"use strict";hd.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var n=Object.getOwnPropertyDescriptor(t,e);if(n.value!==s||n.enumerable!==!0)return!1}return!0}});var pd=pt((LC,dd)=>{"use strict";var ud=typeof Symbol<"u"&&Symbol,Oy=cd();dd.exports=function(){return typeof ud!="function"||typeof Symbol!="function"||typeof ud("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Oy()}});var gd=pt((BC,md)=>{"use strict";var fd={foo:{}},Dy=Object;md.exports=function(){return{__proto__:fd}.foo===fd.foo&&!({__proto__:null}instanceof Dy)}});var vd=pt((kC,xd)=>{"use strict";var Ny="Function.prototype.bind called on incompatible ",Uy=Object.prototype.toString,Gy=Math.max,zy="[object Function]",yd=function(t,e){for(var i=[],s=0;s<t.length;s+=1)i[s]=t[s];for(var o=0;o<e.length;o+=1)i[o+t.length]=e[o];return i},jy=function(t,e){for(var i=[],s=e||0,o=0;s<t.length;s+=1,o+=1)i[o]=t[s];return i},Vy=function(r,t){for(var e="",i=0;i<r.length;i+=1)e+=r[i],i+1<r.length&&(e+=t);return e};xd.exports=function(t){var e=this;if(typeof e!="function"||Uy.apply(e)!==zy)throw new TypeError(Ny+e);for(var i=jy(arguments,1),s,o=function(){if(this instanceof s){var c=e.apply(this,yd(i,arguments));return Object(c)===c?c:this}return e.apply(t,yd(i,arguments))},n=Gy(0,e.length-i.length),a=[],l=0;l<n;l++)a[l]="$"+l;if(s=Function("binder","return function ("+Vy(a,",")+"){ return binder.apply(this,arguments); }")(o),e.prototype){var h=function(){};h.prototype=e.prototype,s.prototype=new h,h.prototype=null}return s}});var Tn=pt((OC,bd)=>{"use strict";var Hy=vd();bd.exports=Function.prototype.bind||Hy});var wd=pt((DC,_d)=>{"use strict";var $y=Function.prototype.call,Xy=Object.prototype.hasOwnProperty,Wy=Tn();_d.exports=Wy.call($y,Xy)});var br=pt((NC,Ad)=>{"use strict";var et,Bi=SyntaxError,Ed=Function,Li=TypeError,Ul=function(r){try{return Ed('"use strict"; return ('+r+").constructor;")()}catch{}},$r=Object.getOwnPropertyDescriptor;if($r)try{$r({},"")}catch{$r=null}var Gl=function(){throw new Li},Yy=$r?function(){try{return arguments.callee,Gl}catch{try{return $r(arguments,"callee").get}catch{return Gl}}}():Gl,Ri=pd()(),qy=gd()(),Lt=Object.getPrototypeOf||(qy?function(r){return r.__proto__}:null),Fi={},Ky=typeof Uint8Array>"u"||!Lt?et:Lt(Uint8Array),Xr={"%AggregateError%":typeof AggregateError>"u"?et:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?et:ArrayBuffer,"%ArrayIteratorPrototype%":Ri&&Lt?Lt([][Symbol.iterator]()):et,"%AsyncFromSyncIteratorPrototype%":et,"%AsyncFunction%":Fi,"%AsyncGenerator%":Fi,"%AsyncGeneratorFunction%":Fi,"%AsyncIteratorPrototype%":Fi,"%Atomics%":typeof Atomics>"u"?et:Atomics,"%BigInt%":typeof BigInt>"u"?et:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?et:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?et:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?et:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?et:Float32Array,"%Float64Array%":typeof Float64Array>"u"?et:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?et:FinalizationRegistry,"%Function%":Ed,"%GeneratorFunction%":Fi,"%Int8Array%":typeof Int8Array>"u"?et:Int8Array,"%Int16Array%":typeof Int16Array>"u"?et:Int16Array,"%Int32Array%":typeof Int32Array>"u"?et:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Ri&&Lt?Lt(Lt([][Symbol.iterator]())):et,"%JSON%":typeof JSON=="object"?JSON:et,"%Map%":typeof Map>"u"?et:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Ri||!Lt?et:Lt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?et:Promise,"%Proxy%":typeof Proxy>"u"?et:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?et:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?et:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Ri||!Lt?et:Lt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?et:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Ri&&Lt?Lt(""[Symbol.iterator]()):et,"%Symbol%":Ri?Symbol:et,"%SyntaxError%":Bi,"%ThrowTypeError%":Yy,"%TypedArray%":Ky,"%TypeError%":Li,"%Uint8Array%":typeof Uint8Array>"u"?et:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?et:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?et:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?et:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?et:WeakMap,"%WeakRef%":typeof WeakRef>"u"?et:WeakRef,"%WeakSet%":typeof WeakSet>"u"?et:WeakSet};if(Lt)try{null.error}catch(r){Td=Lt(Lt(r)),Xr["%Error.prototype%"]=Td}var Td,Zy=function r(t){var e;if(t==="%AsyncFunction%")e=Ul("async function () {}");else if(t==="%GeneratorFunction%")e=Ul("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Ul("async function* () {}");else if(t==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&Lt&&(e=Lt(s.prototype))}return Xr[t]=e,e},Cd={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},$s=Tn(),Cn=wd(),Qy=$s.call(Function.call,Array.prototype.concat),Jy=$s.call(Function.apply,Array.prototype.splice),Sd=$s.call(Function.call,String.prototype.replace),Sn=$s.call(Function.call,String.prototype.slice),t0=$s.call(Function.call,RegExp.prototype.exec),e0=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,r0=/\\(\\)?/g,i0=function(t){var e=Sn(t,0,1),i=Sn(t,-1);if(e==="%"&&i!=="%")throw new Bi("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new Bi("invalid intrinsic syntax, expected opening `%`");var s=[];return Sd(t,e0,function(o,n,a,l){s[s.length]=a?Sd(l,r0,"$1"):n||o}),s},s0=function(t,e){var i=t,s;if(Cn(Cd,i)&&(s=Cd[i],i="%"+s[0]+"%"),Cn(Xr,i)){var o=Xr[i];if(o===Fi&&(o=Zy(i)),typeof o>"u"&&!e)throw new Li("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:i,value:o}}throw new Bi("intrinsic "+t+" does not exist!")};Ad.exports=function(t,e){if(typeof t!="string"||t.length===0)throw new Li("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new Li('"allowMissing" argument must be a boolean');if(t0(/^%?[^%]*%?$/,t)===null)throw new Bi("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=i0(t),s=i.length>0?i[0]:"",o=s0("%"+s+"%",e),n=o.name,a=o.value,l=!1,h=o.alias;h&&(s=h[0],Jy(i,Qy([0,1],h)));for(var c=1,u=!0;c<i.length;c+=1){var d=i[c],p=Sn(d,0,1),f=Sn(d,-1);if((p==='"'||p==="'"||p==="`"||f==='"'||f==="'"||f==="`")&&p!==f)throw new Bi("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(l=!0),s+="."+d,n="%"+s+"%",Cn(Xr,n))a=Xr[n];else if(a!=null){if(!(d in a)){if(!e)throw new Li("base intrinsic for "+t+" exists, but the property is not available.");return}if($r&&c+1>=i.length){var m=$r(a,d);u=!!m,u&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else u=Cn(a,d),a=a[d];u&&!l&&(Xr[n]=a)}}return a}});var Vl=pt((UC,Id)=>{"use strict";var o0=br(),zl=o0("%Object.defineProperty%",!0),jl=function(){if(zl)try{return zl({},"a",{value:1}),!0}catch{return!1}return!1};jl.hasArrayLengthDefineBug=function(){if(!jl())return null;try{return zl([],"length",{value:1}).length!==1}catch{return!0}};Id.exports=jl});var Hl=pt((GC,Pd)=>{"use strict";var n0=br(),En=n0("%Object.getOwnPropertyDescriptor%",!0);if(En)try{En([],"length")}catch{En=null}Pd.exports=En});var Fd=pt((zC,Rd)=>{"use strict";var a0=Vl()(),$l=br(),Xs=a0&&$l("%Object.defineProperty%",!0);if(Xs)try{Xs({},"a",{value:1})}catch{Xs=!1}var l0=$l("%SyntaxError%"),ki=$l("%TypeError%"),Md=Hl();Rd.exports=function(t,e,i){if(!t||typeof t!="object"&&typeof t!="function")throw new ki("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new ki("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new ki("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new ki("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new ki("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new ki("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,n=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!Md&&Md(t,e);if(Xs)Xs(t,e,{configurable:n===null&&l?l.configurable:!n,enumerable:s===null&&l?l.enumerable:!s,value:i,writable:o===null&&l?l.writable:!o});else if(a||!s&&!o&&!n)t[e]=i;else throw new l0("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")}});var Nd=pt((jC,Dd)=>{"use strict";var Od=br(),Ld=Fd(),h0=Vl()(),Bd=Hl(),kd=Od("%TypeError%"),c0=Od("%Math.floor%");Dd.exports=function(t,e){if(typeof t!="function")throw new kd("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||c0(e)!==e)throw new kd("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],s=!0,o=!0;if("length"in t&&Bd){var n=Bd(t,"length");n&&!n.configurable&&(s=!1),n&&!n.writable&&(o=!1)}return(s||o||!i)&&(h0?Ld(t,"length",e,!0,!0):Ld(t,"length",e)),t}});var Vd=pt((VC,An)=>{"use strict";var Xl=Tn(),Oi=br(),u0=Nd(),d0=Oi("%TypeError%"),Gd=Oi("%Function.prototype.apply%"),zd=Oi("%Function.prototype.call%"),jd=Oi("%Reflect.apply%",!0)||Xl.call(zd,Gd),Ws=Oi("%Object.defineProperty%",!0),p0=Oi("%Math.max%");if(Ws)try{Ws({},"a",{value:1})}catch{Ws=null}An.exports=function(t){if(typeof t!="function")throw new d0("a function is required");var e=jd(Xl,zd,arguments);return u0(e,1+p0(0,t.length-(arguments.length-1)),!0)};var Ud=function(){return jd(Xl,Gd,arguments)};Ws?Ws(An.exports,"apply",{value:Ud}):An.exports.apply=Ud});var Wd=pt((HC,Xd)=>{"use strict";var Hd=br(),$d=Vd(),f0=$d(Hd("String.prototype.indexOf"));Xd.exports=function(t,e){var i=Hd(t,!!e);return typeof i=="function"&&f0(t,".prototype.")>-1?$d(i):i}});var Yd=pt(()=>{});var fp=pt((WC,pp)=>{var rh=typeof Map=="function"&&Map.prototype,Wl=Object.getOwnPropertyDescriptor&&rh?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Pn=rh&&Wl&&typeof Wl.get=="function"?Wl.get:null,qd=rh&&Map.prototype.forEach,ih=typeof Set=="function"&&Set.prototype,Yl=Object.getOwnPropertyDescriptor&&ih?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Mn=ih&&Yl&&typeof Yl.get=="function"?Yl.get:null,Kd=ih&&Set.prototype.forEach,m0=typeof WeakMap=="function"&&WeakMap.prototype,qs=m0?WeakMap.prototype.has:null,g0=typeof WeakSet=="function"&&WeakSet.prototype,Ks=g0?WeakSet.prototype.has:null,y0=typeof WeakRef=="function"&&WeakRef.prototype,Zd=y0?WeakRef.prototype.deref:null,x0=Boolean.prototype.valueOf,v0=Object.prototype.toString,b0=Function.prototype.toString,_0=String.prototype.match,sh=String.prototype.slice,wr=String.prototype.replace,w0=String.prototype.toUpperCase,Qd=String.prototype.toLowerCase,ap=RegExp.prototype.test,Jd=Array.prototype.concat,Ve=Array.prototype.join,T0=Array.prototype.slice,tp=Math.floor,Zl=typeof BigInt=="function"?BigInt.prototype.valueOf:null,ql=Object.getOwnPropertySymbols,Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Di=typeof Symbol=="function"&&typeof Symbol.iterator=="object",qt=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Di||!0)?Symbol.toStringTag:null,lp=Object.prototype.propertyIsEnumerable,ep=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function rp(r,t){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||ap.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-tp(-r):tp(r);if(i!==r){var s=String(i),o=sh.call(t,s.length+1);return wr.call(s,e,"$&_")+"."+wr.call(wr.call(o,/([0-9]{3})/g,"$&_"),/_$/,"")}}return wr.call(t,e,"$&_")}var Jl=Yd(),ip=Jl.custom,sp=cp(ip)?ip:null;pp.exports=function r(t,e,i,s){var o=e||{};if(_r(o,"quoteStyle")&&o.quoteStyle!=="single"&&o.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(_r(o,"maxStringLength")&&(typeof o.maxStringLength=="number"?o.maxStringLength<0&&o.maxStringLength!==1/0:o.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var n=_r(o,"customInspect")?o.customInspect:!0;if(typeof n!="boolean"&&n!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(_r(o,"indent")&&o.indent!==null&&o.indent!=="	"&&!(parseInt(o.indent,10)===o.indent&&o.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(_r(o,"numericSeparator")&&typeof o.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=o.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return dp(t,o);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var l=String(t);return a?rp(t,l):l}if(typeof t=="bigint"){var h=String(t)+"n";return a?rp(t,h):h}var c=typeof o.depth>"u"?5:o.depth;if(typeof i>"u"&&(i=0),i>=c&&c>0&&typeof t=="object")return th(t)?"[Array]":"[Object]";var u=z0(o,i);if(typeof s>"u")s=[];else if(up(s,t)>=0)return"[Circular]";function d(G,O,bt){if(O&&(s=T0.call(s),s.push(O)),bt){var Ft={depth:o.depth};return _r(o,"quoteStyle")&&(Ft.quoteStyle=o.quoteStyle),r(G,Ft,i+1,s)}return r(G,o,i+1,s)}if(typeof t=="function"&&!op(t)){var p=F0(t),f=In(t,d);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(f.length>0?" { "+Ve.call(f,", ")+" }":"")}if(cp(t)){var m=Di?wr.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ql.call(t);return typeof t=="object"&&!Di?Ys(m):m}if(N0(t)){for(var x="<"+Qd.call(String(t.nodeName)),y=t.attributes||[],_=0;_<y.length;_++)x+=" "+y[_].name+"="+hp(C0(y[_].value),"double",o);return x+=">",t.childNodes&&t.childNodes.length&&(x+="..."),x+="</"+Qd.call(String(t.nodeName))+">",x}if(th(t)){if(t.length===0)return"[]";var g=In(t,d);return u&&!G0(g)?"["+eh(g,u)+"]":"[ "+Ve.call(g,", ")+" ]"}if(E0(t)){var v=In(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!lp.call(t,"cause")?"{ ["+String(t)+"] "+Ve.call(Jd.call("[cause]: "+d(t.cause),v),", ")+" }":v.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Ve.call(v,", ")+" }"}if(typeof t=="object"&&n){if(sp&&typeof t[sp]=="function"&&Jl)return Jl(t,{depth:c-i});if(n!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(L0(t)){var U=[];return qd&&qd.call(t,function(G,O){U.push(d(O,t,!0)+" => "+d(G,t))}),np("Map",Pn.call(t),U,u)}if(O0(t)){var V=[];return Kd&&Kd.call(t,function(G){V.push(d(G,t))}),np("Set",Mn.call(t),V,u)}if(B0(t))return Kl("WeakMap");if(D0(t))return Kl("WeakSet");if(k0(t))return Kl("WeakRef");if(I0(t))return Ys(d(Number(t)));if(M0(t))return Ys(d(Zl.call(t)));if(P0(t))return Ys(x0.call(t));if(A0(t))return Ys(d(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===global)return"{ [object globalThis] }";if(!S0(t)&&!op(t)){var L=In(t,d),k=ep?ep(t)===Object.prototype:t instanceof Object||t.constructor===Object,X=t instanceof Object?"":"null prototype",Z=!k&&qt&&Object(t)===t&&qt in t?sh.call(Tr(t),8,-1):X?"Object":"",lt=k||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",Tt=lt+(Z||X?"["+Ve.call(Jd.call([],Z||[],X||[]),": ")+"] ":"");return L.length===0?Tt+"{}":u?Tt+"{"+eh(L,u)+"}":Tt+"{ "+Ve.call(L,", ")+" }"}return String(t)};function hp(r,t,e){var i=(e.quoteStyle||t)==="double"?'"':"'";return i+r+i}function C0(r){return wr.call(String(r),/"/g,"&quot;")}function th(r){return Tr(r)==="[object Array]"&&(!qt||!(typeof r=="object"&&qt in r))}function S0(r){return Tr(r)==="[object Date]"&&(!qt||!(typeof r=="object"&&qt in r))}function op(r){return Tr(r)==="[object RegExp]"&&(!qt||!(typeof r=="object"&&qt in r))}function E0(r){return Tr(r)==="[object Error]"&&(!qt||!(typeof r=="object"&&qt in r))}function A0(r){return Tr(r)==="[object String]"&&(!qt||!(typeof r=="object"&&qt in r))}function I0(r){return Tr(r)==="[object Number]"&&(!qt||!(typeof r=="object"&&qt in r))}function P0(r){return Tr(r)==="[object Boolean]"&&(!qt||!(typeof r=="object"&&qt in r))}function cp(r){if(Di)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!Ql)return!1;try{return Ql.call(r),!0}catch{}return!1}function M0(r){if(!r||typeof r!="object"||!Zl)return!1;try{return Zl.call(r),!0}catch{}return!1}var R0=Object.prototype.hasOwnProperty||function(r){return r in this};function _r(r,t){return R0.call(r,t)}function Tr(r){return v0.call(r)}function F0(r){if(r.name)return r.name;var t=_0.call(b0.call(r),/^function\s*([\w$]+)/);return t?t[1]:null}function up(r,t){if(r.indexOf)return r.indexOf(t);for(var e=0,i=r.length;e<i;e++)if(r[e]===t)return e;return-1}function L0(r){if(!Pn||!r||typeof r!="object")return!1;try{Pn.call(r);try{Mn.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function B0(r){if(!qs||!r||typeof r!="object")return!1;try{qs.call(r,qs);try{Ks.call(r,Ks)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function k0(r){if(!Zd||!r||typeof r!="object")return!1;try{return Zd.call(r),!0}catch{}return!1}function O0(r){if(!Mn||!r||typeof r!="object")return!1;try{Mn.call(r);try{Pn.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function D0(r){if(!Ks||!r||typeof r!="object")return!1;try{Ks.call(r,Ks);try{qs.call(r,qs)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function N0(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function dp(r,t){if(r.length>t.maxStringLength){var e=r.length-t.maxStringLength,i="... "+e+" more character"+(e>1?"s":"");return dp(sh.call(r,0,t.maxStringLength),t)+i}var s=wr.call(wr.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,U0);return hp(s,"single",t)}function U0(r){var t=r.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+w0.call(t.toString(16))}function Ys(r){return"Object("+r+")"}function Kl(r){return r+" { ? }"}function np(r,t,e,i){var s=i?eh(e,i):Ve.call(e,", ");return r+" ("+t+") {"+s+"}"}function G0(r){for(var t=0;t<r.length;t++)if(up(r[t],`
`)>=0)return!1;return!0}function z0(r,t){var e;if(r.indent==="	")e="	";else if(typeof r.indent=="number"&&r.indent>0)e=Ve.call(Array(r.indent+1)," ");else return null;return{base:e,prev:Ve.call(Array(t+1),e)}}function eh(r,t){if(r.length===0)return"";var e=`
`+t.prev+t.base;return e+Ve.call(r,","+e)+`
`+t.prev}function In(r,t){var e=th(r),i=[];if(e){i.length=r.length;for(var s=0;s<r.length;s++)i[s]=_r(r,s)?t(r[s],r):""}var o=typeof ql=="function"?ql(r):[],n;if(Di){n={};for(var a=0;a<o.length;a++)n["$"+o[a]]=o[a]}for(var l in r)_r(r,l)&&(e&&String(Number(l))===l&&l<r.length||Di&&n["$"+l]instanceof Symbol||(ap.call(/[^\w$]/,l)?i.push(t(l,r)+": "+t(r[l],r)):i.push(l+": "+t(r[l],r))));if(typeof ql=="function")for(var h=0;h<o.length;h++)lp.call(r,o[h])&&i.push("["+t(o[h])+"]: "+t(r[o[h]],r));return i}});var gp=pt((YC,mp)=>{"use strict";var oh=br(),Ni=Wd(),j0=fp(),V0=oh("%TypeError%"),Rn=oh("%WeakMap%",!0),Fn=oh("%Map%",!0),H0=Ni("WeakMap.prototype.get",!0),$0=Ni("WeakMap.prototype.set",!0),X0=Ni("WeakMap.prototype.has",!0),W0=Ni("Map.prototype.get",!0),Y0=Ni("Map.prototype.set",!0),q0=Ni("Map.prototype.has",!0),nh=function(r,t){for(var e=r,i;(i=e.next)!==null;e=i)if(i.key===t)return e.next=i.next,i.next=r.next,r.next=i,i},K0=function(r,t){var e=nh(r,t);return e&&e.value},Z0=function(r,t,e){var i=nh(r,t);i?i.value=e:r.next={key:t,next:r.next,value:e}},Q0=function(r,t){return!!nh(r,t)};mp.exports=function(){var t,e,i,s={assert:function(o){if(!s.has(o))throw new V0("Side channel does not contain "+j0(o))},get:function(o){if(Rn&&o&&(typeof o=="object"||typeof o=="function")){if(t)return H0(t,o)}else if(Fn){if(e)return W0(e,o)}else if(i)return K0(i,o)},has:function(o){if(Rn&&o&&(typeof o=="object"||typeof o=="function")){if(t)return X0(t,o)}else if(Fn){if(e)return q0(e,o)}else if(i)return Q0(i,o);return!1},set:function(o,n){Rn&&o&&(typeof o=="object"||typeof o=="function")?(t||(t=new Rn),$0(t,o,n)):Fn?(e||(e=new Fn),Y0(e,o,n)):(i||(i={key:{},next:null}),Z0(i,o,n))}};return s}});var Ln=pt((qC,yp)=>{"use strict";var J0=String.prototype.replace,tx=/%20/g,ah={RFC1738:"RFC1738",RFC3986:"RFC3986"};yp.exports={default:ah.RFC3986,formatters:{RFC1738:function(r){return J0.call(r,tx,"+")},RFC3986:function(r){return String(r)}},RFC1738:ah.RFC1738,RFC3986:ah.RFC3986}});var hh=pt((KC,vp)=>{"use strict";var ex=Ln(),lh=Object.prototype.hasOwnProperty,Wr=Array.isArray,He=function(){for(var r=[],t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r}(),rx=function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(Wr(i)){for(var s=[],o=0;o<i.length;++o)typeof i[o]<"u"&&s.push(i[o]);e.obj[e.prop]=s}}},xp=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},s=0;s<t.length;++s)typeof t[s]<"u"&&(i[s]=t[s]);return i},ix=function r(t,e,i){if(!e)return t;if(typeof e!="object"){if(Wr(t))t.push(e);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!lh.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var s=t;return Wr(t)&&!Wr(e)&&(s=xp(t,i)),Wr(t)&&Wr(e)?(e.forEach(function(o,n){if(lh.call(t,n)){var a=t[n];a&&typeof a=="object"&&o&&typeof o=="object"?t[n]=r(a,o,i):t.push(o)}else t[n]=o}),t):Object.keys(e).reduce(function(o,n){var a=e[n];return lh.call(o,n)?o[n]=r(o[n],a,i):o[n]=a,o},s)},sx=function(t,e){return Object.keys(e).reduce(function(i,s){return i[s]=e[s],i},t)},ox=function(r,t,e){var i=r.replace(/\+/g," ");if(e==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},nx=function(t,e,i,s,o){if(t.length===0)return t;var n=t;if(typeof t=="symbol"?n=Symbol.prototype.toString.call(t):typeof t!="string"&&(n=String(t)),i==="iso-8859-1")return escape(n).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var a="",l=0;l<n.length;++l){var h=n.charCodeAt(l);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||o===ex.RFC1738&&(h===40||h===41)){a+=n.charAt(l);continue}if(h<128){a=a+He[h];continue}if(h<2048){a=a+(He[192|h>>6]+He[128|h&63]);continue}if(h<55296||h>=57344){a=a+(He[224|h>>12]+He[128|h>>6&63]+He[128|h&63]);continue}l+=1,h=65536+((h&1023)<<10|n.charCodeAt(l)&1023),a+=He[240|h>>18]+He[128|h>>12&63]+He[128|h>>6&63]+He[128|h&63]}return a},ax=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],s=0;s<e.length;++s)for(var o=e[s],n=o.obj[o.prop],a=Object.keys(n),l=0;l<a.length;++l){var h=a[l],c=n[h];typeof c=="object"&&c!==null&&i.indexOf(c)===-1&&(e.push({obj:n,prop:h}),i.push(c))}return rx(e),t},lx=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},hx=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},cx=function(t,e){return[].concat(t,e)},ux=function(t,e){if(Wr(t)){for(var i=[],s=0;s<t.length;s+=1)i.push(e(t[s]));return i}return e(t)};vp.exports={arrayToObject:xp,assign:sx,combine:cx,compact:ax,decode:ox,encode:nx,isBuffer:hx,isRegExp:lx,maybeMap:ux,merge:ix}});var Sp=pt((ZC,Cp)=>{"use strict";var wp=gp(),Bn=hh(),Zs=Ln(),dx=Object.prototype.hasOwnProperty,bp={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},nr=Array.isArray,px=Array.prototype.push,Tp=function(r,t){px.apply(r,nr(t)?t:[t])},fx=Date.prototype.toISOString,_p=Zs.default,Kt={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Bn.encode,encodeValuesOnly:!1,format:_p,formatter:Zs.formatters[_p],indices:!1,serializeDate:function(t){return fx.call(t)},skipNulls:!1,strictNullHandling:!1},mx=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},ch={},gx=function r(t,e,i,s,o,n,a,l,h,c,u,d,p,f,m,x){for(var y=t,_=x,g=0,v=!1;(_=_.get(ch))!==void 0&&!v;){var U=_.get(t);if(g+=1,typeof U<"u"){if(U===g)throw new RangeError("Cyclic object value");v=!0}typeof _.get(ch)>"u"&&(g=0)}if(typeof l=="function"?y=l(e,y):y instanceof Date?y=u(y):i==="comma"&&nr(y)&&(y=Bn.maybeMap(y,function(Ft){return Ft instanceof Date?u(Ft):Ft})),y===null){if(o)return a&&!f?a(e,Kt.encoder,m,"key",d):e;y=""}if(mx(y)||Bn.isBuffer(y)){if(a){var V=f?e:a(e,Kt.encoder,m,"key",d);return[p(V)+"="+p(a(y,Kt.encoder,m,"value",d))]}return[p(e)+"="+p(String(y))]}var L=[];if(typeof y>"u")return L;var k;if(i==="comma"&&nr(y))f&&a&&(y=Bn.maybeMap(y,a)),k=[{value:y.length>0?y.join(",")||null:void 0}];else if(nr(l))k=l;else{var X=Object.keys(y);k=h?X.sort(h):X}for(var Z=s&&nr(y)&&y.length===1?e+"[]":e,lt=0;lt<k.length;++lt){var Tt=k[lt],G=typeof Tt=="object"&&typeof Tt.value<"u"?Tt.value:y[Tt];if(!(n&&G===null)){var O=nr(y)?typeof i=="function"?i(Z,Tt):Z:Z+(c?"."+Tt:"["+Tt+"]");x.set(t,g);var bt=wp();bt.set(ch,x),Tp(L,r(G,O,i,s,o,n,i==="comma"&&f&&nr(y)?null:a,l,h,c,u,d,p,f,m,bt))}}return L},yx=function(t){if(!t)return Kt;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||Kt.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=Zs.default;if(typeof t.format<"u"){if(!dx.call(Zs.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var s=Zs.formatters[i],o=Kt.filter;return(typeof t.filter=="function"||nr(t.filter))&&(o=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Kt.addQueryPrefix,allowDots:typeof t.allowDots>"u"?Kt.allowDots:!!t.allowDots,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kt.charsetSentinel,delimiter:typeof t.delimiter>"u"?Kt.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Kt.encode,encoder:typeof t.encoder=="function"?t.encoder:Kt.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Kt.encodeValuesOnly,filter:o,format:i,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Kt.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Kt.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kt.strictNullHandling}};Cp.exports=function(r,t){var e=r,i=yx(t),s,o;typeof i.filter=="function"?(o=i.filter,e=o("",e)):nr(i.filter)&&(o=i.filter,s=o);var n=[];if(typeof e!="object"||e===null)return"";var a;t&&t.arrayFormat in bp?a=t.arrayFormat:t&&"indices"in t?a=t.indices?"indices":"repeat":a="indices";var l=bp[a];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=l==="comma"&&t&&t.commaRoundTrip;s||(s=Object.keys(e)),i.sort&&s.sort(i.sort);for(var c=wp(),u=0;u<s.length;++u){var d=s[u];i.skipNulls&&e[d]===null||Tp(n,gx(e[d],d,l,h,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}var p=n.join(i.delimiter),f=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),p.length>0?f+p:""}});var Ip=pt((QC,Ap)=>{"use strict";var Ui=hh(),uh=Object.prototype.hasOwnProperty,xx=Array.isArray,Bt={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:Ui.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},vx=function(r){return r.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},Ep=function(r,t){return r&&typeof r=="string"&&t.comma&&r.indexOf(",")>-1?r.split(","):r},bx="utf8=%26%2310003%3B",_x="utf8=%E2%9C%93",wx=function(t,e){var i={__proto__:null},s=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,o=e.parameterLimit===1/0?void 0:e.parameterLimit,n=s.split(e.delimiter,o),a=-1,l,h=e.charset;if(e.charsetSentinel)for(l=0;l<n.length;++l)n[l].indexOf("utf8=")===0&&(n[l]===_x?h="utf-8":n[l]===bx&&(h="iso-8859-1"),a=l,l=n.length);for(l=0;l<n.length;++l)if(l!==a){var c=n[l],u=c.indexOf("]="),d=u===-1?c.indexOf("="):u+1,p,f;d===-1?(p=e.decoder(c,Bt.decoder,h,"key"),f=e.strictNullHandling?null:""):(p=e.decoder(c.slice(0,d),Bt.decoder,h,"key"),f=Ui.maybeMap(Ep(c.slice(d+1),e),function(m){return e.decoder(m,Bt.decoder,h,"value")})),f&&e.interpretNumericEntities&&h==="iso-8859-1"&&(f=vx(f)),c.indexOf("[]=")>-1&&(f=xx(f)?[f]:f),uh.call(i,p)?i[p]=Ui.combine(i[p],f):i[p]=f}return i},Tx=function(r,t,e,i){for(var s=i?t:Ep(t,e),o=r.length-1;o>=0;--o){var n,a=r[o];if(a==="[]"&&e.parseArrays)n=[].concat(s);else{n=e.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,h=parseInt(l,10);!e.parseArrays&&l===""?n={0:s}:!isNaN(h)&&a!==l&&String(h)===l&&h>=0&&e.parseArrays&&h<=e.arrayLimit?(n=[],n[h]=s):l!=="__proto__"&&(n[l]=s)}s=n}return s},Cx=function(t,e,i,s){if(t){var o=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,n=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&n.exec(o),h=l?o.slice(0,l.index):o,c=[];if(h){if(!i.plainObjects&&uh.call(Object.prototype,h)&&!i.allowPrototypes)return;c.push(h)}for(var u=0;i.depth>0&&(l=a.exec(o))!==null&&u<i.depth;){if(u+=1,!i.plainObjects&&uh.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(l[1])}return l&&c.push("["+o.slice(l.index)+"]"),Tx(c,e,i,s)}},Sx=function(t){if(!t)return Bt;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?Bt.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?Bt.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Bt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Bt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Bt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Bt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Bt.comma,decoder:typeof t.decoder=="function"?t.decoder:Bt.decoder,delimiter:typeof t.delimiter=="string"||Ui.isRegExp(t.delimiter)?t.delimiter:Bt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Bt.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Bt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Bt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Bt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Bt.strictNullHandling}};Ap.exports=function(r,t){var e=Sx(t);if(r===""||r===null||typeof r>"u")return e.plainObjects?Object.create(null):{};for(var i=typeof r=="string"?wx(r,e):r,s=e.plainObjects?Object.create(null):{},o=Object.keys(i),n=0;n<o.length;++n){var a=o[n],l=Cx(a,i[a],e,typeof r=="string");s=Ui.merge(s,l,e)}return e.allowSparse===!0?s:Ui.compact(s)}});var Mp=pt((JC,Pp)=>{"use strict";var Ex=Sp(),Ax=Ip(),Ix=Ln();Pp.exports={formats:Ix,parse:Ax,stringify:Ex}});var Bp=pt(zi=>{"use strict";var Px=ld();function Te(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Mx=/^([a-z0-9.+-]+:)/i,Rx=/:[0-9]*$/,Fx=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Lx=["<",">",'"',"`"," ","\r",`
`,"	"],Bx=["{","}","|","\\","^","`"].concat(Lx),dh=["'"].concat(Bx),Rp=["%","/","?",";","#"].concat(dh),Fp=["/","?","#"],kx=255,Lp=/^[+a-z0-9A-Z_-]{0,63}$/,Ox=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Dx={javascript:!0,"javascript:":!0},ph={javascript:!0,"javascript:":!0},Gi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},fh=Mp();function Qs(r,t,e){if(r&&typeof r=="object"&&r instanceof Te)return r;var i=new Te;return i.parse(r,t,e),i}Te.prototype.parse=function(r,t,e){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),s=i!==-1&&i<r.indexOf("#")?"?":"#",o=r.split(s),n=/\\/g;o[0]=o[0].replace(n,"/"),r=o.join(s);var a=r;if(a=a.trim(),!e&&r.split("#").length===1){var l=Fx.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=fh.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=Mx.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(e||h||a.match(/^\/\/[^@/]+@[^@/]+/)){var u=a.substr(0,2)==="//";u&&!(h&&ph[h])&&(a=a.substr(2),this.slashes=!0)}if(!ph[h]&&(u||h&&!Gi[h])){for(var d=-1,p=0;p<Fp.length;p++){var f=a.indexOf(Fp[p]);f!==-1&&(d===-1||f<d)&&(d=f)}var m,x;d===-1?x=a.lastIndexOf("@"):x=a.lastIndexOf("@",d),x!==-1&&(m=a.slice(0,x),a=a.slice(x+1),this.auth=decodeURIComponent(m)),d=-1;for(var p=0;p<Rp.length;p++){var f=a.indexOf(Rp[p]);f!==-1&&(d===-1||f<d)&&(d=f)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var _=this.hostname.split(/\./),p=0,g=_.length;p<g;p++){var v=_[p];if(v&&!v.match(Lp)){for(var U="",V=0,L=v.length;V<L;V++)v.charCodeAt(V)>127?U+="x":U+=v[V];if(!U.match(Lp)){var k=_.slice(0,p),X=_.slice(p+1),Z=v.match(Ox);Z&&(k.push(Z[1]),X.unshift(Z[2])),X.length&&(a="/"+X.join(".")+a),this.hostname=k.join(".");break}}}this.hostname.length>kx?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Px.toASCII(this.hostname));var lt=this.port?":"+this.port:"",Tt=this.hostname||"";this.host=Tt+lt,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Dx[c])for(var p=0,g=dh.length;p<g;p++){var G=dh[p];if(a.indexOf(G)!==-1){var O=encodeURIComponent(G);O===G&&(O=escape(G)),a=a.split(G).join(O)}}var bt=a.indexOf("#");bt!==-1&&(this.hash=a.substr(bt),a=a.slice(0,bt));var Ft=a.indexOf("?");if(Ft!==-1?(this.search=a.substr(Ft),this.query=a.substr(Ft+1),t&&(this.query=fh.parse(this.query)),a=a.slice(0,Ft)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Gi[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var lt=this.pathname||"",R=this.search||"";this.path=lt+R}return this.href=this.format(),this};function Nx(r){return typeof r=="string"&&(r=Qs(r)),r instanceof Te?r.format():Te.prototype.format.call(r)}Te.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=r+this.host:this.hostname&&(s=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(o=fh.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var n=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Gi[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),i&&i.charAt(0)!=="#"&&(i="#"+i),n&&n.charAt(0)!=="?"&&(n="?"+n),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),n=n.replace("#","%23"),t+s+e+n+i};function Ux(r,t){return Qs(r,!1,!0).resolve(t)}Te.prototype.resolve=function(r){return this.resolveObject(Qs(r,!1,!0)).format()};function Gx(r,t){return r?Qs(r,!1,!0).resolveObject(t):t}Te.prototype.resolveObject=function(r){if(typeof r=="string"){var t=new Te;t.parse(r,!1,!0),r=t}for(var e=new Te,i=Object.keys(this),s=0;s<i.length;s++){var o=i[s];e[o]=this[o]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var n=Object.keys(r),a=0;a<n.length;a++){var l=n[a];l!=="protocol"&&(e[l]=r[l])}return Gi[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!Gi[r.protocol]){for(var h=Object.keys(r),c=0;c<h.length;c++){var u=h[c];e[u]=r[u]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!ph[r.protocol]){for(var g=(r.pathname||"").split("/");g.length&&!(r.host=g.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),g[0]!==""&&g.unshift(""),g.length<2&&g.unshift(""),e.pathname=g.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var d=e.pathname||"",p=e.search||"";e.path=d+p}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var f=e.pathname&&e.pathname.charAt(0)==="/",m=r.host||r.pathname&&r.pathname.charAt(0)==="/",x=m||f||e.host&&r.pathname,y=x,_=e.pathname&&e.pathname.split("/")||[],g=r.pathname&&r.pathname.split("/")||[],v=e.protocol&&!Gi[e.protocol];if(v&&(e.hostname="",e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(g[0]===""?g[0]=r.host:g.unshift(r.host)),r.host=null),x=x&&(g[0]===""||_[0]==="")),m)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,_=g;else if(g.length)_||(_=[]),_.pop(),_=_.concat(g),e.search=r.search,e.query=r.query;else if(r.search!=null){if(v){e.host=_.shift(),e.hostname=e.host;var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.hostname=U.shift(),e.host=e.hostname)}return e.search=r.search,e.query=r.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!_.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var V=_.slice(-1)[0],L=(e.host||r.host||_.length>1)&&(V==="."||V==="..")||V==="",k=0,X=_.length;X>=0;X--)V=_[X],V==="."?_.splice(X,1):V===".."?(_.splice(X,1),k++):k&&(_.splice(X,1),k--);if(!x&&!y)for(;k--;k)_.unshift("..");x&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),L&&_.join("/").substr(-1)!=="/"&&_.push("");var Z=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(v){e.hostname=Z?"":_.length?_.shift():"",e.host=e.hostname;var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.hostname=U.shift(),e.host=e.hostname)}return x=x||e.host&&_.length,x&&!Z&&_.unshift(""),_.length>0?e.pathname=_.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};Te.prototype.parseHost=function(){var r=this.host,t=Rx.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};zi.parse=Qs;zi.resolve=Ux;zi.resolveObject=Gx;zi.format=Nx;zi.Url=Te});var ge=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(ge||{}),Ml=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(Ml||{}),mn=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(mn||{}),j=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(j||{}),Fe=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Fe||{}),M=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(M||{}),sr=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(sr||{}),K=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(K||{}),B=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(B||{}),Gt=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(Gt||{}),vr=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(vr||{}),_e=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(_e||{}),zt=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(zt||{}),je=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(je||{}),gn=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(gn||{}),re=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(re||{}),_t=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(_t||{});var ht=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(ht||{}),he=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(he||{});var Rl={createCanvas:(r,t)=>{let e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")};var S={ADAPTER:Rl,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Fl=/iPhone/i,Hu=/iPod/i,$u=/iPad/i,Xu=/\biOS-universal(?:.+)Mac\b/i,Ll=/\bAndroid(?:.+)Mobile\b/i,Wu=/Android/i,Ai=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,yn=/Silk/i,or=/Windows Phone/i,Yu=/\bWindows(?:.+)ARM\b/i,qu=/BlackBerry/i,Ku=/BB10/i,Zu=/Opera Mini/i,Qu=/\b(CriOS|Chrome)(?:.+)Mobile/i,Ju=/Mobile(?:.+)Firefox\b/i,td=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function yy(r){return function(t){return t.test(r)}}function Gs(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var s=yy(e),o={apple:{phone:s(Fl)&&!s(or),ipod:s(Hu),tablet:!s(Fl)&&(s($u)||td(t))&&!s(or),universal:s(Xu),device:(s(Fl)||s(Hu)||s($u)||s(Xu)||td(t))&&!s(or)},amazon:{phone:s(Ai),tablet:!s(Ai)&&s(yn),device:s(Ai)||s(yn)},android:{phone:!s(or)&&s(Ai)||!s(or)&&s(Ll),tablet:!s(or)&&!s(Ai)&&!s(Ll)&&(s(yn)||s(Wu)),device:!s(or)&&(s(Ai)||s(yn)||s(Ll)||s(Wu))||s(/\bokhttp\b/i)},windows:{phone:s(or),tablet:s(Yu),device:s(or)||s(Yu)},other:{blackberry:s(qu),blackberry10:s(Ku),opera:s(Zu),firefox:s(Ju),chrome:s(Qu),device:s(qu)||s(Ku)||s(Zu)||s(Ju)||s(Qu)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}var xy=Gs.default??Gs,we=xy(globalThis.navigator);var A={};my(A,{BaseTextureCache:()=>se,BoundingBox:()=>so,CanvasRenderTarget:()=>Gn,DATA_URI:()=>Nn,EventEmitter:()=>Xe.default,ProgramCache:()=>oo,TextureCache:()=>Ot,clearTextureCache:()=>uf,correctBlendMode:()=>rf,createIndicesForQuads:()=>af,decomposeDataUri:()=>mf,deprecation:()=>W,destroyTextureCache:()=>cf,detectVideoAlphaMode:()=>Dp,determineCrossOrigin:()=>jn,earcut:()=>gf.default,getBufferType:()=>Cr,getCanvasBoundingBox:()=>zn,getResolutionOfUrl:()=>no,hex2rgb:()=>Qp,hex2string:()=>Jp,interleaveTypedArrays:()=>lf,isMobile:()=>we,isPow2:()=>ro,isWebGLSupported:()=>kn,log2:()=>io,nextPow2:()=>Sr,path:()=>mh,premultiplyBlendMode:()=>eo,premultiplyRgba:()=>sf,premultiplyTint:()=>of,premultiplyTintToRgba:()=>nf,removeItems:()=>Un,rgb2hex:()=>ef,sayHello:()=>Up,sign:()=>hf,skipHello:()=>Np,string2hex:()=>tf,trimCanvas:()=>ff,uid:()=>$e,url:()=>Op});S.RETINA_PREFIX=/@([0-9\.]+)x/;S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Xe=Pl(rd(),1),gf=Pl(ad(),1);var ji=Pl(Bp(),1);var kp={};function W(r,t,e=3){if(kp[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),kp[t]=!0}var Op={get parse(){return W("7.3.0","utils.url.parse is deprecated, use native URL API instead."),ji.parse},get format(){return W("7.3.0","utils.url.format is deprecated, use native URL API instead."),ji.format},get resolve(){return W("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),ji.resolve}};function Le(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Js(r){return r.split("?")[0].split("#")[0]}function zx(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jx(r,t,e){return r.replace(new RegExp(zx(t),"g"),e)}function Vx(r,t){let e="",i=0,s=-1,o=0,n=-1;for(let a=0;a<=r.length;++a){if(a<r.length)n=r.charCodeAt(a);else{if(n===47)break;n=47}if(n===47){if(!(s===a-1||o===1))if(s!==a-1&&o===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){let l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",i=0):(e=e.slice(0,l),i=e.length-1-e.lastIndexOf("/")),s=a,o=0;continue}}else if(e.length===2||e.length===1){e="",i=0,s=a,o=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${r.slice(s+1,a)}`:e=r.slice(s+1,a),i=a-s-1;s=a,o=0}else n===46&&o!==-1?++o:o=-1}return e}var mh={toPosix(r){return jx(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){Le(r),r=this.toPosix(r);let t=/^file:\/\/\//.exec(r);if(t)return t[0];let e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(Le(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;let i=Js(this.toPosix(t??S.ADAPTER.getBaseUrl())),s=Js(this.toPosix(e??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?mh.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(Le(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="",e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));let i=r.endsWith("/");return r=Vx(r,!1),r.length>0&&i&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return Le(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){let i=r[e];if(Le(i),i.length>0)if(t===void 0)t=i;else{let s=r[e-1]??"";this.extname(s)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(Le(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0),e=t===47,i=-1,s=!0,o=this.getProtocol(r),n=r;r=r.slice(o.length);for(let a=r.length-1;a>=1;--a)if(t=r.charCodeAt(a),t===47){if(!s){i=a;break}}else s=!1;return i===-1?e?"/":this.isUrl(n)?o+r:o:e&&i===1?"//":o+r.slice(0,i)},rootname(r){Le(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){let e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){Le(r),t&&Le(t),r=Js(this.toPosix(r));let e=0,i=-1,s=!0,o;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let n=t.length-1,a=-1;for(o=r.length-1;o>=0;--o){let l=r.charCodeAt(o);if(l===47){if(!s){e=o+1;break}}else a===-1&&(s=!1,a=o+1),n>=0&&(l===t.charCodeAt(n)?--n===-1&&(i=o):(n=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(o=r.length-1;o>=0;--o)if(r.charCodeAt(o)===47){if(!s){e=o+1;break}}else i===-1&&(s=!1,i=o+1);return i===-1?"":r.slice(e,i)},extname(r){Le(r),r=Js(this.toPosix(r));let t=-1,e=0,i=-1,s=!0,o=0;for(let n=r.length-1;n>=0;--n){let a=r.charCodeAt(n);if(a===47){if(!s){e=n+1;break}continue}i===-1&&(s=!1,i=n+1),a===46?t===-1?t=n:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===e+1?"":r.slice(t,i)},parse(r){Le(r);let t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=Js(this.toPosix(r));let e=r.charCodeAt(0),i=this.isAbsolute(r),s,o="";t.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let n=-1,a=0,l=-1,h=!0,c=r.length-1,u=0;for(;c>=s;--c){if(e=r.charCodeAt(c),e===47){if(!h){a=c+1;break}continue}l===-1&&(h=!1,l=c+1),e===46?n===-1?n=c:u!==1&&(u=1):n!==-1&&(u=-1)}return n===-1||l===-1||u===0||u===1&&n===l-1&&n===a+1?l!==-1&&(a===0&&i?t.base=t.name=r.slice(1,l):t.base=t.name=r.slice(a,l)):(a===0&&i?(t.name=r.slice(1,n),t.base=r.slice(1,l)):(t.name=r.slice(a,n),t.base=r.slice(a,l)),t.ext=r.slice(n,l)),t.dir=this.dirname(r),o&&(t.dir=o+t.dir),t},sep:"/",delimiter:":"};var gh;async function Dp(){return gh??(gh=(async()=>{let r=document.createElement("canvas").getContext("webgl");if(!r)return zt.UNPACK;let t=await new Promise(o=>{let n=document.createElement("video");n.onloadeddata=()=>o(n),n.onerror=()=>o(null),n.autoplay=!1,n.crossOrigin="anonymous",n.preload="auto",n.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",n.load()});if(!t)return zt.UNPACK;let e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);let i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t);let s=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,s),r.deleteFramebuffer(i),r.deleteTexture(e),r.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?zt.PMA:zt.UNPACK})()),gh}function Np(){W("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function Up(){W("7.0.0",`sayHello is deprecated, please use Renderer's "hello" option`)}var yh;function kn(){return typeof yh>"u"&&(yh=function(){let r={stencil:!0,failIfMajorPerformanceCaveat:S.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!S.ADAPTER.getWebGLRenderingContext())return!1;let t=S.ADAPTER.createCanvas(),e=t.getContext("webgl",r)||t.getContext("experimental-webgl",r),i=!!e?.getContextAttributes()?.stencil;if(e){let s=e.getExtension("WEBGL_lose_context");s&&s.loseContext()}return e=null,i}catch{return!1}}()),yh}var Hx={grad:.9,turn:360,rad:360/(2*Math.PI)},ar=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},kt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},Ce=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},Wp=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},Gp=function(r){return{r:Ce(r.r,0,255),g:Ce(r.g,0,255),b:Ce(r.b,0,255),a:Ce(r.a)}},xh=function(r){return{r:kt(r.r),g:kt(r.g),b:kt(r.b),a:kt(r.a,3)}},$x=/^#([0-9a-f]{3,8})$/i,On=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},Yp=function(r){var t=r.r,e=r.g,i=r.b,s=r.a,o=Math.max(t,e,i),n=o-Math.min(t,e,i),a=n?o===t?(e-i)/n:o===e?2+(i-t)/n:4+(t-e)/n:0;return{h:60*(a<0?a+6:a),s:o?n/o*100:0,v:o/255*100,a:s}},qp=function(r){var t=r.h,e=r.s,i=r.v,s=r.a;t=t/360*6,e/=100,i/=100;var o=Math.floor(t),n=i*(1-e),a=i*(1-(t-o)*e),l=i*(1-(1-t+o)*e),h=o%6;return{r:255*[i,a,n,n,l,i][h],g:255*[l,i,i,a,n,n][h],b:255*[n,n,l,i,i,a][h],a:s}},zp=function(r){return{h:Wp(r.h),s:Ce(r.s,0,100),l:Ce(r.l,0,100),a:Ce(r.a)}},jp=function(r){return{h:kt(r.h),s:kt(r.s),l:kt(r.l),a:kt(r.a,3)}},Vp=function(r){return qp((e=(t=r).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},to=function(r){return{h:(t=Yp(r)).h,s:(s=(200-(e=t.s))*(i=t.v)/100)>0&&s<200?e*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,i,s},Xx=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Wx=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Yx=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,qx=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_h={string:[[function(r){var t=$x.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?kt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?kt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=Yx.exec(r)||qx.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:Gp({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=Xx.exec(r)||Wx.exec(r);if(!t)return null;var e,i,s=zp({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(Hx[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Vp(s)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,i=r.b,s=r.a,o=s===void 0?1:s;return ar(t)&&ar(e)&&ar(i)?Gp({r:Number(t),g:Number(e),b:Number(i),a:Number(o)}):null},"rgb"],[function(r){var t=r.h,e=r.s,i=r.l,s=r.a,o=s===void 0?1:s;if(!ar(t)||!ar(e)||!ar(i))return null;var n=zp({h:Number(t),s:Number(e),l:Number(i),a:Number(o)});return Vp(n)},"hsl"],[function(r){var t=r.h,e=r.s,i=r.v,s=r.a,o=s===void 0?1:s;if(!ar(t)||!ar(e)||!ar(i))return null;var n=function(a){return{h:Wp(a.h),s:Ce(a.s,0,100),v:Ce(a.v,0,100),a:Ce(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(o)});return qp(n)},"hsv"]]},Hp=function(r,t){for(var e=0;e<t.length;e++){var i=t[e][0](r);if(i)return[i,t[e][1]]}return[null,void 0]},Kx=function(r){return typeof r=="string"?Hp(r.trim(),_h.string):typeof r=="object"&&r!==null?Hp(r,_h.object):[null,void 0]};var vh=function(r,t){var e=to(r);return{h:e.h,s:Ce(e.s+100*t,0,100),l:e.l,a:e.a}},bh=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},$p=function(r,t){var e=to(r);return{h:e.h,s:e.s,l:Ce(e.l+100*t,0,100),a:e.a}},wh=function(){function r(t){this.parsed=Kx(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return kt(bh(this.rgba),2)},r.prototype.isDark=function(){return bh(this.rgba)<.5},r.prototype.isLight=function(){return bh(this.rgba)>=.5},r.prototype.toHex=function(){return t=xh(this.rgba),e=t.r,i=t.g,s=t.b,n=(o=t.a)<1?On(kt(255*o)):"","#"+On(e)+On(i)+On(s)+n;var t,e,i,s,o,n},r.prototype.toRgb=function(){return xh(this.rgba)},r.prototype.toRgbString=function(){return t=xh(this.rgba),e=t.r,i=t.g,s=t.b,(o=t.a)<1?"rgba("+e+", "+i+", "+s+", "+o+")":"rgb("+e+", "+i+", "+s+")";var t,e,i,s,o},r.prototype.toHsl=function(){return jp(to(this.rgba))},r.prototype.toHslString=function(){return t=jp(to(this.rgba)),e=t.h,i=t.s,s=t.l,(o=t.a)<1?"hsla("+e+", "+i+"%, "+s+"%, "+o+")":"hsl("+e+", "+i+"%, "+s+"%)";var t,e,i,s,o},r.prototype.toHsv=function(){return t=Yp(this.rgba),{h:kt(t.h),s:kt(t.s),v:kt(t.v),a:kt(t.a,3)};var t},r.prototype.invert=function(){return Be({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),Be(vh(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),Be(vh(this.rgba,-t))},r.prototype.grayscale=function(){return Be(vh(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),Be($p(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),Be($p(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?Be({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):kt(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=to(this.rgba);return typeof t=="number"?Be({h:t,s:e.s,l:e.l,a:e.a}):kt(e.h)},r.prototype.isEqual=function(t){return this.toHex()===Be(t).toHex()},r}(),Be=function(r){return r instanceof wh?r:new wh(r)},Xp=[],Kp=function(r){r.forEach(function(t){Xp.indexOf(t)<0&&(t(wh,_h),Xp.push(t))})};function Zp(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in e)i[e[s]]=s;var o={};r.prototype.toName=function(n){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=i[this.toHex()];if(h)return h;if(n?.closest){var c=this.toRgb(),u=1/0,d="black";if(!o.length)for(var p in e)o[p]=new r(e[p]).toRgb();for(var f in e){var m=(a=c,l=o[f],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<u&&(u=m,d=f)}return d}},t.string.push([function(n){var a=n.toLowerCase(),l=a==="transparent"?"#0000":e[a];return l?new r(l).toRgb():null},"name"])}Kp([Zp]);var Vi=class Dn{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Dn)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){let i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,o)=>s===e[o]);if(t!==null&&e!==null){let s=Object.keys(t),o=Object.keys(e);return s.length!==o.length?!1:s.every(n=>t[n]===e[n])}return t===e}toRgba(){let[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){let[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){let[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){let[e,i,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];let[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){let t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){let[e,i,s,o]=Dn.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=o,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,o=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,o=o*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+o}toHex(){let t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){let t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){let[e,i,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];let[e,i,s,o]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=o,t}normalize(t){let e,i,s,o;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){let n=t;e=(n>>16&255)/255,i=(n>>8&255)/255,s=(n&255)/255,o=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,o=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,o=255]=t,e/=255,i/=255,s/=255,o/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){let a=Dn.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}let n=Be(t);n.isValid()&&({r:e,g:i,b:s,a:o}=n.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=o,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);let[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,o)=>{t[o]=Math.min(Math.max(s,e),i)}),t)}};Vi.shared=new Vi,Vi.temp=new Vi,Vi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;var tt=Vi;function Qp(r,t=[]){return W("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),tt.shared.setValue(r).toRgbArray(t)}function Jp(r){return W("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),tt.shared.setValue(r).toHex()}function tf(r){return W("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(r).toNumber()}function ef(r){return W("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),tt.shared.setValue(r).toNumber()}function Zx(){let r=[],t=[];for(let i=0;i<32;i++)r[i]=i,t[i]=i;r[j.NORMAL_NPM]=j.NORMAL,r[j.ADD_NPM]=j.ADD,r[j.SCREEN_NPM]=j.SCREEN,t[j.NORMAL]=j.NORMAL_NPM,t[j.ADD]=j.ADD_NPM,t[j.SCREEN]=j.SCREEN_NPM;let e=[];return e.push(t),e.push(r),e}var eo=Zx();function rf(r,t){return eo[t?1:0][r]}function sf(r,t,e,i=!0){return W("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),tt.shared.setValue(r).premultiply(t,i).toArray(e??new Float32Array(4))}function of(r,t){return W("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),tt.shared.setValue(r).toPremultiplied(t)}function nf(r,t,e,i=!0){return W("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),tt.shared.setValue(r).premultiply(t,i).toArray(e??new Float32Array(4))}var Nn=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function af(r,t=null){let e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,s=0;i<e;i+=6,s+=4)t[i+0]=s+0,t[i+1]=s+1,t[i+2]=s+2,t[i+3]=s+0,t[i+4]=s+2,t[i+5]=s+3;return t}function Cr(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}var Qx={Float32Array,Uint32Array,Int32Array,Uint8Array};function lf(r,t){let e=0,i=0,s={};for(let l=0;l<r.length;l++)i+=t[l],e+=r[l].length;let o=new ArrayBuffer(e*4),n=null,a=0;for(let l=0;l<r.length;l++){let h=t[l],c=r[l],u=Cr(c);s[u]||(s[u]=new Qx[u](o)),n=s[u];for(let d=0;d<c.length;d++){let p=(d/h|0)*i+a,f=d%h;n[p+f]=c[d]}a+=h}return new Float32Array(o)}function Sr(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function ro(r){return!(r&r-1)&&!!r}function io(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function Un(r,t,e){let i=r.length,s;if(t>=i||e===0)return;e=t+e>i?i-t:e;let o=i-e;for(s=t;s<o;++s)r[s]=r[s+e];r.length=o}function hf(r){return r===0?0:r<0?-1:1}var Jx=0;function $e(){return++Jx}var Th=class{constructor(r,t,e,i){this.left=r,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};Th.EMPTY=new Th(0,0,0,0);var so=Th;var oo={},Ot=Object.create(null),se=Object.create(null);function cf(){let r;for(r in Ot)Ot[r].destroy();for(r in se)se[r].destroy()}function uf(){let r;for(r in Ot)delete Ot[r];for(r in se)delete se[r]}var Gn=class{constructor(t,e,i){this._canvas=S.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||S.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}};function df(r,t,e){for(let i=0,s=4*e*t;i<t;++i,s+=4)if(r[s+3]!==0)return!1;return!0}function pf(r,t,e,i,s){let o=4*t;for(let n=i,a=i*o+4*e;n<=s;++n,a+=o)if(r[a+3]!==0)return!1;return!0}function zn(r){let{width:t,height:e}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");let s=i.getImageData(0,0,t,e).data,o=0,n=0,a=t-1,l=e-1;for(;n<e&&df(s,t,n);)++n;if(n===e)return so.EMPTY;for(;df(s,t,l);)--l;for(;pf(s,t,o,n,l);)++o;for(;pf(s,t,a,n,l);)--a;return++a,++l,new so(o,n,a,l)}function ff(r){let t=zn(r),{width:e,height:i}=t,s=null;if(!t.isEmpty()){let o=r.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");s=o.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:s}}function mf(r){let t=Nn.exec(r);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function jn(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location;let e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function no(r,t=1){let e=S.RETINA_PREFIX?.exec(r);return e?parseFloat(e[1]):t}var w=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(w||{}),Ch=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},yf=(r,t)=>Ch(r).priority??t,T={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(Ch).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...r){return r.map(Ch).forEach(t=>{t.type.forEach(e=>{let i=this._addHandlers,s=this._queue;i[e]?i[e](t):(s[e]=s[e]||[],s[e].push(t))})}),this},handle(r,t,e){let i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,s[r]=e;let o=this._queue;return o[r]&&(o[r].forEach(n=>t(n)),delete o[r]),this},handleByMap(r,t){return this.handle(r,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,o)=>yf(o,e)-yf(s,e)))},i=>{let s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}};var ao=class{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}};var tv=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function ev(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function Vn(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let e=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=tv.replace(/%forloop%/gi,ev(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}var Sh=0,Eh=1,Ah=2,Ih=3,Ph=4,Mh=5,Se=class r{constructor(){this.data=0,this.blendMode=j.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Sh)}set blend(t){!!(this.data&1<<Sh)!==t&&(this.data^=1<<Sh)}get offsets(){return!!(this.data&1<<Eh)}set offsets(t){!!(this.data&1<<Eh)!==t&&(this.data^=1<<Eh)}get culling(){return!!(this.data&1<<Ah)}set culling(t){!!(this.data&1<<Ah)!==t&&(this.data^=1<<Ah)}get depthTest(){return!!(this.data&1<<Ih)}set depthTest(t){!!(this.data&1<<Ih)!==t&&(this.data^=1<<Ih)}get depthMask(){return!!(this.data&1<<Mh)}set depthMask(t){!!(this.data&1<<Mh)!==t&&(this.data^=1<<Mh)}get clockwiseFrontFace(){return!!(this.data&1<<Ph)}set clockwiseFrontFace(t){!!(this.data&1<<Ph)!==t&&(this.data^=1<<Ph)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==j.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){let t=new r;return t.depthTest=!1,t.blend=!0,t}};Se.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};var lo=[];function Hi(r,t){if(!r)return null;let e="";if(typeof r=="string"){let i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(let i=lo.length-1;i>=0;--i){let s=lo[i];if(s.test&&s.test(r,e))return new s(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var Ct=class{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,s,o,n,a,l){if(arguments.length>8)throw new Error("max arguments reached");let{name:h,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][h](t,e,i,s,o,n,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){let e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}};Object.defineProperties(Ct.prototype,{dispatch:{value:Ct.prototype.emit},run:{value:Ct.prototype.emit}});var ye=class{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ct("setRealSize"),this.onUpdate=new Ct("update"),this.onError=new Ct("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}};var Yr=class extends ye{constructor(t,e){let{width:i,height:s}=e||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){let s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===zt.UNPACK);let o=e.realWidth,n=e.realHeight;return i.width===o&&i.height===n?s.texSubImage2D(e.target,0,0,0,o,n,e.format,i.type,this.data):(i.width=o,i.height=n,s.texImage2D(e.target,0,i.internalFormat,o,n,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}};var rv={scaleMode:Gt.NEAREST,alphaMode:zt.NPM},Rh=class $i extends Xe.default{constructor(t=null,e=null){super(),e=Object.assign({},$i.defaultOptions,e);let{alphaMode:i,mipmap:s,anisotropicLevel:o,scaleMode:n,width:a,height:l,wrapMode:h,format:c,type:u,target:d,resolution:p,resourceOptions:f}=e;t&&!(t instanceof ye)&&(t=Hi(t,f),t.internal=!0),this.resolution=p||S.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=o,this._wrapMode=h,this._scaleMode=n,this.format=c,this.type=u,this.target=d,this.alphaMode=i,this.uid=$e(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=ro(this.realWidth)&&ro(this.realHeight)}setResolution(t){let e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete se[this.cacheId],delete Ot[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),$i.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=S.STRICT_TEXTURE_CACHE){let s=typeof t=="string",o=null;if(s)o=t;else{if(!t._pixiId){let a=e?.pixiIdPrefix||"pixiid";t._pixiId=`${a}_${$e()}`}o=t._pixiId}let n=se[o];if(s&&i&&!n)throw new Error(`The cacheId "${o}" does not exist in BaseTextureCache.`);return n||(n=new $i(t,e),n.cacheId=o,$i.addToCache(n,o)),n}static fromBuffer(t,e,i,s){t=t||new Float32Array(e*i*4);let o=new Yr(t,{width:e,height:i,...s?.resourceOptions}),n,a;return t instanceof Float32Array?(n=M.RGBA,a=K.FLOAT):t instanceof Int32Array?(n=M.RGBA_INTEGER,a=K.INT):t instanceof Uint32Array?(n=M.RGBA_INTEGER,a=K.UNSIGNED_INT):t instanceof Int16Array?(n=M.RGBA_INTEGER,a=K.SHORT):t instanceof Uint16Array?(n=M.RGBA_INTEGER,a=K.UNSIGNED_SHORT):t instanceof Int8Array?(n=M.RGBA,a=K.BYTE):(n=M.RGBA,a=K.UNSIGNED_BYTE),o.internal=!0,new $i(o,Object.assign({},rv,{type:a,format:n},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),se[e]&&se[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),se[e]=t)}static removeFromCache(t){if(typeof t=="string"){let e=se[t];if(e){let i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete se[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete se[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};Rh.defaultOptions={mipmap:_e.POW2,anisotropicLevel:0,scaleMode:Gt.LINEAR,wrapMode:vr.CLAMP,alphaMode:zt.UNPACK,target:sr.TEXTURE_2D,format:M.RGBA,type:K.UNSIGNED_BYTE},Rh._globalBatch=0;var Y=Rh;var Er=class{constructor(){this.texArray=null,this.blend=0,this.type=Fe.TRIANGLES,this.start=0,this.size=0,this.data=null}};var iv=0,At=class r{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=iv++,this.disposeRunner=new Ct("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?he.ELEMENT_ARRAY_BUFFER:he.ARRAY_BUFFER}get index(){return this.type===he.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new r(t)}};var Xi=class r{constructor(t,e=0,i=!1,s=K.FLOAT,o,n,a,l=1){this.buffer=t,this.size=e,this.normalized=i,this.type=s,this.stride=o,this.start=n,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(t,e,i,s,o){return new r(t,e,i,s,o)}};var sv={Float32Array,Uint32Array,Int32Array,Uint8Array};function xf(r,t){let e=0,i=0,s={};for(let l=0;l<r.length;l++)i+=t[l],e+=r[l].length;let o=new ArrayBuffer(e*4),n=null,a=0;for(let l=0;l<r.length;l++){let h=t[l],c=r[l],u=Cr(c);s[u]||(s[u]=new sv[u](o)),n=s[u];for(let d=0;d<c.length;d++){let p=(d/h|0)*i+a,f=d%h;n[p+f]=c[d]}a+=h}return new Float32Array(o)}var vf={5126:4,5123:2,5121:1},ov=0,nv={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},lr=class r{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=ov++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ct("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,s=!1,o,n,a,l=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof At||(e instanceof Array&&(e=new Float32Array(e)),e=new At(e));let h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],e,i,s,o);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Xi(c,i,s,o,n,a,l),this.instanced=this.instanced||l,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof At||(t instanceof Array&&(t=new Uint16Array(t)),t=new At(t)),t.type=he.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;let t=[],e=[],i=new At,s;for(s in this.attributes){let o=this.attributes[s],n=this.buffers[o.buffer];t.push(n.data),e.push(o.size*vf[o.type]/4),o.buffer=0}for(i.data=xf(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let t in this.attributes){let e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let t=new r;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new At(this.buffers[e].data.slice(0));for(let e in this.attributes){let i=this.attributes[e];t.attributes[e]=new Xi(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=he.ELEMENT_ARRAY_BUFFER),t}static merge(t){let e=new r,i=[],s=[],o=[],n;for(let a=0;a<t.length;a++){n=t[a];for(let l=0;l<n.buffers.length;l++)s[l]=s[l]||0,s[l]+=n.buffers[l].data.length,o[l]=0}for(let a=0;a<n.buffers.length;a++)i[a]=new nv[Cr(n.buffers[a].data)](s[a]),e.buffers[a]=new At(i[a]);for(let a=0;a<t.length;a++){n=t[a];for(let l=0;l<n.buffers.length;l++)i[l].set(n.buffers[l].data,o[l]),o[l]+=n.buffers[l].data.length}if(e.attributes=n.attributes,n.indexBuffer){e.indexBuffer=e.buffers[n.buffers.indexOf(n.indexBuffer)],e.indexBuffer.type=he.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,c=0;for(let u=0;u<n.buffers.length;u++)if(n.buffers[u]!==n.indexBuffer){c=u;break}for(let u in n.attributes){let d=n.attributes[u];(d.buffer|0)===c&&(l+=d.size*vf[d.type]/4)}for(let u=0;u<t.length;u++){let d=t[u].indexBuffer.data;for(let p=0;p<d.length;p++)e.indexBuffer.data[p+h]+=a;a+=t[u].buffers[c].data.length/l,h+=d.length}}return e}};var qr=class extends lr{constructor(t=!1){super(),this._buffer=new At(null,t,!1),this._indexBuffer=new At(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,K.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,K.FLOAT).addAttribute("aColor",this._buffer,4,!0,K.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,K.FLOAT).addIndex(this._indexBuffer)}};var Ar=Math.PI*2,Fh=180/Math.PI,ke=Math.PI/180,ct=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(ct||{});var H=class r{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new r(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}};H.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};var Hn=[new H,new H,new H,new H],$=class r{constructor(t=0,e=0,i=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=ct.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new r(0,0,0,0)}clone(){return new r(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){let k=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=k)return!1;let X=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>X}let i=this.left,s=this.right,o=this.top,n=this.bottom;if(s<=i||n<=o)return!1;let a=Hn[0].set(t.left,t.top),l=Hn[1].set(t.left,t.bottom),h=Hn[2].set(t.right,t.top),c=Hn[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;let u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(l,l),e.apply(h,h),e.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=i||Math.min(a.x,l.x,h.x,c.x)>=s||Math.max(a.y,l.y,h.y,c.y)<=o||Math.min(a.y,l.y,h.y,c.y)>=n))return!1;let d=u*(l.y-a.y),p=u*(a.x-l.x),f=d*i+p*o,m=d*s+p*o,x=d*i+p*n,y=d*s+p*n;if(Math.max(f,m,x,y)<=d*a.x+p*a.y||Math.min(f,m,x,y)>=d*c.x+p*c.y)return!1;let _=u*(a.y-h.y),g=u*(h.x-a.x),v=_*i+g*o,U=_*s+g*o,V=_*i+g*n,L=_*s+g*n;return!(Math.max(v,U,V,L)<=_*a.x+g*a.y||Math.min(v,U,V,L)>=_*c.x+g*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){let e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(o-s,0),this}ceil(t=1,e=.001){let i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){let e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=o-s,this}};$.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};var Wi=class r{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=ct.CIRC}clone(){return new r(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;let i=this.radius*this.radius,s=this.x-t,o=this.y-e;return s*=s,o*=o,s+o<=i}getBounds(){return new $(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}};Wi.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};var Yi=class r{constructor(t=0,e=0,i=0,s=0){this.x=t,this.y=e,this.width=i,this.height=s,this.type=ct.ELIP}clone(){return new r(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,s=(e-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new $(this.x-this.width,this.y-this.height,this.width,this.height)}};Yi.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};var Ir=class r{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){let i=[];for(let s=0,o=e.length;s<o;s++)i.push(e[s].x,e[s].y);e=i}this.points=e,this.type=ct.POLY,this.closeStroke=!0}clone(){let t=this.points.slice(),e=new r(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1,s=this.points.length/2;for(let o=0,n=s-1;o<s;n=o++){let a=this.points[o*2],l=this.points[o*2+1],h=this.points[n*2],c=this.points[n*2+1];l>e!=c>e&&t<(h-a)*((e-l)/(c-l))+a&&(i=!i)}return i}};Ir.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,t)=>`${r}, ${t}`,"")}]`};var qi=class r{constructor(t=0,e=0,i=0,s=0,o=20){this.x=t,this.y=e,this.width=i,this.height=s,this.radius=o,this.type=ct.RREC}clone(){return new r(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),o=e-(this.y+i),n=i*i;if(s*s+o*o<=n||(s=t-(this.x+this.width-i),s*s+o*o<=n)||(o=e-(this.y+this.height-i),s*s+o*o<=n)||(s=t-(this.x+i),s*s+o*o<=n))return!0}return!1}};qi.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};var st=class r{constructor(t=1,e=0,i=0,s=1,o=0,n=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=o,this.ty=n}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,o,n){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=o,this.ty=n,this}toArray(t,e){this.array||(this.array=new Float32Array(9));let i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new H;let i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new H;let i=1/(this.a*this.d+this.c*-this.b),s=t.x,o=t.y;return e.x=this.d*i*s+-this.c*i*o+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*o+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){let e=Math.cos(t),i=Math.sin(t),s=this.a,o=this.c,n=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=o*e-this.d*i,this.d=o*i+this.d*e,this.tx=n*e-this.ty*i,this.ty=n*i+this.ty*e,this}append(t){let e=this.a,i=this.b,s=this.c,o=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*o,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*o,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*o+this.ty,this}setTransform(t,e,i,s,o,n,a,l,h){return this.a=Math.cos(a+h)*o,this.b=Math.sin(a+h)*o,this.c=-Math.sin(a-l)*n,this.d=Math.cos(a-l)*n,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){let e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){let i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){let e=this.a,i=this.b,s=this.c,o=this.d,n=t.pivot,a=-Math.atan2(-s,o),l=Math.atan2(i,e),h=Math.abs(a+l);return h<1e-5||Math.abs(Ar-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+o*o),t.position.x=this.tx+(n.x*e+n.y*s),t.position.y=this.ty+(n.x*i+n.y*o),t}invert(){let t=this.a,e=this.b,i=this.c,s=this.d,o=this.tx,n=t*s-e*i;return this.a=s/n,this.b=-e/n,this.c=-i/n,this.d=t/n,this.tx=(i*this.ty-s*o)/n,this.ty=-(t*this.ty-e*o)/n,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new r}static get TEMP_MATRIX(){return new r}};st.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};var Kr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Zr=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Qr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Jr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Lh=[],bf=[],$n=Math.sign;function av(){for(let r=0;r<16;r++){let t=[];Lh.push(t);for(let e=0;e<16;e++){let i=$n(Kr[r]*Kr[e]+Qr[r]*Zr[e]),s=$n(Zr[r]*Kr[e]+Jr[r]*Zr[e]),o=$n(Kr[r]*Qr[e]+Qr[r]*Jr[e]),n=$n(Zr[r]*Qr[e]+Jr[r]*Jr[e]);for(let a=0;a<16;a++)if(Kr[a]===i&&Zr[a]===s&&Qr[a]===o&&Jr[a]===n){t.push(a);break}}}for(let r=0;r<16;r++){let t=new st;t.set(Kr[r],Zr[r],Qr[r],Jr[r],0,0),bf.push(t)}}av();var ft={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>Kr[r],uY:r=>Zr[r],vX:r=>Qr[r],vY:r=>Jr[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>Lh[r][t],sub:(r,t)=>Lh[r][ft.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?ft.S:ft.N:Math.abs(t)*2<=Math.abs(r)?r>0?ft.E:ft.W:t>0?r>0?ft.SE:ft.SW:r>0?ft.NE:ft.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{let s=bf[ft.inv(t)];s.tx=e,s.ty=i,r.append(s)}};var ce=class r{constructor(t,e,i=0,s=0){this._x=i,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new r(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};ce.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};var Bh=class{constructor(){this.worldTransform=new st,this.localTransform=new st,this.position=new ce(this.onChange,this,0,0),this.scale=new ce(this.onChange,this,1,1),this.pivot=new ce(this.onChange,this,0,0),this.skew=new ce(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){let r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){let e=r.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};Bh.IDENTITY=new Bh;var Ki=Bh;Ki.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var _f=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`;var wf=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Xn(r,t,e){let i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function kh(r){let t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function ho(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return kh(2*t);case"bvec3":return kh(3*t);case"bvec4":return kh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var We=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,t)=>r.type==="vec3"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}];var lv={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},hv={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Oh(r,t){let e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in r.uniforms){let s=t[i];if(!s){r.uniforms[i]?.group===!0&&(r.uniforms[i].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let o=r.uniforms[i],n=!1;for(let a=0;a<We.length;a++)if(We[a].test(s,o)){e.push(We[a].code(i,o)),n=!0;break}if(!n){let a=(s.size===1&&!s.isArray?lv:hv)[s.type].replace("location",`ud["${i}"].location`);e.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${a};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}var Tf={},Wn=Tf;function Yn(){if(Wn===Tf||Wn?.isContextLost()){let r=S.ADAPTER.createCanvas(),t;S.PREFER_ENV>=ge.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Wn=t}return Wn}var qn;function Dh(){if(!qn){qn=re.MEDIUM;let r=Yn();if(r&&r.getShaderPrecisionFormat){let t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);t&&(qn=t.precision?re.HIGH:re.MEDIUM)}}return qn}function Cf(r,t){let e=r.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),i=r.getShaderInfoLog(t),s=i.split(`
`),o={},n=s.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!o[h]?(o[h]=!0,!0):!1),a=[""];n.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let l=e.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function Nh(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||Cf(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||Cf(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}var cv={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function co(r){return cv[r]}var Kn=null,Sf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function uo(r,t){if(!Kn){let e=Object.keys(Sf);Kn={};for(let i=0;i<e.length;++i){let s=e[i];Kn[r[s]]=Sf[s]}}return Kn[t]}function Zn(r,t,e){if(r.substring(0,9)!=="precision"){let i=t;return t===re.HIGH&&e!==re.HIGH&&(i=re.MEDIUM),`precision ${i} float;
${r}`}else if(e!==re.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}var po;function Qn(){if(typeof po=="boolean")return po;try{po=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{po=!1}return po}var uv=0,Jn={},Uh=class Zi{constructor(t,e,i="pixi-shader",s={}){this.extra={},this.id=uv++,this.vertexSrc=t||Zi.defaultVertexSrc,this.fragmentSrc=e||Zi.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Jn[i]?(Jn[i]++,i+=`-${Jn[i]}`):Jn[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Zn(this.vertexSrc,Zi.defaultVertexPrecision,re.HIGH),this.fragmentSrc=Zn(this.fragmentSrc,Zi.defaultFragmentPrecision,Dh())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return wf}static get defaultFragmentSrc(){return _f}static from(t,e,i){let s=t+e,o=oo[s];return o||(oo[s]=o=new Zi(t,e,i)),o}};Uh.defaultVertexPrecision=re.HIGH,Uh.defaultFragmentPrecision=we.apple.device?re.HIGH:re.MEDIUM;var Ee=Uh;var dv=0,oe=class r{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=dv++,this.static=!!e,this.ubo=!!i,t instanceof At?(this.buffer=t,this.buffer.type=he.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new At(new Float32Array(1)),this.buffer.type=he.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new r(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new r(t,e,i)}static uboFrom(t,e){return new r(t,e??!0,!0)}};var hr=class r{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof oe?this.uniformGroup=e:this.uniformGroup=new oe(e):this.uniformGroup=new oe({}),this.disposeRunner=new Ct("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(let i in e.uniforms){let s=e.uniforms[i];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){let s=Ee.from(t,e);return new r(s,i)}};var fo=class{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){let i=new Int32Array(t);for(let o=0;o<t;o++)i[o]=o;this.defaultGroupCache[t]=oe.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Ee(this.vertexSrc,s)}let e={tint:new Float32Array([1,1,1,1]),translationMatrix:new st,default:this.defaultGroupCache[t]};return new hr(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}};var Pr=class{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}};function Ef(){return!we.apple.device}function Af(r){let t=!0,e=S.ADAPTER.getNavigator();if(we.tablet||we.phone){if(we.apple.device){let i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(we.android.device){let i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?r:4}var ti=class{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}};var If=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`;var Pf=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;var mo=class Oe extends ti{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=qr,this.vertexSize=6,this.state=Se.for2d(),this.size=Oe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Af(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Ef(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return W("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Pf}static get defaultFragmentTemplate(){return If}setShaderGenerator({vertex:t=Oe.defaultVertexSrc,fragment:e=Oe.defaultFragmentTemplate}={}){this.shaderGenerator=new fo(t,e)}contextChange(){let t=this.renderer.gl;S.PREFER_ENV===ge.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Oe.defaultMaxTextures),this.maxTextures=Vn(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:t,_textureArrayPool:e}=Oe,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new Er);for(;e.length<s;)e.push(new Pr);for(let o=0;o<this.maxTextures;o++)this._tempBoundTextures[o]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){let{_bufferedTextures:t,maxTextures:e}=this,i=Oe._textureArrayPool,s=this.renderer.batch,o=this._tempBoundTextures,n=this.renderer.textureGC.count,a=++Y._globalBatch,l=0,h=i[0],c=0;s.copyBoundTextures(o,e);for(let u=0;u<this._bufferSize;++u){let d=t[u];t[u]=null,d._batchEnabled!==a&&(h.count>=e&&(s.boundArray(h,o,a,e),this.buildDrawCalls(h,c,u),c=u,h=i[++l],++a),d._batchEnabled=a,d.touched=n,h.elements[h.count++]=d)}h.count>0&&(s.boundArray(h,o,a,e),this.buildDrawCalls(h,c,this._bufferSize),++l,++a);for(let u=0;u<o.length;u++)o[u]=null;Y._globalBatch=a}buildDrawCalls(t,e,i){let{_bufferedElements:s,_attributeBuffer:o,_indexBuffer:n,vertexSize:a}=this,l=Oe._drawCallPool,h=this._dcIndex,c=this._aIndex,u=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=t;for(let p=e;p<i;++p){let f=s[p],m=f._texture.baseTexture,x=eo[m.alphaMode?1:0][f.blendMode];s[p]=null,e<p&&d.blend!==x&&(d.size=u-d.start,e=p,d=l[++h],d.texArray=t,d.start=u),this.packInterleavedGeometry(f,o,n,c,u),c+=f.vertexData.length/2*a,u+=f.indices.length,d.blend=x}e<i&&(d.size=u-d.start,++h),this._dcIndex=h,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){let e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){let{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;Oe.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let t=this._dcIndex,{gl:e,state:i}=this.renderer,s=Oe._drawCallPool,o=null;for(let n=0;n<t;n++){let{texArray:a,type:l,size:h,start:c,blend:u}=s[n];o!==a&&(o=a,this.bindAndClearTexArray(a)),this.state.blendMode=u,i.set(this.state),e.drawElements(l,h,e.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Oe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){let e=Sr(Math.ceil(t/8)),i=io(e),s=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._aBuffers[s];return o||(this._aBuffers[s]=o=new ao(s*this.vertexSize*4)),o}getIndexBuffer(t){let e=Sr(Math.ceil(t/12)),i=io(e),s=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let o=this._iBuffers[i];return o||(this._iBuffers[i]=o=new Uint16Array(s)),o}packInterleavedGeometry(t,e,i,s,o){let{uint32View:n,float32View:a}=e,l=s/this.vertexSize,h=t.uvs,c=t.indices,u=t.vertexData,d=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),f=tt.shared.setValue(t._tintRGB).toPremultiplied(p,t._texture.baseTexture.alphaMode>0);for(let m=0;m<u.length;m+=2)a[s++]=u[m],a[s++]=u[m+1],a[s++]=h[m],a[s++]=h[m+1],n[s++]=f,a[s++]=d;for(let m=0;m<c.length;m++)i[o++]=l+c[m]}};mo.defaultBatchSize=4096,mo.extension={name:"batch",type:w.RendererPlugin},mo._drawCallPool=[],mo._textureArrayPool=[];var cr=mo;T.add(cr);var Mf=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`;var Rf=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;var Gh=class go extends hr{constructor(t,e,i){let s=Ee.from(t||go.defaultVertexSrc,e||go.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=go.defaultResolution,this.multisample=go.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Se}apply(t,e,i,s,o){t.applyFilter(this,e,i,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return Rf}static get defaultFragmentSrc(){return Mf}};Gh.defaultResolution=1,Gh.defaultMultisample=ht.NONE;var N=Gh;var ur=class{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new tt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;let{backgroundColor:e,background:i,backgroundAlpha:s}=t,o=i??e;o!==void 0&&(this.color=o),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}};ur.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},ur.extension={type:[w.RendererSystem,w.CanvasRendererSystem],name:"background"};T.add(ur);var Qi=class{constructor(t){this.renderer=t,this.emptyRenderer=new ti(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){let{boundTextures:i}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=i[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,i,s){let{elements:o,ids:n,count:a}=t,l=0;for(let h=0;h<a;h++){let c=o[h],u=c._batchLocation;if(u>=0&&u<s&&e[u]===c){n[h]=u;continue}for(;l<s;){let d=e[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}n[h]=l,c._batchLocation=l,e[l]=c;break}}}destroy(){this.renderer=null}};Qi.extension={type:w.RendererSystem,name:"batch"};T.add(Qi);var Ff=0,dr=class{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Ff++}init(t){if(t.context)this.initFromContext(t.context);else{let e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Ff++,this.renderer.runners.contextChange.emit(t);let e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){let e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(S.PREFER_ENV>=ge.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){let{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){let e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let s=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}};dr.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},dr.extension={type:w.RendererSystem,name:"context"};T.add(dr);var Mr=class{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ct("disposeFramebuffer"),this.multisample=ht.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Y(null,{scaleMode:Gt.NEAREST,resolution:1,mipmap:_e.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Y(null,{scaleMode:Gt.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:_e.OFF,format:M.DEPTH_COMPONENT,type:K.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){let s=this.colorTextures[i],o=s.resolution;s.setSize(t/o,e/o)}if(this.depthTexture){let i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}};var ei=class extends Y{constructor(t={}){if(typeof t=="number"){let e=arguments[0],i=arguments[1],s=arguments[2],o=arguments[3];t={width:e,height:i,scaleMode:s,resolution:o}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=ht.NONE),super(null,t),this.mipmap=_e.OFF,this.valid=!0,this._clear=new tt([0,0,0,0]),this.framebuffer=new Mr(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}};var jt=class extends ye{constructor(t){let e=t,i=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;super(i,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=jn(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,s){let o=t.gl,n=e.realWidth,a=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===zt.UNPACK),!this.noSubImage&&e.target===o.TEXTURE_2D&&i.width===n&&i.height===a?o.texSubImage2D(o.TEXTURE_2D,0,0,0,e.format,i.type,s):(i.width=n,i.height=a,o.texImage2D(e.target,0,i.internalFormat,e.format,i.type,s)),!0}update(){if(this.destroyed)return;let t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}};var ri=class extends jt{constructor(t,e){if(e=e||{},typeof t=="string"){let i=new Image;jt.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??S.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{let s=this.source;this.url=s.src;let o=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?o():(s.onload=o,s.onerror=n=>{i(n),this.onError.emit(n)})}),this._load)}process(){let t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);let e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===zt.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let s=!0,o=e._glTextures;for(let n in o){let a=o[n];if(a!==i&&a.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}};var ii=class{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){let s=e.width,o=e.height;if(i){let n=t.width/2/s,a=t.height/2/o,l=t.x/s+n,h=t.y/o+a;i=ft.add(i,ft.NW),this.x0=l+n*ft.uX(i),this.y0=h+a*ft.uY(i),i=ft.add(i,2),this.x1=l+n*ft.uX(i),this.y1=h+a*ft.uY(i),i=ft.add(i,2),this.x2=l+n*ft.uX(i),this.y2=h+a*ft.uY(i),i=ft.add(i,2),this.x3=l+n*ft.uX(i),this.y3=h+a*ft.uY(i)}else this.x0=t.x/s,this.y0=t.y/o,this.x1=(t.x+t.width)/s,this.y1=t.y/o,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/o,this.x3=t.x/s,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}};ii.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};var Lf=new ii;function ta(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}var b=class r extends Xe.default{constructor(t,e,i,s,o,n,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new $(0,0,1,1)),t instanceof r&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=Lf,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=n?new H(n.x,n.y):new H(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){let{resource:e}=this.baseTexture;e?.url&&Ot[e.url]&&r.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,r.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){let t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new r(this.baseTexture,!this.noFrame&&t,e,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Lf&&(this._uvs=new ii),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=S.STRICT_TEXTURE_CACHE){let s=typeof t=="string",o=null;if(s)o=t;else if(t instanceof Y){if(!t.cacheId){let a=e?.pixiIdPrefix||"pixiid";t.cacheId=`${a}-${$e()}`,Y.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){let a=e?.pixiIdPrefix||"pixiid";t._pixiId=`${a}_${$e()}`}o=t._pixiId}let n=Ot[o];if(s&&i&&!n)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!n&&!(t instanceof Y)?(e.resolution||(e.resolution=no(t)),n=new r(new Y(t,e)),n.baseTexture.cacheId=o,Y.addToCache(n.baseTexture,o),r.addToCache(n,o)):!n&&t instanceof Y&&(n=new r(t),r.addToCache(n,o)),n}static fromURL(t,e){let i=Object.assign({autoLoad:!1},e?.resourceOptions),s=r.from(t,Object.assign({resourceOptions:i},e),!1),o=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):o.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,i,s){return new r(Y.fromBuffer(t,e,i,s))}static fromLoader(t,e,i,s){let o=new Y(t,Object.assign({scaleMode:Y.defaultOptions.scaleMode,resolution:no(e)},s)),{resource:n}=o;n instanceof ri&&(n.url=e);let a=new r(o);return i||(i=e),Y.addToCache(a.baseTexture,i),r.addToCache(a,i),i!==e&&(Y.addToCache(a.baseTexture,e),r.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Ot[e]&&Ot[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Ot[e]=t)}static removeFromCache(t){if(typeof t=="string"){let e=Ot[t];if(e){let i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Ot[t],e}}else if(t?.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Ot[t.textureCacheIds[e]]===t&&delete Ot[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;let{x:e,y:i,width:s,height:o}=t,n=e+s>this.baseTexture.width,a=i+o>this.baseTexture.height;if(n||a){let l=n&&a?"and":"or",h=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,c=`Y: ${i} + ${o} = ${i+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${c}`)}this.valid=s&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return r._EMPTY||(r._EMPTY=new r(new Y),ta(r._EMPTY),ta(r._EMPTY.baseTexture)),r._EMPTY}static get WHITE(){if(!r._WHITE){let t=S.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),r._WHITE=new r(Y.from(t)),ta(r._WHITE),ta(r._WHITE.baseTexture)}return r._WHITE}};var si=class r extends b{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){let s=this.baseTexture.resolution,o=Math.round(t*s)/s,n=Math.round(e*s)/s;this.valid=o>0&&n>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=n,i&&this.baseTexture.resize(o,n),this.updateUvs()}setResolution(t){let{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new r(new ei(t))}};var Ji=class{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=ht.NONE){let s=new ei(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new si(s)}getOptimalTexture(t,e,i=1,s=ht.NONE){let o;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Sr(t),e=Sr(e),o=((t&65535)<<16|e&65535)>>>0,s>1&&(o+=s*4294967296)):o=s>1?-s:-1,this.texturePool[o]||(this.texturePool[o]=[]);let n=this.texturePool[o].pop();return n||(n=this.createTexture(t,e,s)),n.filterPoolKey=o,n.setResolution(i),n}getFilterTexture(t,e,i){let s=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||ht.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){let e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(let e in this.texturePool){let i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(let e in this.texturePool){if(!(Number(e)<0))continue;let i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}};Ji.SCREEN_KEY=-1;var yo=class extends lr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}};var xo=class extends lr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new At(this.vertices),this.uvBuffer=new At(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+e.width/t.width,this.uvs[3]=s,this.uvs[4]=i+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=i,this.uvs[7]=s+e.height/t.height,i=e.x,s=e.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=i+e.width,this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}};var vo=class{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ht.NONE,this.sourceFrame=new $,this.destinationFrame=new $,this.bindingSourceFrame=new $,this.bindingDestinationFrame=new $,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}};var ea=[new H,new H,new H,new H],zh=new st,ts=class{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Ji,this.statePool=[],this.quad=new yo,this.quadUv=new xo,this.tempRect=new $,this.activeState={},this.globalUniforms=new oe({outputFrame:new $,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){let i=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new vo,n=i.renderTexture,a,l;if(n.current){let x=n.current;a=x.resolution,l=x.multisample}else a=i.resolution,l=i.multisample;let h=e[0].resolution||a,c=e[0].multisample??l,u=e[0].padding,d=e[0].autoFit,p=e[0].legacy??!0;for(let x=1;x<e.length;x++){let y=e[x];h=Math.min(h,y.resolution||a),c=Math.min(c,y.multisample??l),u=this.useMaxPadding?Math.max(u,y.padding):u+y.padding,d=d&&y.autoFit,p=p||(y.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=n.current),s.push(o),o.resolution=h,o.multisample=c,o.legacy=p,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(u);let f=this.tempRect.copyFrom(n.sourceFrame);i.projection.transform&&this.transformAABB(zh.copyFrom(i.projection.transform).invert(),f),d?(o.sourceFrame.fit(f),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(f)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,h,c),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;let m=this.tempRect;m.x=0,m.y=0,m.width=o.sourceFrame.width,m.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(n.sourceFrame),o.bindingDestinationFrame.copyFrom(n.destinationFrame),o.transform=i.projection.transform,i.projection.transform=null,n.bind(o.renderTexture,o.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){let t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;let s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;let o=s.inputSize,n=s.inputPixel,a=s.inputClamp;if(o[0]=e.destinationFrame.width,o[1]=e.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],n[0]=Math.round(o[0]*e.resolution),n[1]=Math.round(o[1]*e.resolution),n[2]=1/n[0],n[3]=1/n[1],a[0]=.5*n[2],a[1]=.5*n[3],a[2]=e.sourceFrame.width*o[2]-.5*n[2],a[3]=e.sourceFrame.height*o[3]-.5*n[3],e.legacy){let h=s.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();let l=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,l.renderTexture,je.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,e.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,e.resolution),c.filterFrame=h.filterFrame),i[u].apply(this,h,c,je.CLEAR,e);let d=h;h=c,c=d}i[u].apply(this,h,l.renderTexture,je.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=je.CLEAR){let{renderTexture:i,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t?.filterFrame){let n=this.tempRect;n.x=0,n.y=0,n.width=t.filterFrame.width,n.height=t.filterFrame.height,i.bind(t,t.filterFrame,n)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let o=s.stateId&1||this.forceClear;(e===je.CLEAR||e===je.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,s){let o=this.renderer;o.state.set(t.state),this.bindAndClear(i,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Fe.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Fe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){let{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:o}=e._texture,n=t.set(s.width,0,0,s.height,i.x,i.y),a=e.worldTransform.copyTo(st.TEMP_MATRIX);return a.invert(),n.prepend(a),n.scale(1/o.width,1/o.height),n.translate(e.anchor.x,e.anchor.y),n}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,s=ht.NONE){return this.texturePool.getOptimalTexture(t,e,i,s)}getFilterTexture(t,e,i){if(typeof t=="number"){let o=t;t=e,e=o}t=t||this.activeState.renderTexture;let s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||ht.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){let i=ea[0],s=ea[1],o=ea[2],n=ea[3];i.set(e.left,e.top),s.set(e.left,e.bottom),o.set(e.right,e.top),n.set(e.right,e.bottom),t.apply(i,i),t.apply(s,s),t.apply(o,o),t.apply(n,n);let a=Math.min(i.x,s.x,o.x,n.x),l=Math.min(i.y,s.y,o.y,n.y),h=Math.max(i.x,s.x,o.x,n.x),c=Math.max(i.y,s.y,o.y,n.y);e.x=a,e.y=l,e.width=h-a,e.height=c-l}roundFrame(t,e,i,s,o){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(o){let{a:n,b:a,c:l,d:h}=o;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(n)>1e-4||Math.abs(h)>1e-4))return}o=o?zh.copyFrom(o):zh.identity(),o.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(o,t),t.ceil(e),this.transformAABB(o.invert(),t)}}};ts.extension={type:w.RendererSystem,name:"filter"};T.add(ts);var bo=class{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ht.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}};var pv=new $,es=class{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Mr(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new $,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;S.PREFER_ENV===ge.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){let{gl:s}=this;if(t){let o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=i),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let n=0;n<t.colorTextures.length;n++){let a=t.colorTextures[n];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){let n=e.width>>i,a=e.height>>i,l=n/e.width;this.setViewport(e.x*l,e.y*l,n,a)}else{let n=t.width>>i,a=t.height>>i;this.setViewport(0,0,n,a)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,s){let o=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),s=Math.round(s),(o.width!==i||o.height!==s||o.x!==t||o.y!==e)&&(o.x=t,o.y=e,o.width=i,o.height=s,this.gl.viewport(t,e,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,s,o=mn.COLOR|mn.DEPTH){let{gl:n}=this;n.clearColor(t,e,i,s),n.clear(o)}initFramebuffer(t){let{gl:e}=this,i=new bo(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){let{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let n;this.renderer.context.webGLVersion===1?n=e.DEPTH_STENCIL:t.depth&&t.stencil?n=e.DEPTH24_STENCIL8:t.depth?n=e.DEPTH_COMPONENT24:n=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,n,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,n,t.width,t.height)}let s=t.colorTextures,o=s.length;e.drawBuffers||(o=Math.min(o,1));for(let n=0;n<o;n++){let a=s[n],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),n===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){let{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures,n=o.length;i.drawBuffers||(n=Math.min(n,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));let a=[];for(let l=0;l<n;l++){let h=o[l],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),l===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,h.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){let l=t.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||i.createRenderbuffer();let l,h;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH_STENCIL):t.depth&&t.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH24_STENCIL8):t.depth?(l=i.DEPTH_ATTACHMENT,h=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,h=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,h,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,h,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,s.stencil)}else s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){let{msaaSamples:e}=this,i=ht.NONE;if(t<=1||e===null)return i;for(let s=0;s<e.length;s++)if(e[s]<=t){i=e[s];break}return i===1&&(i=ht.NONE),i}blit(t,e,i){let{current:s,renderer:o,gl:n,CONTEXT_UID:a}=this;if(o.context.webGLVersion!==2||!s)return;let l=s.glFramebuffers[a];if(!l)return;if(!t){if(!l.msaaBuffer)return;let c=s.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new Mr(s.width,s.height),l.blitFramebuffer.addColorTexture(0,c)),t=l.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=pv,e.width=s.width,e.height=s.height),i||(i=e);let h=e.width===i.width&&e.height===i.height;this.bind(t),n.bindFramebuffer(n.READ_FRAMEBUFFER,l.framebuffer),n.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,n.COLOR_BUFFER_BIT,h?n.NEAREST:n.LINEAR),n.bindFramebuffer(n.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){let i=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];let o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){let e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){let t=this.current;if(!t)return;let e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;let i=t.width,s=t.height,o=this.gl,n=e.stencil=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,n);let a,l;this.renderer.context.webGLVersion===1?(a=o.DEPTH_STENCIL_ATTACHMENT,l=o.DEPTH_STENCIL):t.depth?(a=o.DEPTH_STENCIL_ATTACHMENT,l=o.DEPTH24_STENCIL8):(a=o.STENCIL_ATTACHMENT,l=o.STENCIL_INDEX8),e.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,e.multisample,l,i,s):o.renderbufferStorage(o.RENDERBUFFER,l,i,s),o.framebufferRenderbuffer(o.FRAMEBUFFER,a,o.RENDERBUFFER,n)}reset(){this.current=this.unknownFramebuffer,this.viewport=new $}destroy(){this.renderer=null}};es.extension={type:w.RendererSystem,name:"framebuffer"};T.add(es);var jh={5126:4,5123:2,5121:1},rs=class{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;S.PREFER_ENV===ge.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=s=>i.bindVertexArrayOES(s),t.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){let i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(s,o)=>i.vertexAttribDivisorANGLE(s,o),t.drawElementsInstanced=(s,o,n,a,l)=>i.drawElementsInstancedANGLE(s,o,n,a,l),t.drawArraysInstanced=(s,o,n,a)=>i.drawArraysInstancedANGLE(s,o,n,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;let{gl:i}=this,s=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},o=!0);let n=s[e.program.id]||this.initGeometryVao(t,e,o);this._activeGeometry=t,this._activeVao!==n&&(this._activeVao=n,this.hasVao?i.bindVertexArray(n):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){let s=t.buffers[i];e.update(s)}}checkCompatibility(t,e){let i=t.attributes,s=e.attributeData;for(let o in s)if(!i[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,e){let i=t.attributes,s=e.attributeData,o=["g",t.id];for(let n in i)s[n]&&o.push(n,s[n].location);return o.join("-")}initGeometryVao(t,e,i=!0){let s=this.gl,o=this.CONTEXT_UID,n=this.renderer.buffer,a=e.program;a.glPrograms[o]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);let l=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID],c=h[l];if(c)return h[a.id]=c,c;let u=t.buffers,d=t.attributes,p={},f={};for(let m in u)p[m]=0,f[m]=0;for(let m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),p[d[m].buffer]+=d[m].size*jh[d[m].type];for(let m in d){let x=d[m],y=x.size;x.stride===void 0&&(p[x.buffer]===y*jh[x.type]?x.stride=0:x.stride=p[x.buffer]),x.start===void 0&&(x.start=f[x.buffer],f[x.buffer]+=y*jh[x.type])}c=s.createVertexArray(),s.bindVertexArray(c);for(let m=0;m<u.length;m++){let x=u[m];n.bind(x),i&&x._glBuffers[o].refCount++}return this.activateVao(t,a),h[a.id]=c,h[l]=c,s.bindVertexArray(null),n.unbind(he.ARRAY_BUFFER),c}disposeGeometry(t,e){if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];let i=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,o=t.buffers,n=this.renderer?.buffer;if(t.disposeRunner.remove(this),!!i){if(n)for(let a=0;a<o.length;a++){let l=o[a]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&n.dispose(o[a],e))}if(!e){for(let a in i)if(a[0]==="g"){let l=i[a];this._activeVao===l&&this.unbind(),s.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){let e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){let i=this.gl,s=this.CONTEXT_UID,o=this.renderer.buffer,n=t.buffers,a=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let l=null;for(let h in a){let c=a[h],u=n[c.buffer],d=u._glBuffers[s];if(e.attributeData[h]){l!==d&&(o.bind(u),l=d);let p=e.attributeData[h].location;if(i.enableVertexAttribArray(p),i.vertexAttribPointer(p,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(p,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,s){let{gl:o}=this,n=this._activeGeometry;if(n.indexBuffer){let a=n.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?n.instanced?o.drawElementsInstanced(t,e||n.indexBuffer.data.length,l,(i||0)*a,s||1):o.drawElements(t,e||n.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else n.instanced?o.drawArraysInstanced(t,i,e||n.getSize(),s||1):o.drawArrays(t,i,e||n.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}};rs.extension={type:w.RendererSystem,name:"geometry"};T.add(rs);var Bf=new st,_o=class{constructor(t,e){this._texture=t,this.mapCoord=new st,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);let i=this.mapCoord;for(let s=0;s<t.length;s+=2){let o=t[s],n=t[s+1];e[s]=o*i.a+n*i.c+i.tx,e[s+1]=o*i.b+n*i.d+i.ty}return e}update(t){let e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;let i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);let s=e.orig,o=e.trim;o&&(Bf.set(s.width/o.width,0,0,s.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(Bf));let n=e.baseTexture,a=this.uClampFrame,l=this.clampMargin/n.resolution,h=this.clampOffset;return a[0]=(e._frame.x+l+h)/n.width,a[1]=(e._frame.y+l+h)/n.height,a[2]=(e._frame.x+e._frame.width-l+h)/n.width,a[3]=(e._frame.y+e._frame.height-l+h)/n.height,this.uClampOffset[0]=h/n.realWidth,this.uClampOffset[1]=h/n.realHeight,this.isSimple=e._frame.width===n.width&&e._frame.height===n.height&&e.rotate===0,!0}};var kf=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`;var Of=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;var wo=class extends N{constructor(t,e,i){let s=null;typeof t!="string"&&e===void 0&&i===void 0&&(s=t,t=void 0,e=void 0,i=void 0),super(t||Of,e||kf,i),this.maskSprite=s,this.maskMatrix=new st}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,s){let o=this._maskSprite,n=o._texture;n.valid&&(n.uvMatrix||(n.uvMatrix=new _o(n,0)),n.uvMatrix.update(),this.uniforms.npmAlpha=n.baseTexture.alphaMode?0:1,this.uniforms.mask=n,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(n.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=n.uvMatrix.uClampFrame,t.applyFilter(this,e,i,s))}};var To=class{constructor(t=null){this.type=_t.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=N.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=_t.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}};var is=class{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){let o=this.maskDataPool.pop()||new To;o.pooled=!0,o.maskObject=e,i=o}let s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==_t.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case _t.SCISSOR:this.renderer.scissor.push(i);break;case _t.STENCIL:this.renderer.stencil.push(i);break;case _t.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case _t.COLOR:this.pushColorMask(i);break;default:break}i.type===_t.SPRITE&&this.maskStack.push(i)}pop(t){let e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case _t.SCISSOR:this.renderer.scissor.pop(e);break;case _t.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case _t.SPRITE:this.popSpriteMask(e);break;case _t.COLOR:this.popColorMask(e);break;default:break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){let i=this.maskStack[this.maskStack.length-1];i.type===_t.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){let e=t.maskObject;e?e.isSprite?t.type=_t.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=_t.SCISSOR:t.type=_t.STENCIL:t.type=_t.COLOR}pushSpriteMask(t){let{maskObject:e}=t,i=t._target,s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new wo])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;let o=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,s),i.filterArea=o,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){let e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){let e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}};is.extension={type:w.RendererSystem,name:"mask"};T.add(is);var ss=class{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){let{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;let s=this.getStackLength();s!==i&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}};var Df=new st,Nf=[],Uf=class ra extends ss{constructor(t){super(t),this.glConst=S.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;let e=t._scissorRect,{maskObject:i}=t,{renderer:s}=this,o=s.renderTexture,n=i.getBounds(!0,Nf.pop()??new $);this.roundFrameToPixels(n,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),e&&n.fit(e),t._scissorRectLocal=n}static isMatrixRotated(t){if(!t)return!1;let{a:e,b:i,c:s,d:o}=t;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(o)>1e-4)}testScissor(t){let{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||ra.isMatrixRotated(e.worldTransform)||ra.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);let i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,s,o){ra.isMatrixRotated(o)||(o=o?Df.copyFrom(o):Df.identity(),o.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(o,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);let{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){let{gl:e}=this.renderer;t&&Nf.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){let t=this.maskStack[this.maskStack.length-1]._scissorRect,e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};Uf.extension={type:w.RendererSystem,name:"scissor"};var Vh=Uf;T.add(Vh);var os=class extends ss{constructor(t){super(t),this.glConst=S.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){let e=t.maskObject,{gl:i}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;let o=t._colorMask;o!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,o!==0&&(t._colorMask=o,i.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){let e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{let i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(i._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){let t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}};os.extension={type:w.RendererSystem,name:"stencil"};T.add(os);var ns=class{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return W("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return W("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return W("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){let t=this.rendererPlugins;for(let e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(let t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}};ns.extension={type:[w.RendererSystem,w.CanvasRendererSystem],name:"_plugin"};T.add(ns);var as=class{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new st,this.transform=null}update(t,e,i,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);let o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,e,i,s){let o=this.projectionMatrix,n=s?-1:1;o.identity(),o.a=1/e.width*2,o.d=n*(1/e.height*2),o.tx=-1-e.x*o.a,o.ty=-n-e.y*o.d}setTransform(t){}destroy(){this.renderer=null}};as.extension={type:w.RendererSystem,name:"projection"};T.add(as);var fv=new Ki,Gf=new $,ls=class{constructor(t){this.renderer=t,this._tempMatrix=new st}generateTexture(t,e){let{region:i,...s}=e||{},o=i?.copyTo(Gf)||t.getLocalBounds(Gf,!0),n=s.resolution||this.renderer.resolution;o.width=Math.max(o.width,1/n),o.height=Math.max(o.height,1/n),s.width=o.width,s.height=o.height,s.resolution=n,s.multisample??(s.multisample=this.renderer.multisample);let a=si.create(s);this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;let l=t.transform;return t.transform=fv,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,a}destroy(){}};ls.extension={type:[w.RendererSystem,w.CanvasRendererSystem],name:"textureGenerator"};T.add(ls);var oi=new $,Co=new $,hs=class{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new $,this.destinationFrame=new $,this.viewportFrame=new $}contextChange(){let t=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){let s=this.renderer;this.current=t;let o,n,a;t?(o=t.baseTexture,a=o.resolution,e||(oi.width=t.frame.width,oi.height=t.frame.height,e=oi),i||(Co.x=t.frame.x,Co.y=t.frame.y,Co.width=e.width,Co.height=e.height,i=Co),n=o.framebuffer):(a=s.resolution,e||(oi.width=s._view.screen.width,oi.height=s._view.screen.height,e=oi),i||(i=oi,i.width=e.width,i.height=e.height));let l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,t||(l.y=s.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(n,l),this.renderer.projection.update(i,e,a,!n),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){let i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=tt.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);let o=this.destinationFrame,n=this.current?this.current.baseTexture:this.renderer._view.screen,a=o.width!==n.width||o.height!==n.height;if(a){let{x:l,y:h,width:c,height:u}=this.viewportFrame;l=Math.round(l),h=Math.round(h),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,c,u)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}};hs.extension={type:w.RendererSystem,name:"renderTexture"};T.add(hs);var So=class{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}};function zf(r,t){let e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){let o=t.getActiveAttrib(r,s);if(o.name.startsWith("gl_"))continue;let n=uo(t,o.type),a={type:n,name:o.name,size:co(n),location:t.getAttribLocation(r,o.name)};e[o.name]=a}return e}function jf(r,t){let e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){let o=t.getActiveUniform(r,s),n=o.name.replace(/\[.*?\]$/,""),a=!!o.name.match(/\[.*?\]$/),l=uo(t,o.type);e[n]={name:n,index:s,type:l,size:o.size,isArray:a,value:ho(l,o.size)}}return e}function Hh(r,t){let e=Xn(r,r.VERTEX_SHADER,t.vertexSrc),i=Xn(r,r.FRAGMENT_SHADER,t.fragmentSrc),s=r.createProgram();r.attachShader(s,e),r.attachShader(s,i);let o=t.extra?.transformFeedbackVaryings;if(o&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(s,o.names,o.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||Nh(r,s,e,i),t.attributeData=zf(s,r),t.uniformData=jf(s,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let a=Object.keys(t.attributeData);a.sort((l,h)=>l>h?1:-1);for(let l=0;l<a.length;l++)t.attributeData[a[l]].location=l,r.bindAttribLocation(s,l,a[l]);r.linkProgram(s)}r.deleteShader(e),r.deleteShader(i);let n={};for(let a in t.uniformData){let l=t.uniformData[a];n[a]={location:r.getUniformLocation(s,a),value:ho(l.type,l.size)}}return new So(s,n)}function mv(r,t,e,i,s){e.buffer.update(s)}var gv={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Vf={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Hf(r){let t=r.map(o=>({data:o,offset:0,dataLen:0,dirty:0})),e=0,i=0,s=0;for(let o=0;o<t.length;o++){let n=t[o];if(e=Vf[n.data.type],n.data.size>1&&(e=Math.max(e,16)*n.data.size),n.dataLen=e,i%e!==0&&i<16){let a=i%e%16;i+=a,s+=a}i+e>16?(s=Math.ceil(s/16)*16,n.offset=s,s+=e,i=e):(n.offset=s,i+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function $f(r,t){let e=[];for(let i in r)t[i]&&e.push(t[i]);return e.sort((i,s)=>i.index-s.index),e}function $h(r,t){if(!r.autoManage)return{size:0,syncFunc:mv};let e=$f(r.uniforms,t),{uboElements:i,size:s}=Hf(e),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let n=0;n<i.length;n++){let a=i[n],l=r.uniforms[a.data.name],h=a.data.name,c=!1;for(let u=0;u<We.length;u++){let d=We[u];if(d.codeUbo&&d.test(a.data,l)){o.push(`offset = ${a.offset/4};`,We[u].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){let u=co(a.data.type),d=Math.max(Vf[a.data.type]/16,1),p=u/d,f=(4-p%4)%4;o.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${p}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${f};
                }

                `)}else{let u=gv[a.data.type];o.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${u};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}var yv=0,ia={textureCount:0,uboCount:0},cs=class{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=yv++}systemCheck(){if(!Qn())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;let i=t.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),e||(ia.textureCount=0,ia.uboCount=0,this.syncUniformGroup(t.uniformGroup,ia)),s}setUniforms(t){let e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){let i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){let e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Oh(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){let i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;let s=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),s(i.uniformData,t.uniforms,this.renderer,ia,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){let{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);let o=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;let n=this.getSignature(t,this.shader.program.uniformData,"ubo"),a=this._uboCache[n];if(a||(a=this._uboCache[n]=$h(t,this.shader.program.uniformData)),t.autoManage){let l=new Float32Array(a.size/4);t.buffer.update(l)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){let s=t.uniforms,o=[`${i}-`];for(let n in s)o.push(n),e[n]&&o.push(e[n].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){let e=this.gl,i=t.program,s=Hh(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}};cs.extension={type:w.RendererSystem,name:"shader"};T.add(cs);var pr=class{constructor(t){this.renderer=t}run(t){let{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.3.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}};pr.defaultOptions={hello:!1},pr.extension={type:[w.RendererSystem,w.CanvasRendererSystem],name:"startup"};T.add(pr);function Xf(r,t=[]){return t[j.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.ADD]=[r.ONE,r.ONE],t[j.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.NONE]=[0,0],t[j.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[j.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[j.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[j.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[j.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[j.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[j.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[j.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[j.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[j.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[j.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}var xv=0,vv=1,bv=2,_v=3,wv=4,Tv=5,Wf=class Xh{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=j.NONE,this._blendEq=!1,this.map=[],this.map[xv]=this.setBlend,this.map[vv]=this.setOffset,this.map[bv]=this.setCullFace,this.map[_v]=this.setDepthTest,this.map[wv]=this.setFrontFace,this.map[Tv]=this.setDepthMask,this.checks=[],this.defaultState=new Se,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=Xf(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(Xh.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(Xh.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;let e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){let i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};Wf.extension={type:w.RendererSystem,name:"state"};var Wh=Wf;T.add(Wh);var us=class extends Xe.default{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);let e=(t.priority??[]).filter(s=>t.systems[s]),i=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(let s of i)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new Ct(e)})}addSystem(t,e){let i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(let s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(t,e){let i=Object.keys(this._systemsHash);t.items.forEach(s=>{let o=i.find(n=>this._systemsHash[n]===s);s[t.name](e[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}};var Eo=class sa{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=sa.defaultMaxIdle,this.checkCountMax=sa.defaultCheckCountMax,this.mode=sa.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==gn.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let t=this.renderer.texture,e=t.managedTextures,i=!1;for(let s=0;s<e.length;s++){let o=e[s];o.resource&&this.count-o.touched>this.maxIdle&&(t.destroyTexture(o,!0),e[s]=null,i=!0)}if(i){let s=0;for(let o=0;o<e.length;o++)e[o]!==null&&(e[s++]=e[o]);e.length=s}}unload(t){let e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};Eo.defaultMode=gn.AUTO,Eo.defaultMaxIdle=60*60,Eo.defaultCheckCountMax=60*10,Eo.extension={type:w.RendererSystem,name:"textureGC"};var Ye=Eo;T.add(Ye);var ni=class{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=K.UNSIGNED_BYTE,this.internalFormat=M.RGBA,this.samplerType=0}};function Yf(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[r.RGB]:B.FLOAT,[r.RGBA]:B.FLOAT,[r.ALPHA]:B.FLOAT,[r.LUMINANCE]:B.FLOAT,[r.LUMINANCE_ALPHA]:B.FLOAT,[r.R8]:B.FLOAT,[r.R8_SNORM]:B.FLOAT,[r.RG8]:B.FLOAT,[r.RG8_SNORM]:B.FLOAT,[r.RGB8]:B.FLOAT,[r.RGB8_SNORM]:B.FLOAT,[r.RGB565]:B.FLOAT,[r.RGBA4]:B.FLOAT,[r.RGB5_A1]:B.FLOAT,[r.RGBA8]:B.FLOAT,[r.RGBA8_SNORM]:B.FLOAT,[r.RGB10_A2]:B.FLOAT,[r.RGB10_A2UI]:B.FLOAT,[r.SRGB8]:B.FLOAT,[r.SRGB8_ALPHA8]:B.FLOAT,[r.R16F]:B.FLOAT,[r.RG16F]:B.FLOAT,[r.RGB16F]:B.FLOAT,[r.RGBA16F]:B.FLOAT,[r.R32F]:B.FLOAT,[r.RG32F]:B.FLOAT,[r.RGB32F]:B.FLOAT,[r.RGBA32F]:B.FLOAT,[r.R11F_G11F_B10F]:B.FLOAT,[r.RGB9_E5]:B.FLOAT,[r.R8I]:B.INT,[r.R8UI]:B.UINT,[r.R16I]:B.INT,[r.R16UI]:B.UINT,[r.R32I]:B.INT,[r.R32UI]:B.UINT,[r.RG8I]:B.INT,[r.RG8UI]:B.UINT,[r.RG16I]:B.INT,[r.RG16UI]:B.UINT,[r.RG32I]:B.INT,[r.RG32UI]:B.UINT,[r.RGB8I]:B.INT,[r.RGB8UI]:B.UINT,[r.RGB16I]:B.INT,[r.RGB16UI]:B.UINT,[r.RGB32I]:B.INT,[r.RGB32UI]:B.UINT,[r.RGBA8I]:B.INT,[r.RGBA8UI]:B.UINT,[r.RGBA16I]:B.INT,[r.RGBA16UI]:B.UINT,[r.RGBA32I]:B.INT,[r.RGBA32UI]:B.UINT,[r.DEPTH_COMPONENT16]:B.FLOAT,[r.DEPTH_COMPONENT24]:B.FLOAT,[r.DEPTH_COMPONENT32F]:B.FLOAT,[r.DEPTH_STENCIL]:B.FLOAT,[r.DEPTH24_STENCIL8]:B.FLOAT,[r.DEPTH32F_STENCIL8]:B.FLOAT}:t={[r.RGB]:B.FLOAT,[r.RGBA]:B.FLOAT,[r.ALPHA]:B.FLOAT,[r.LUMINANCE]:B.FLOAT,[r.LUMINANCE_ALPHA]:B.FLOAT,[r.DEPTH_STENCIL]:B.FLOAT},t}function qf(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[K.UNSIGNED_BYTE]:{[M.RGBA]:r.RGBA8,[M.RGB]:r.RGB8,[M.RG]:r.RG8,[M.RED]:r.R8,[M.RGBA_INTEGER]:r.RGBA8UI,[M.RGB_INTEGER]:r.RGB8UI,[M.RG_INTEGER]:r.RG8UI,[M.RED_INTEGER]:r.R8UI,[M.ALPHA]:r.ALPHA,[M.LUMINANCE]:r.LUMINANCE,[M.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[K.BYTE]:{[M.RGBA]:r.RGBA8_SNORM,[M.RGB]:r.RGB8_SNORM,[M.RG]:r.RG8_SNORM,[M.RED]:r.R8_SNORM,[M.RGBA_INTEGER]:r.RGBA8I,[M.RGB_INTEGER]:r.RGB8I,[M.RG_INTEGER]:r.RG8I,[M.RED_INTEGER]:r.R8I},[K.UNSIGNED_SHORT]:{[M.RGBA_INTEGER]:r.RGBA16UI,[M.RGB_INTEGER]:r.RGB16UI,[M.RG_INTEGER]:r.RG16UI,[M.RED_INTEGER]:r.R16UI,[M.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[K.SHORT]:{[M.RGBA_INTEGER]:r.RGBA16I,[M.RGB_INTEGER]:r.RGB16I,[M.RG_INTEGER]:r.RG16I,[M.RED_INTEGER]:r.R16I},[K.UNSIGNED_INT]:{[M.RGBA_INTEGER]:r.RGBA32UI,[M.RGB_INTEGER]:r.RGB32UI,[M.RG_INTEGER]:r.RG32UI,[M.RED_INTEGER]:r.R32UI,[M.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[K.INT]:{[M.RGBA_INTEGER]:r.RGBA32I,[M.RGB_INTEGER]:r.RGB32I,[M.RG_INTEGER]:r.RG32I,[M.RED_INTEGER]:r.R32I},[K.FLOAT]:{[M.RGBA]:r.RGBA32F,[M.RGB]:r.RGB32F,[M.RG]:r.RG32F,[M.RED]:r.R32F,[M.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[K.HALF_FLOAT]:{[M.RGBA]:r.RGBA16F,[M.RGB]:r.RGB16F,[M.RG]:r.RG16F,[M.RED]:r.R16F},[K.UNSIGNED_SHORT_5_6_5]:{[M.RGB]:r.RGB565},[K.UNSIGNED_SHORT_4_4_4_4]:{[M.RGBA]:r.RGBA4},[K.UNSIGNED_SHORT_5_5_5_1]:{[M.RGBA]:r.RGB5_A1},[K.UNSIGNED_INT_2_10_10_10_REV]:{[M.RGBA]:r.RGB10_A2,[M.RGBA_INTEGER]:r.RGB10_A2UI},[K.UNSIGNED_INT_10F_11F_11F_REV]:{[M.RGB]:r.R11F_G11F_B10F},[K.UNSIGNED_INT_5_9_9_9_REV]:{[M.RGB]:r.RGB9_E5},[K.UNSIGNED_INT_24_8]:{[M.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[K.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[M.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[K.UNSIGNED_BYTE]:{[M.RGBA]:r.RGBA,[M.RGB]:r.RGB,[M.ALPHA]:r.ALPHA,[M.LUMINANCE]:r.LUMINANCE,[M.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[K.UNSIGNED_SHORT_5_6_5]:{[M.RGB]:r.RGB},[K.UNSIGNED_SHORT_4_4_4_4]:{[M.RGBA]:r.RGBA},[K.UNSIGNED_SHORT_5_5_5_1]:{[M.RGBA]:r.RGBA}},t}var ds=class{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Y,this.hasIntegerTextures=!1}contextChange(){let t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=qf(t),this.samplerTypes=Yf(t);let e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};let i=new ni(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ni(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){let{gl:i}=this;if(t=t?.castToBaseTexture(),t?.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;let s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){let{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[s]=null)}ensureSamplerType(t){let{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let o=t-1;o>=0;--o){let n=e[o];n&&n._glTextures[s].samplerType!==B.FLOAT&&this.renderer.texture.unbind(n)}}initTexture(t){let e=new ni(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){e.internalFormat=this.internalFormats[t.type]?.[t.format]??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??B.FLOAT,this.webGLVersion===2&&t.type===K.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){let e=t._glTextures[this.CONTEXT_UID];if(!e)return;let i=this.renderer;if(this.initTextureType(t,e),t.resource?.upload(i,t,e))e.samplerType!==B.FLOAT&&(this.hasIntegerTextures=!0);else{let s=t.realWidth,o=t.realHeight,n=i.gl;(e.width!==s||e.height!==o||e.dirtyId<0)&&(e.width=s,e.height=o,n.texImage2D(t.target,0,e.internalFormat,s,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){let{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){let s=this.managedTextures.indexOf(t);s!==-1&&Un(this.managedTextures,s,1)}}updateTextureStyle(t){let e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===_e.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=vr.CLAMP:e.wrapMode=t.wrapMode,t.resource?.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){let i=this.gl;if(e.mipmap&&t.mipmap!==_e.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);let s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Gt.LINEAR){let o=Math.min(t.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===Gt.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}};ds.extension={type:w.RendererSystem,name:"texture"};T.add(ds);var ps=class{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:e,CONTEXT_UID:i}=this,s=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){let{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){let{gl:i,renderer:s}=this;e&&s.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){let{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){let{gl:e,renderer:i,CONTEXT_UID:s}=this,o=e.createTransformFeedback();t._glTransformFeedbacks[s]=o,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,o);for(let n=0;n<t.buffers.length;n++){let a=t.buffers[n];a&&(i.buffer.update(a),a._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,n,a._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,e){let i=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);let o=this.renderer.buffer;if(o)for(let n=0;n<t.buffers.length;n++){let a=t.buffers[n];if(!a)continue;let l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(a,e))}i&&(e||s.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}};ps.extension={type:w.RendererSystem,name:"transformFeedback"};T.add(ps);var fr=class{constructor(t){this.renderer=t}init(t){this.screen=new $(0,0,t.width,t.height),this.element=t.view||S.ADAPTER.createCanvas(),this.resolution=t.resolution||S.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);let i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){t&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}};fr.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},fr.extension={type:[w.RendererSystem,w.CanvasRendererSystem],name:"_view"};T.add(fr);S.PREFER_ENV=ge.WEBGL2;S.STRICT_TEXTURE_CACHE=!1;S.RENDER_OPTIONS={...dr.defaultOptions,...ur.defaultOptions,...fr.defaultOptions,...pr.defaultOptions};Object.defineProperties(S,{WRAP_MODE:{get(){return Y.defaultOptions.wrapMode},set(r){W("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Y.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return Y.defaultOptions.scaleMode},set(r){W("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Y.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return Y.defaultOptions.mipmap},set(r){W("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Y.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return Y.defaultOptions.anisotropicLevel},set(r){W("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Y.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return W("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),N.defaultResolution},set(r){N.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return W("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),N.defaultMultisample},set(r){N.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return cr.defaultMaxTextures},set(r){W("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),cr.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return cr.defaultBatchSize},set(r){W("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),cr.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return cr.canUploadSameBuffer},set(r){W("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),cr.canUploadSameBuffer=r}},GC_MODE:{get(){return Ye.defaultMode},set(r){W("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ye.defaultMode=r}},GC_MAX_IDLE:{get(){return Ye.defaultMaxIdle},set(r){W("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ye.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return Ye.defaultCheckCountMax},set(r){W("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ye.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return Ee.defaultVertexPrecision},set(r){W("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Ee.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return Ee.defaultFragmentPrecision},set(r){W("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Ee.defaultFragmentPrecision=r}}});var De=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(De||{});var fs=class{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));let e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let e=this.next;return this.next=t?null:e,this.previous=null,e}};var Kf=class xe{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new fs(null,null,1/0),this.deltaMS=1/xe.targetFPMS,this.elapsedMS=1/xe.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=De.NORMAL){return this._addListener(new fs(t,e,i))}addOnce(t,e,i=De.NORMAL){return this._addListener(new fs(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){let o=t-this._lastFrame|0;if(o<this._minElapsedMS)return;this._lastFrame=t-o%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*xe.targetFPMS;let i=this._head,s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){let e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,xe.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{let e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!xe._shared){let t=xe._shared=new xe;t.autoStart=!0,t._protected=!0}return xe._shared}static get system(){if(!xe._system){let t=xe._system=new xe;t.autoStart=!0,t._protected=!0}return xe._system}};Kf.targetFPMS=.06;var ut=Kf;Object.defineProperties(S,{TARGET_FPMS:{get(){return ut.targetFPMS},set(r){W("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ut.targetFPMS=r}}});var Ao=class{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,De.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ut.shared:new ut,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}};Ao.extension=w.Application;T.add(Ao);var Zf=[];T.handleByList(w.Renderer,Zf);function Yh(r){for(let t of Zf)if(t.test(r))return new t(r);throw new Error("Unable to auto-detect a suitable renderer.")}var Io=class{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){let i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{let i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=ht.HIGH?this.multisample=ht.HIGH:e>=ht.MEDIUM?this.multisample=ht.MEDIUM:e>=ht.LOW?this.multisample=ht.LOW:this.multisample=ht.NONE}destroy(){}};Io.extension={type:w.RendererSystem,name:"_multisample"};T.add(Io);var oa=class{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}};var Po=class{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){let{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){let{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){let{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){let o=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,o.buffer)}}bindBufferRange(t,e,i){let{gl:s,CONTEXT_UID:o}=this;i=i||0;let n=t._glBuffers[o]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,n.buffer,i*256,256)}update(t){let{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{let o=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,o)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];let i=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),i&&(e||s.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){let e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){let{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new oa(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}};Po.extension={type:w.RendererSystem,name:"buffer"};T.add(Po);var Mo=class{constructor(t){this.renderer=t}render(t,e){let i=this.renderer,s,o,n,a;if(e&&(s=e.renderTexture,o=e.clear,n=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=n,!i.context.isLost){if(s||(this.lastObjectRendered=t),!a){let l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(o??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),s&&(e.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}};Mo.extension={type:w.RendererSystem,name:"objectRenderer"};T.add(Mo);var na=class qh extends us{constructor(t){super(),this.type=Ml.WEBGL,t=Object.assign({},S.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new oe({projectionMatrix:new st},!0);let e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:qh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(W("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=qh.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t?.forceCanvas?!1:kn()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return W("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return W("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return W("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return W("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){W("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return W("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){W("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return W("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};na.extension={type:w.Renderer,priority:1},na.__plugins={},na.__systems={};var aa=na;T.handleByMap(w.RendererPlugin,aa.__plugins);T.handleByMap(w.RendererSystem,aa.__systems);T.add(aa);var Rr=class extends ye{constructor(t,e){let{width:i,height:s}=e||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){let n=new Y;this.items.push(n),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof ye?this.addResourceAt(t[i],i):this.addResourceAt(Hi(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;let t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{let{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}};var Ro=class extends Rr{constructor(t,e){let{width:i,height:s}=e||{},o,n;Array.isArray(t)?(o=t,n=t.length):n=t,super(n,{width:i,height:s}),o&&this.initFromArray(o,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=sr.TEXTURE_2D_ARRAY}upload(t,e,i){let{length:s,itemDirtyIds:o,items:n}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,e.format,i.type,null);for(let l=0;l<s;l++){let h=n[l];o[l]<h.dirtyId&&(o[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,e.format,i.type,h.resource.source))}return!0}};var Fo=class extends jt{constructor(t){super(t)}static test(t){let{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}};var Qf=class Lo extends Rr{constructor(t,e){let{width:i,height:s,autoLoad:o,linkBaseTexture:n}=e||{};if(t&&t.length!==Lo.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:s});for(let a=0;a<Lo.SIDES;a++)this.items[a].target=sr.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=n!==!1,t&&this.initFromArray(t,e),o!==!1&&this.load()}bind(t){super.bind(t),t.target=sr.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=sr.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){let s=this.itemDirtyIds;for(let o=0;o<Lo.SIDES;o++){let n=this.items[o];(s[o]<n.dirtyId||i.dirtyId<e.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(t,n,i),s[o]=n.dirtyId):s[o]<-1&&(t.gl.texImage2D(n.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),s[o]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Lo.SIDES}};Qf.SIDES=6;var Kh=Qf;var Bo=class r extends jt{constructor(t,e){e=e||{};let i,s,o;typeof t=="string"?(i=r.EMPTY,s=t,o=!0):(i=t,s=null,o=!1),super(i),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??o,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{let i=await S.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let s=await i.blob();if(this.destroyed)return;let o=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===zt.UNPACK?"premultiply":"none"});if(this.destroyed){o.close();return}this.source=o,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return r._EMPTY=r._EMPTY??S.ADAPTER.createCanvas(0,0),r._EMPTY}};var Zh=class la extends jt{constructor(t,e){e=e||{},super(S.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},la.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){let t=new Image;jt.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;let e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,o=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*e,o=this._overrideHeight||this._overrideWidth/e*i),s=Math.round(s),o=Math.round(o);let n=this.source;n.width=s,n.height=o,n._pixiId=`canvas_${$e()}`,n.getContext("2d").drawImage(t,0,0,e,i,0,0,s,o),this._resolve(),this._resolve=null}}static getSize(t){let e=la.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&la.SVG_XML.test(t)}};Zh.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,Zh.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var ms=Zh;var Qh=class Jh extends jt{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){let i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);let s=t[0].src||t[0];jt.crossOrigin(i,s,e.crossorigin);for(let o=0;o<t.length;++o){let n=document.createElement("source"),{src:a,mime:l}=t[o];if(a=a||t[o],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){let h=a.split("?").shift().toLowerCase(),c=h.slice(h.lastIndexOf(".")+1);l=l||Jh.MIME_TYPES[c]||`video/${c}`}n.src=a,l&&(n.type=l),i.appendChild(n)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){let e=ut.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;let t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){let t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){let t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);let e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();let t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ut.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ut.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ut.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||Jh.TYPES.includes(e)}};Qh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],Qh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};var ko=Qh;lo.push(Bo,ri,Fo,ko,ms,Yr,Kh,Ro);var qe=class{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?$.EMPTY:(t=t||new $(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){let{a:i,b:s,c:o,d:n,tx:a,ty:l}=t,h=i*e.x+o*e.y+a,c=s*e.x+n*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,i=this.minY,s=this.maxX,o=this.maxY,n=t[0],a=t[1];e=n<e?n:e,i=a<i?a:i,s=n>s?n:s,o=a>o?a:o,n=t[2],a=t[3],e=n<e?n:e,i=a<i?a:i,s=n>s?n:s,o=a>o?a:o,n=t[4],a=t[5],e=n<e?n:e,i=a<i?a:i,s=n>s?n:s,o=a>o?a:o,n=t[6],a=t[7],e=n<e?n:e,i=a<i?a:i,s=n>s?n:s,o=a>o?a:o,this.minX=e,this.minY=i,this.maxX=s,this.maxY=o}addFrame(t,e,i,s,o){this.addFrameMatrix(t.worldTransform,e,i,s,o)}addFrameMatrix(t,e,i,s,o){let n=t.a,a=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty,d=this.minX,p=this.minY,f=this.maxX,m=this.maxY,x=n*e+l*i+c,y=a*e+h*i+u;d=x<d?x:d,p=y<p?y:p,f=x>f?x:f,m=y>m?y:m,x=n*s+l*i+c,y=a*s+h*i+u,d=x<d?x:d,p=y<p?y:p,f=x>f?x:f,m=y>m?y:m,x=n*e+l*o+c,y=a*e+h*o+u,d=x<d?x:d,p=y<p?y:p,f=x>f?x:f,m=y>m?y:m,x=n*s+l*o+c,y=a*s+h*o+u,d=x<d?x:d,p=y<p?y:p,f=x>f?x:f,m=y>m?y:m,this.minX=d,this.minY=p,this.maxX=f,this.maxY=m}addVertexData(t,e,i){let s=this.minX,o=this.minY,n=this.maxX,a=this.maxY;for(let l=e;l<i;l+=2){let h=t[l],c=t[l+1];s=h<s?h:s,o=c<o?c:o,n=h>n?h:n,a=c>a?c:a}this.minX=s,this.minY=o,this.maxX=n,this.maxY=a}addVertices(t,e,i,s){this.addVerticesMatrix(t.worldTransform,e,i,s)}addVerticesMatrix(t,e,i,s,o=0,n=o){let a=t.a,l=t.b,h=t.c,c=t.d,u=t.tx,d=t.ty,p=this.minX,f=this.minY,m=this.maxX,x=this.maxY;for(let y=i;y<s;y+=2){let _=e[y],g=e[y+1],v=a*_+h*g+u,U=c*g+l*_+d;p=Math.min(p,v-o),m=Math.max(m,v+o),f=Math.min(f,U-n),x=Math.max(x,U+n)}this.minX=p,this.minY=f,this.maxX=m,this.maxY=x}addBounds(t){let e=this.minX,i=this.minY,s=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,e){let i=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,n=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=o&&s<=n){let a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<l?s:l,this.maxX=o>h?o:h,this.maxY=n>c?n:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){let i=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,n=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=o&&s<=n){let a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<l?s:l,this.maxX=o>h?o:h,this.maxY=n>c?n:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,s,o,n){t-=o,e-=n,i+=o,s+=n,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}};var Ke=class r extends A.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new Ki,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new qe,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){let e=Object.keys(t);for(let i=0;i<e.length;++i){let s=e[i];Object.defineProperty(r.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new $),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new $),t=this._localBoundsRect),this._localBounds||(this._localBounds=new qe);let e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=i?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;let s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;let n=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-o,n}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,s){return e&&(t=e.toGlobal(t,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){this.parent?.removeChild(this)}setTransform(t=0,e=0,i=1,s=1,o=0,n=0,a=0,l=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=s||1,this.rotation=o,this.skew.x=n,this.skew.y=a,this.pivot.x=l,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new ha),this.tempDisplayObjectParent}enableTempParent(){let t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*Fh}set angle(t){this.transform.rotation=t*ke}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}},ha=class extends Ke{constructor(){super(...arguments),this.sortDirty=null}};Ke.prototype.displayObjectUpdateTransform=Ke.prototype.updateTransform;var Sv=new st;function Ev(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}var Jf=class tc extends Ke{constructor(){super(),this.children=[],this.sortableChildren=tc.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{let e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;let i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t,this.onChildrenChange(i<s?i:s)}getChildIndex(t){let e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);let i=this.getChildIndex(t);A.removeItems(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{let e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,A.removeItems(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){let e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,A.removeItems(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){let i=t,s=e,o=s-i,n;if(o>0&&o<=s){n=this.children.splice(i,o);for(let a=0;a<n.length;++a)n[a].parent=null,n[a].transform&&(n[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<n.length;++a)n[a].emit("removed",this),this.emit("childRemoved",n[a],this,a);return n}else if(o===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){let s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(Ev),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){let i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){let e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){let i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){let i=super.getLocalBounds(t);if(!e)for(let s=0,o=this.children.length;s<o;++s){let n=this.children[s];n.visible&&n.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){let e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==tc.prototype._render&&(i=this.getBounds(!0));let o=t.projection.transform;if(o&&(s?(s=Sv.copyFrom(s),s.prepend(o)):s=o),i&&e.intersects(i,s))this._render(t);else if(this.cullArea)return;for(let n=0,a=this.children.length;n<a;++n){let l=this.children[n],h=l.cullable;l.cullable=h||!this.cullArea,l.render(t),l.cullable=h}}render(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters?.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}}renderAdvanced(t){let e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let o=0;o<e.length;o++)e[o].enabled&&this._enabledFilters.push(e[o])}let s=e&&this._enabledFilters?.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==_t.NONE));if(s&&t.batch.flush(),e&&this._enabledFilters?.length&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let o=0,n=this.children.length;o<n;++o)this.children[o].render(t)}s&&t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters?.length&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;let e=typeof t=="boolean"?t:t?.children,i=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<i.length;++s)i[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){let e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){let e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};Jf.defaultSortableChildren=!1;var I=Jf;I.prototype.containerUpdateTransform=I.prototype.updateTransform;Object.defineProperties(S,{SORTABLE_CHILDREN:{get(){return I.defaultSortableChildren},set(r){A.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),I.defaultSortableChildren=r}}});var tm=class ec{constructor(t){this.stage=new I,t=Object.assign({forceCanvas:!1},t),this.renderer=Yh(t),ec._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,e){let i=ec._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};tm._plugins=[];var ca=tm;T.handleByList(w.Application,ca._plugins);var Oo=class{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{let{clientWidth:s,clientHeight:o}=this._resizeTo;e=s,i=o}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}};Oo.extension=w.Application;T.add(Oo);var ot=new Xe.default;var ua=class{ysdk;constructor(t){this.ysdk=t}showInterstitial(){console.log("Interstitial"),this.ysdk.adv.showFullscreenAdv({callbacks:{onOpen:()=>{ot.emit("AD_STARTED")},onClose:()=>{ot.emit("AD_FINISHED")},onError:()=>{},onOffline:()=>{}}})}showRewarded(t,e){this.ysdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{ot.emit("AD_STARTED")},onClose:()=>{ot.emit("AD_FINISHED"),t()},onRewarded:e,onError:()=>{}}})}};var em;function rm(r){return em=r,r}function Dt(){return em}var Av=0,rc=class extends A.EventEmitter{constructor(r){super(),this.id=Av++,this.init(r)}set(r,t){if(this[r]===void 0)throw new Error(`Property with name ${r} does not exist.`);switch(r){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){let{currentTime:r}=this._source;return r/this._duration}get paused(){return this._paused}set paused(r){this._paused=r,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(r){this._playing=!1,this._duration=r.source.duration;let t=this._source=r.source.cloneNode(!1);t.src=r.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),r.context.on("refresh",this.refresh,this),r.context.on("refreshPaused",this.refreshPaused,this),this._media=r}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(r){this._speed=r,this.refresh()}get volume(){return this._volume}set volume(r){this._volume=r,this.refresh()}get loop(){return this._loop}set loop(r){this._loop=r,this.refresh()}get muted(){return this._muted}set muted(r){this._muted=r,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(r){console.warn("HTML Audio does not support filters")}refresh(){let r=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;let e=r.volume*(r.muted?0:1),i=t.volume*(t.muted?0:1),s=this._volume*(this._muted?0:1);this._source.volume=s*e*i,this._source.playbackRate=this._speed*r.speed*t.speed}refreshPaused(){let r=this._media.context,t=this._media.parent,e=this._paused||t.paused||r.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(r){let{start:t,end:e,speed:i,loop:s,volume:o,muted:n}=r;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=o,this._loop=!!s,this._muted=n,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-rc.PADDING),this._end=Math.min(this._end+rc.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),ut.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){ut.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){ut.shared.remove(this._onUpdate,this),this.removeAllListeners();let r=this._source;r&&(r.onended=null,r.onplay=null,r.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}},da=rc;da.PADDING=.1;var Do=class extends A.EventEmitter{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new da(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){let e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;let l=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,l)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;let s=()=>{a(),i.isLoaded=!0;let l=i.autoPlayStart();t&&t(null,i,l)},o=()=>{a(),t&&t(new Error("Sound loading has been aborted"))},n=()=>{a();let l=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(l)):console.error(l)},a=()=>{e.removeEventListener("canplaythrough",s),e.removeEventListener("load",s),e.removeEventListener("abort",o),e.removeEventListener("error",n)};e.addEventListener("canplaythrough",s,!1),e.addEventListener("load",s,!1),e.addEventListener("abort",o,!1),e.addEventListener("error",n,!1),e.load()}};var No=class{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}};var ai=["ogg","oga","opus","m4a","mp3","mpeg","wav","aiff","wma","mid","caf"],ic=["audio/mpeg","audio/ogg"],li={};function im(r){let t={m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"',...r||{}},e=document.createElement("audio"),i={},s=/^no$/;ai.forEach(o=>{let n=e.canPlayType(`audio/${o}`).replace(s,""),a=t[o]?e.canPlayType(t[o]).replace(s,""):"";i[o]=!!n||!!a}),Object.assign(li,i)}im();var ne=class{static setParamValue(t,e){if(t.setValueAtTime){let i=Dt().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}};var Iv=0,Uo=class extends A.EventEmitter{constructor(t){super(),this.id=Iv++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){this._filters&&(this._filters?.filter(e=>e).forEach(e=>e.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t?.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;let t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;let i=t.volume*(t.muted?0:1),s=e.volume*(e.muted?0:1),o=this._volume*(this._muted?0:1);ne.setParamValue(this._gain.gain,o*s*i),ne.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){if(this._filters?.length){this._source.disconnect();let t=this._source;this._filters.forEach(e=>{t.connect(e.destination),t=e}),t.connect(this._gain)}}refreshPaused(){let t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){let{start:e,end:i,speed:s,loop:o,volume:n,muted:a,filters:l}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;let{source:h,gain:c}=this._media.nodes.cloneBufferSource();this._source=h,this._gain=c,this._speed=s,this._volume=n,this._loop=!!o,this._muted=a,this._filters=l,this.refresh();let u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){ut.shared.remove(this._updateListener,this),t&&ut.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._filters?.forEach(t=>t.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){let e=this._now(),i=e-this._lastUpdate;if(i>0||t){let s=this._source.playbackRate.value;this._elapsed+=i*s,this._lastUpdate=e;let o=this._duration,n;if(this._source.loopStart){let a=this._source.loopEnd-this._source.loopStart;n=(this._source.loopStart+this._elapsed%a)/o}else n=this._elapsed%o/o;this._progress=n,this.emit("progress",this._progress,o)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}};var hi=class{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}};var sm=class extends hi{constructor(r){let t=r.audioContext,e=t.createBufferSource(),i=t.createGain(),s=t.createAnalyser();e.connect(s),s.connect(i),i.connect(r.destination),super(s,i),this.context=r,this.bufferSource=e,this.gain=i,this.analyser=s}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(sm.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){let r=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=r.buffer,ne.setParamValue(t.playbackRate,r.playbackRate.value),t.loop=r.loop;let e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}},pa=sm;pa.BUFFER_SIZE=0;var ci=class{init(t){this.parent=t,this._nodes=new pa(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new Uo(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){let e=this.parent.url,i=await S.ADAPTER.fetch(e);this._decode(await i.arrayBuffer(),t)}_decode(t,e){let i=(s,o)=>{if(s)e&&e(s);else{this.parent.isLoaded=!0,this.buffer=o;let n=this.parent.autoPlayStart();e&&e(null,this.parent,n)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}};var gs=class{static from(r){let t={};typeof r=="string"?t.url=r:r instanceof ArrayBuffer||r instanceof AudioBuffer||r instanceof HTMLAudioElement?t.source=r:Array.isArray(r)?t.url=r:t=r,t={autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1,...t},Object.freeze(t);let e=Dt().useLegacy?new Do:new ci;return new gs(e,t)}constructor(r,t){this.media=r,this.options=t,this._instances=[],this._sprites={},this.media.init(this);let e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this._preloadQueue=null,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=Array.isArray(t.url)?this.preferUrl(t.url):t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}preferUrl(r){let[t]=r.map(e=>({url:e,ext:A.path.extname(e).slice(1)})).filter(({ext:e})=>li[e]).sort((e,i)=>ai.indexOf(e.ext)-ai.indexOf(i.ext));if(!t)throw new Error("No supported file type found");return t.url}get context(){return Dt().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(r){this._paused=r,this.refreshPaused()}get speed(){return this._speed}set speed(r){this._speed=r,this.refresh()}get filters(){return this.media.filters}set filters(r){this.media.filters=r}addSprites(r,t){if(typeof r=="object"){let i={};for(let s in r)i[s]=this.addSprites(s,r[s]);return i}console.assert(!this._sprites[r],`Alias ${r} is already taken`);let e=new No(this,t);return this._sprites[r]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(r){if(r){let t=this._sprites[r];t!==void 0&&(t.destroy(),delete this._sprites[r])}else for(let t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let r=this._instances.length-1;r>=0;r--)this._instances[r].stop();return this}play(r,t){let e;if(typeof r=="string"?e={sprite:r,loop:this.loop,complete:t}:typeof r=="function"?(e={},e.complete=r):e=r,e={complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1,...e||{}},e.sprite){let s=e.sprite;console.assert(!!this._sprites[s],`Alias ${s} is not available`);let o=this._sprites[s];e.start=o.start+(e.start||0),e.end=o.end,e.speed=o.speed||1,e.loop=o.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return this._preloadQueue?new Promise(s=>{this._preloadQueue.push(()=>{s(this.play(e))})}):(this._preloadQueue=[],this.autoPlay=!0,this._autoPlayOptions=e,new Promise((s,o)=>{this._preload((n,a,l)=>{this._preloadQueue.forEach(h=>h()),this._preloadQueue=null,n?o(n):(e.loaded&&e.loaded(n,a,l),s(l))})}));(this.singleInstance||e.singleInstance)&&this._removeInstances();let i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){let r=this._instances.length;for(let t=0;t<r;t++)this._instances[t].refresh()}refreshPaused(){let r=this._instances.length;for(let t=0;t<r;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(r){this._volume=r,this.refresh()}get muted(){return this._muted}set muted(r){this._muted=r,this.refresh()}get loop(){return this._loop}set loop(r){this._loop=r,this.refresh()}_preload(r){this.media.load(r)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let r;return this.autoPlay&&(r=this.play(this._autoPlayOptions)),r}_removeInstances(){for(let r=this._instances.length-1;r>=0;r--)this._poolInstance(this._instances[r]);this._instances.length=0}_onComplete(r){if(this._instances){let t=this._instances.indexOf(r);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(r)}_createInstance(){if(gs._pool.length>0){let r=gs._pool.pop();return r.init(this.media),r}return this.media.create()}_poolInstance(r){r.destroy(),gs._pool.indexOf(r)<0&&gs._pool.push(r)}},Ae=gs;Ae._pool=[];var Go=class extends A.EventEmitter{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}};var ys=class r extends hi{constructor(){let t=window,e=new r.AudioContext,i=e.createDynamicsCompressor(),s=e.createAnalyser();s.connect(i),i.connect(e.destination),super(s,i),this.autoPause=!0,this._ctx=e,this._offlineCtx=new r.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this.compressor=i,this.analyser=s,this.events=new A.EventEmitter,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,this._locked=e.state==="suspended"&&("ontouchstart"in globalThis||"onclick"in globalThis),this._locked&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0)),this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),globalThis.addEventListener("focus",this.onFocus),globalThis.addEventListener("blur",this.onBlur)}onFocus(){if(!this.autoPause)return;let t=this._ctx.state;(t==="suspended"||t==="interrupted"||!this._locked)&&(this.paused=this._pausedOnBlur,this.refreshPaused())}onBlur(){this.autoPause&&(this._locked||(this._pausedOnBlur=this._paused,this.paused=!0,this.refreshPaused()))}_unlock(){this._locked&&(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._locked=!1))}playEmptySound(){let t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){let t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){let t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();let t=this._ctx;typeof t.close<"u"&&t.close(),globalThis.removeEventListener("focus",this.onFocus),globalThis.removeEventListener("blur",this.onBlur),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){let i=o=>{e(new Error(o?.message||"Unable to decode file"))},s=this._offlineCtx.decodeAudioData(t,o=>{e(null,o)},i);s&&s.catch(i)}};var fa=class{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new ys),this._htmlAudioContext=new Go,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return ys.AudioContext!==null}add(t,e){if(typeof t=="object"){let o={};for(let n in t){let a=this._getOptions(t[n],e);o[n]=this.add(n,a)}return o}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof Ae)return this._sounds[t]=e,e;let i=this._getOptions(e),s=Ae.from(i);return this._sounds[t]=s,s}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:Array.isArray(t)?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i={...i,...e||{}},i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}get disableAutoPause(){return!this._webAudioContext.autoPause}set disableAutoPause(t){this._webAudioContext.autoPause=!t}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(let t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(let t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){let i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}isPlaying(){for(let t in this._sounds)if(this._sounds[t].isPlaying)return!0;return!1}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){let i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){let i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}};var Ie=class{constructor(t,e){this.init(t,e)}init(t,e){this.destination=t,this.source=e||t}connect(t){this.source?.connect(t)}disconnect(){this.source?.disconnect()}destroy(){this.disconnect(),this.destination=null,this.source=null}};var nt=class extends Ie{constructor(r=0,t=0,e=0,i=0,s=0,o=0,n=0,a=0,l=0,h=0){let c=[],u=[{f:nt.F32,type:"lowshelf",gain:r},{f:nt.F64,type:"peaking",gain:t},{f:nt.F125,type:"peaking",gain:e},{f:nt.F250,type:"peaking",gain:i},{f:nt.F500,type:"peaking",gain:s},{f:nt.F1K,type:"peaking",gain:o},{f:nt.F2K,type:"peaking",gain:n},{f:nt.F4K,type:"peaking",gain:a},{f:nt.F8K,type:"peaking",gain:l},{f:nt.F16K,type:"highshelf",gain:h}];Dt().useLegacy||(c=u.map(d=>{let p=Dt().context.audioContext.createBiquadFilter();return p.type=d.type,ne.setParamValue(p.Q,1),p.frequency.value=d.f,ne.setParamValue(p.gain,d.gain),p})),super(c[0],c[c.length-1]),this.bands=c,this.bandsMap={};for(let d=0;d<this.bands.length;d++){let p=this.bands[d];d>0&&this.bands[d-1].connect(p),this.bandsMap[p.frequency.value]=p}}setGain(r,t=0){if(!this.bandsMap[r])throw new Error(`No band found for frequency ${r}`);ne.setParamValue(this.bandsMap[r].gain,t)}getGain(r){if(!this.bandsMap[r])throw new Error(`No band found for frequency ${r}`);return this.bandsMap[r].gain.value}set f32(r){this.setGain(nt.F32,r)}get f32(){return this.getGain(nt.F32)}set f64(r){this.setGain(nt.F64,r)}get f64(){return this.getGain(nt.F64)}set f125(r){this.setGain(nt.F125,r)}get f125(){return this.getGain(nt.F125)}set f250(r){this.setGain(nt.F250,r)}get f250(){return this.getGain(nt.F250)}set f500(r){this.setGain(nt.F500,r)}get f500(){return this.getGain(nt.F500)}set f1k(r){this.setGain(nt.F1K,r)}get f1k(){return this.getGain(nt.F1K)}set f2k(r){this.setGain(nt.F2K,r)}get f2k(){return this.getGain(nt.F2K)}set f4k(r){this.setGain(nt.F4K,r)}get f4k(){return this.getGain(nt.F4K)}set f8k(r){this.setGain(nt.F8K,r)}get f8k(){return this.getGain(nt.F8K)}set f16k(r){this.setGain(nt.F16K,r)}get f16k(){return this.getGain(nt.F16K)}reset(){this.bands.forEach(r=>{ne.setParamValue(r.gain,0)})}destroy(){this.bands.forEach(r=>{r.disconnect()}),this.bands=null,this.bandsMap=null}},Ne=nt;Ne.F32=32;Ne.F64=64;Ne.F125=125;Ne.F250=250;Ne.F500=500;Ne.F1K=1e3;Ne.F2K=2e3;Ne.F4K=4e3;Ne.F8K=8e3;Ne.F16K=16e3;var om={loader:w.LoadParser,resolver:w.ResolveParser,cache:w.CacheParser,detection:w.DetectionParser};T.handle(w.Asset,r=>{let t=r.ref;Object.entries(om).filter(([e])=>!!t[e]).forEach(([e,i])=>T.add(Object.assign(t[e],{extension:t[e].extension??i})))},r=>{let t=r.ref;Object.keys(om).filter(e=>!!t[e]).forEach(e=>T.remove(t[e]))});var ma=class{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};function ue(r,t){if(Array.isArray(t)){for(let e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function de(r,t){let e=r.split("?")[0],i=A.path.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}var Vt=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(i=>typeof i=="string"||e?t(i):i):r);var zo=(r,t)=>{let e=t.split("?")[1];return e&&(r+=`?${e}`),r};function nm(r,t,e,i,s){let o=t[e];for(let n=0;n<o.length;n++){let a=o[n];e<t.length-1?nm(r.replace(i[e],a),t,e+1,i,s):s.push(r.replace(i[e],a))}}function ga(r){let t=/\{(.*?)\}/g,e=r.match(t),i=[];if(e){let s=[];e.forEach(o=>{let n=o.substring(1,o.length-1).split(",");s.push(n)}),nm(r,s,0,e,i)}else i.push(r);return i}var mr=r=>!Array.isArray(r);var sc=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){let i=Vt(t),s;for(let a=0;a<this.parsers.length;a++){let l=this.parsers[a];if(l.test(e)){s=l.getCacheableAssets(i,e);break}}s||(s={},i.forEach(a=>{s[a]=e}));let o=Object.keys(s),n={cacheKeys:o,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,n)}),o.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,s[a])}),e instanceof b){let a=e;i.forEach(l=>{a.baseTexture!==b.EMPTY.baseTexture&&Y.addToCache(a.baseTexture,l),b.addToCache(a,l)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}let e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}},Ue=new sc;var ya=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){let i={promise:null,parser:null};return i.promise=(async()=>{let s=null,o=null;if(e.loadParser&&(o=this._parserHash[e.loadParser],o||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!o){for(let n=0;n<this.parsers.length;n++){let a=this.parsers[n];if(a.load&&a.test?.(t,e,this)){o=a;break}}if(!o)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await o.load(t,e,this),i.parser=o;for(let n=0;n<this.parsers.length;n++){let a=this.parsers[n];a.parse&&a.parse&&await a.testParse?.(s,e,this)&&(s=await a.parse(s,e,this)||s,i.parser=a)}return s})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0,s={},o=mr(t),n=Vt(t,h=>({alias:[h],src:h})),a=n.length,l=n.map(async h=>{let c=A.path.toAbsolute(h.src);if(!s[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),s[h.src]=await this.promiseCache[c].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[c],delete s[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(l),o?s[n[0].src]:s}async unload(t){let e=Vt(t,i=>({alias:[i],src:i})).map(async i=>{let s=A.path.toAbsolute(i.src),o=this.promiseCache[s];if(o){let n=await o.promise;delete this.promiseCache[s],o.parser?.unload?.(n,i,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}};var Rt=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Rt||{});var Lv=".json",Bv="application/json",oc={extension:{type:w.LoadParser,priority:Rt.Low},name:"loadJson",test(r){return ue(r,Bv)||de(r,Lv)},async load(r){return await(await S.ADAPTER.fetch(r)).json()}};T.add(oc);var kv=".txt",Ov="text/plain",nc={name:"loadTxt",extension:{type:w.LoadParser,priority:Rt.Low},test(r){return ue(r,Ov)||de(r,kv)},async load(r){return await(await S.ADAPTER.fetch(r)).text()}};T.add(nc);var Dv=["normal","bold","100","200","300","400","500","600","700","800","900"],Nv=[".ttf",".otf",".woff",".woff2"],Uv=["font/ttf","font/otf","font/woff","font/woff2"],Gv=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function ac(r){let t=A.path.extname(r),e=A.path.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)),i=e.length>0;for(let o of e)if(!o.match(Gv)){i=!1;break}let s=e.join(" ");return i||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}var zv=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function jv(r){return zv.test(r)?r:encodeURI(r)}var lc={extension:{type:w.LoadParser,priority:Rt.Low},name:"loadWebFont",test(r){return ue(r,Uv)||de(r,Nv)},async load(r,t){let e=S.ADAPTER.getFontFaceSet();if(e){let i=[],s=t.data?.family??ac(r),o=t.data?.weights?.filter(a=>Dv.includes(a))??["normal"],n=t.data??{};for(let a=0;a<o.length;a++){let l=o[a],h=new FontFace(s,`url(${jv(r)})`,{...n,weight:l});await h.load(),e.add(h),i.push(h)}return i.length===1?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>S.ADAPTER.getFontFaceSet().delete(t))}};T.add(lc);var am=0,hc,Vv="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Hv={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Vv}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},$v={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},cc,uc=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{let e=URL.createObjectURL(new Blob([Hv.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",s=>{i.terminate(),URL.revokeObjectURL(e),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){hc===void 0&&(hc=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<hc&&(cc||(cc=URL.createObjectURL(new Blob([$v.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(cc),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();let i=new Promise((s,o)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:o})});return this.next(),i}next(){if(!this.queue.length)return;let t=this.getWorker();if(!t)return;let e=this.queue.pop(),i=e.id;this.resolveHash[am]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:am++,id:i})}},dc=new uc;function Fr(r,t,e){r.resource.internal=!0;let i=new b(r),s=()=>{delete t.promiseCache[e],Ue.has(e)&&Ue.remove(e)};return i.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}var Xv=[".jpeg",".jpg",".png",".webp",".avif"],Wv=["image/jpeg","image/png","image/webp","image/avif"];async function pc(r){let t=await S.ADAPTER.fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);let e=await t.blob();return await createImageBitmap(e)}var gr={name:"loadTextures",extension:{type:w.LoadParser,priority:Rt.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return ue(r,Wv)||de(r,Xv)},async load(r,t,e){let i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap,s;i?this.config.preferWorkers&&await dc.isImageBitmapSupported()?s=await dc.loadImageBitmap(r):s=await pc(r):s=await new Promise((a,l)=>{let h=new Image;h.crossOrigin=this.config.crossOrigin,h.src=r,h.complete?a(h):(h.onload=()=>a(h),h.onerror=c=>l(c))});let o={...t.data};o.resolution??(o.resolution=A.getResolutionOfUrl(r)),i&&o.resourceOptions?.ownsImageBitmap===void 0&&(o.resourceOptions={...o.resourceOptions},o.resourceOptions.ownsImageBitmap=!0);let n=new Y(s,o);return n.resource.src=r,Fr(n,e,r)},unload(r){r.destroy(!0)}};T.add(gr);var Yv=".svg",qv="image/svg+xml",fc={extension:{type:w.LoadParser,priority:Rt.High},name:"loadSVG",test(r){return ue(r,qv)||de(r,Yv)},async testParse(r){return ms.test(r)},async parse(r,t,e){let i=new ms(r,t?.data?.resourceOptions);await i.load();let s=new Y(i,{resolution:A.getResolutionOfUrl(r),...t?.data});return s.resource.src=t.src,Fr(s,e,t.src)},async load(r,t){return(await S.ADAPTER.fetch(r)).text()},unload:gr.unload};T.add(fc);var Kv=[".mp4",".m4v",".webm",".ogv"],Zv=["video/mp4","video/webm","video/ogg"],mc={name:"loadVideo",extension:{type:w.LoadParser,priority:Rt.High},config:{defaultAutoPlay:!0},test(r){return ue(r,Zv)||de(r,Kv)},async load(r,t,e){let i,s=await(await S.ADAPTER.fetch(r)).blob(),o=URL.createObjectURL(s);try{let n={autoPlay:this.config.defaultAutoPlay,...t?.data?.resourceOptions},a=new ko(o,n);await a.load();let l=new Y(a,{alphaMode:await A.detectVideoAlphaMode(),resolution:A.getResolutionOfUrl(r),...t?.data});l.resource.src=r,i=Fr(l,e,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(o)})}catch(n){throw URL.revokeObjectURL(o),n}return i},unload(r){r.destroy(!0)}};T.add(mc);var xa=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{let e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){let{alias:e,name:i,src:s,srcs:o}=t;return Vt(e||i||s||o,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>a?.src??a?.srcs??a):n?.src||n?.srcs?n.src??n.srcs:n,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){let i=[];Array.isArray(e)?e.forEach(s=>{let o=s.src??s.srcs,n=s.alias??s.name,a;if(typeof n=="string"){let l=this._createBundleAssetId(t,n);i.push(l),a=[n,l]}else{let l=n.map(h=>this._createBundleAssetId(t,h));i.push(...l),a=[...n,...l]}this.add({...s,alias:a,src:o})}):Object.keys(e).forEach(s=>{let o=[s,this._createBundleAssetId(t,s)];if(typeof e[s]=="string")this.add({alias:o,src:e[s]});else if(Array.isArray(e[s]))this.add({alias:o,src:e[s]});else{let n=e[s],a=n.src??n.srcs;this.add({...n,alias:o,src:Array.isArray(a)?a:[a]})}i.push(...o)}),this._bundles[t]=i}add(t,e,i,s,o){let n=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(A.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),n.push({alias:t,src:e,data:i,format:s,loadParser:o})):Array.isArray(t)?n.push(...t):n.push(t);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},Vt(n).forEach(l=>{let{src:h,srcs:c}=l,{data:u,format:d,loadParser:p}=l,f=Vt(h||c).map(y=>typeof y=="string"?ga(y):Array.isArray(y)?y:[y]),m=this.getAlias(l);Array.isArray(m)?m.forEach(a):a(m);let x=[];f.forEach(y=>{y.forEach(_=>{let g={};if(typeof _!="object"){g.src=_;for(let v=0;v<this._parsers.length;v++){let U=this._parsers[v];if(U.test(_)){g=U.parse(_);break}}}else u=_.data??u,d=_.format??d,p=_.loadParser??p,g={...g,..._};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this.buildResolvedAsset(g,{aliases:m,data:u,format:d,loadParser:p}),x.push(g)})}),m.forEach(y=>{this._assetMap[y]=x})})}resolveBundle(t){let e=mr(t);t=Vt(t);let i={};return t.forEach(s=>{let o=this._bundles[s];if(o){let n=this.resolve(o),a={};for(let l in n){let h=n[l];a[this._extractAssetIdFromBundle(s,l)]=h}i[s]=a}}),e?i[t[0]]:i}resolveUrl(t){let e=this.resolve(t);if(typeof t!="string"){let i={};for(let s in e)i[s]=e[s].src;return i}return e.src}resolve(t){let e=mr(t);t=Vt(t);let i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let o=this._assetMap[s],n=o[0],a=this._getPreferredOrder(o);a?.priority.forEach(l=>{a.params[l].forEach(h=>{let c=o.filter(u=>u[l]?u[l]===h:!1);c.length&&(o=c)})}),this._resolverHash[s]=o[0]??n}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){let i=t[0],s=this._preferredOrder.find(o=>o.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){let{aliases:i,data:s,loadParser:o,format:n}=e;return(this._basePath||this._rootPath)&&(t.src=A.path.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=o??t.loadParser,t.format=n??A.path.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}};var va=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new xa,this.loader=new ya,this.cache=Ue,this._backgroundLoader=new ma(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let o=t.manifest;typeof o=="string"&&(o=await this.load(o)),this.resolver.addManifest(o)}let e=t.texturePreference?.resolution??1,i=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i,s,o){this.resolver.add(t,e,i,s,o)}async load(t,e){this._initialized||await this.init();let i=mr(t),s=Vt(t).map(a=>{if(typeof a!="string"){let l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),o=this.resolver.resolve(s),n=await this._mapLoadToResolve(o,e);return i?n[s[0]]:n}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);let s=this.resolver.resolveBundle(t),o={},n=Object.keys(s),a=0,l=0,h=()=>{e?.(++a/l)},c=n.map(u=>{let d=s[u];return l+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(p=>{o[u]=p})});return await Promise.all(c),i?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);let e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ue.get(t);let e={};for(let i=0;i<t.length;i++)e[i]=Ue.get(t[i]);return e}async _mapLoadToResolve(t,e){let i=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;let o=await this.loader.load(i,e);this._backgroundLoader.active=!0;let n={};return i.forEach((a,l)=>{let h=o[a.src],c=[a.src];a.alias&&c.push(...a.alias),n[s[l]]=h,Ue.set(c,h)}),n}async unload(t){this._initialized||await this.init();let e=Vt(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Vt(t);let e=this.resolver.resolveBundle(t),i=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(i)}async _unloadFromResolved(t){let e=Object.values(t);e.forEach(i=>{Ue.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(let i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,s)=>e.indexOf(i)===s),e}get detections(){return this._detections}get preferWorkers(){return gr.config.preferWorkers}set preferWorkers(t){A.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}},pe=new va;T.handleByList(w.LoadParser,pe.loader.parsers).handleByList(w.ResolveParser,pe.resolver.parsers).handleByList(w.CacheParser,pe.cache.parsers).handleByList(w.DetectionParser,pe.detections);var gc={extension:w.CacheParser,test:r=>Array.isArray(r)&&r.every(t=>t instanceof b),getCacheableAssets:(r,t)=>{let e={};return r.forEach(i=>{t.forEach((s,o)=>{e[i+(o===0?"":o+1)]=s})}),e}};T.add(gc);async function ba(r){if("Image"in globalThis)return new Promise(t=>{let e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let t=await(await fetch(r)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}var yc={extension:{type:w.DetectionParser,priority:1},test:async()=>ba("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")};T.add(yc);var xc={extension:{type:w.DetectionParser,priority:0},test:async()=>ba("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};T.add(xc);var lm=["png","jpg","jpeg"],vc={extension:{type:w.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...lm],remove:async r=>r.filter(t=>!lm.includes(t))};T.add(vc);var Qv="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function xs(r){return Qv?!1:document.createElement("video").canPlayType(r)!==""}var bc={extension:{type:w.DetectionParser,priority:0},test:async()=>xs("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(t=>t!=="webm")};T.add(bc);var _c={extension:{type:w.DetectionParser,priority:0},test:async()=>xs("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(t=>t!=="mp4"&&t!=="m4v")};T.add(_c);var wc={extension:{type:w.DetectionParser,priority:0},test:async()=>xs("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(t=>t!=="ogv")};T.add(wc);var Tc={extension:w.ResolveParser,test:gr.test,parse:r=>({resolution:parseFloat(S.RETINA_PREFIX.exec(r)?.[1]??"1"),format:A.path.extname(r).slice(1),src:r})};T.add(Tc);var hm=r=>{let t=r.src;return r?.alias?.[0]??A.path.basename(t,A.path.extname(t))},cm={extension:w.Asset,detection:{test:async()=>!0,add:async r=>[...r,...ai.filter(t=>li[t])],remove:async r=>r.filter(t=>r.includes(t))},loader:{extension:{type:[w.LoadParser],priority:Rt.High},test(r){let t=A.path.extname(r).slice(1);return!!li[t]||ic.some(e=>r.startsWith(`data:${e}`))},async load(r,t){let e=await new Promise((i,s)=>Ae.from({...t.data,url:r,preload:!0,loaded(o,n){o?s(o):i(n),t.data?.loaded?.(o,n)}}));return Dt().add(hm(t),e),e},async unload(r,t){Dt().remove(hm(t))}}};T.add(cm);var x5=rm(new fa);var um={engine_start_1:{start:0,end:1.8995918367346938,loop:!1},engine_start_2:{start:3,end:5,loop:!1},engine_start_3:{start:6,end:8,loop:!1},explosion_1:{start:9,end:11,loop:!1},explosion_2:{start:12,end:13.5,loop:!1},explosion_3:{start:15,end:17,loop:!1},explosion_4:{start:18,end:19.5,loop:!1},money_collect_2:{start:21,end:21.5,loop:!1},money_collect_3:{start:23,end:23.82,loop:!1},money_collect_4:{start:25,end:25.82,loop:!1},player_car_crash:{start:27,end:31,loop:!1},power_up_4:{start:32,end:33.5,loop:!1},power_up_5:{start:35,end:36.5,loop:!1},projectile:{start:38,end:38.5,loop:!1},rocket_spawn_1:{start:40,end:41.08335600907029,loop:!1},rocket_spawn_2:{start:43,end:44.08335600907029,loop:!1},rocket_spawn_3:{start:46,end:47.5,loop:!1},ui_click_1:{start:49,end:49.51,loop:!1},ui_menu_whoosh:{start:51,end:51.5,loop:!1},upgrade_3:{start:53,end:55.5,loop:!1}};var Pe=class{active=!0;memorize=!1;bindings=[];prevParameters=[];dispatch(t){this.active&&(this.memorize&&this.prevParameters.push(t),this.bindings.slice().forEach(e=>e.execute(t)))}add(t,e){return this.addBinding(new _a(this,t,e,!1))}addOnce(t,e){return this.addBinding(new _a(this,t,e,!0))}addBinding(t){return this.bindings.push(t),this.memorize&&this.prevParameters.forEach(e=>t.execute(e)),t}remove(t){this.bindings=this.bindings.filter(e=>e!=t),t.destroy()}removeAll(){this.bindings.slice().forEach(t=>t.destroy()),this.bindings.length=0}},_a=class{active=!0;once=!1;callback;filter;signal;constructor(t,e,i=null,s=!1){this.signal=t,this.callback=e,this.filter=i,this.once=s}execute(t){if(!this.signal||!this.callback||!this.active||this.filter&&!this.filter(t))return;let e=this.callback;e(t),this.once&&this.detach()}detach(){this.signal&&this.signal.remove(this)}destroy(){this.signal=null,this.callback=null,this.filter=null}};var jo=class{onChange=new Pe;reasons=[];add(t){let e=this.isEmpty();this.reasons.push(t),e&&this.onChange.dispatch(!0)}remove(t){let e=this.isEmpty();this.reasons=this.reasons.filter(i=>i!==t),!e&&this.isEmpty()&&this.onChange.dispatch(!1)}isEmpty(){return this.reasons.length===0}};var wa=class{soundEnabled=!0;musicEnabled=!0;sound;music;musicTrack;musicContext;soundMuteReasons=new jo;musicMuteReasons=new jo;musicAvailable=!1;constructor(){this.sound=Ae.from({url:"assets/sounds/sounds.mp3",sprites:um}),this.music={calm:Ae.from("assets/music/calm.mp3"),active:Ae.from("assets/music/active.mp3")},this.musicContext="calm",this.musicTrack=this.music.calm,this.soundMuteReasons.onChange.add(t=>{this.sound.volume=t?0:1,this.soundEnabled=!t}),this.musicMuteReasons.onChange.add(t=>{Object.values(this.music).forEach(e=>e.volume=t?0:1),this.musicEnabled=!t})}init(t,e){this.setSoundEnabled(t,"UserAction"),this.setMusicEnabled(e,"UserAction")}playSound(t){this.sound.play(t)}stopMusic(){this.musicTrack.stop()}setMusicContext(t){this.musicContext!=t&&(this.musicContext=t,this.playMusic(t))}playMusic(t){this.musicTrack.stop(),this.music[t].play({loop:!0}),this.musicTrack=this.music[t]}getSoundEnabled(){return this.soundEnabled}setSoundEnabled(t,e){t?this.soundMuteReasons.remove(e):this.soundMuteReasons.add(e)}getMusicEnabled(){return this.musicEnabled}setMusicEnabled(t,e){t?this.musicMuteReasons.remove(e):this.musicMuteReasons.add(e)}};var Ta=class{ysdk;constructor(t){this.ysdk=t}async getLeaderboards(){return await this.ysdk.getLeaderboards()}async setPlayerEntry(t,e,i){if(!await this.ysdk.isAvailableMethod("leaderboards.setLeaderboardScore"))return;i&&await this.ysdk.getPlayer({scopes:!0});let n=(await this.ysdk.getLeaderboards()).setLeaderboardScore(t,e);return console.log("Score setting result",n),n}async getPlayerEntry(t){if(!await this.ysdk.isAvailableMethod("leaderboards.getLeaderboardPlayerEntry")){console.log("leaderboards.getLeaderboardPlayerEntry method not available");return}return await(await this.ysdk.getLeaderboards()).getLeaderboardPlayerEntry(t)}async getLeaderboardEntries(t,e){let i=await this.ysdk.getLeaderboards(),s=await this.ysdk.getPlayer(),o=!1;return s&&s.getMode()!=="lite"&&(o=!0),await i.getLeaderboardEntries(t,{quantityTop:e,includeUser:o,quantityAround:1})}};var dm="car-shooter",pm={music:!0,sounds:!0,money:0,reputation:0,selectedCar:0,cars:[{id:0,unlocked:!0,upgrades:{armor:0,damage:0,guns:0}},{id:1,unlocked:!1,upgrades:{armor:0,damage:0,guns:0}},{id:2,unlocked:!1,upgrades:{armor:0,damage:0,guns:0}}]},Ca=class{data;constructor(){this.data=this.loadLocal()}loadLocal(){let t=localStorage.getItem(dm);return t?JSON.parse(t):Object.assign({},pm)}reset(){this.data=Object.assign({},pm),this.saveLocal()}saveLocal(){localStorage.setItem(dm,JSON.stringify(this.data))}upgradeCar(t,e){this.data.cars[t].upgrades[e]++,this.saveLocal()}getCarUpgrades(t){return this.data.cars[t||this.data.selectedCar].upgrades}getCarUpgrade(t,e){return this.data.cars[e||this.data.selectedCar].upgrades[t]}};var Vo=new H,tb=new Uint16Array([0,1,2,0,2,3]),C=class r extends I{constructor(t){super(),this._anchor=new ce(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new tt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=j.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||b.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=tb,this.pluginName="batch",this.isSprite=!0,this._roundPixels=S.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=A.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=A.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;let e=this.transform.worldTransform,i=e.a,s=e.b,o=e.c,n=e.d,a=e.tx,l=e.ty,h=this.vertexData,c=t.trim,u=t.orig,d=this._anchor,p=0,f=0,m=0,x=0;if(c?(f=c.x-d._x*u.width,p=f+c.width,x=c.y-d._y*u.height,m=x+c.height):(f=-d._x*u.width,p=f+u.width,x=-d._y*u.height,m=x+u.height),h[0]=i*f+o*x+a,h[1]=n*x+s*f+l,h[2]=i*p+o*x+a,h[3]=n*x+s*p+l,h[4]=i*p+o*m+a,h[5]=n*m+s*p+l,h[6]=i*f+o*m+a,h[7]=n*m+s*f+l,this._roundPixels){let y=S.RESOLUTION;for(let _=0;_<h.length;++_)h[_]=Math.round(h[_]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let t=this._texture,e=this.vertexTrimmedData,i=t.orig,s=this._anchor,o=this.transform.worldTransform,n=o.a,a=o.b,l=o.c,h=o.d,c=o.tx,u=o.ty,d=-s._x*i.width,p=d+i.width,f=-s._y*i.height,m=f+i.height;if(e[0]=n*d+l*f+c,e[1]=h*f+a*d+u,e[2]=n*p+l*f+c,e[3]=h*f+a*p+u,e[4]=n*p+l*m+c,e[5]=h*m+a*p+u,e[6]=n*d+l*m+c,e[7]=h*m+a*d+u,this._roundPixels){let x=S.RESOLUTION;for(let y=0;y<e.length;++y)e[y]=Math.round(e[y]*x)/x}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){let t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new qe),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new $),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Vo);let e=this._texture.orig.width,i=this._texture.orig.height,s=-e*this.anchor.x,o=0;return Vo.x>=s&&Vo.x<s+e&&(o=-i*this.anchor.y,Vo.y>=o&&Vo.y<o+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t?.texture){let e=typeof t=="boolean"?t:t?.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){let i=t instanceof b?t:b.from(t,e);return new r(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){let e=A.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){let e=A.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||b.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}};var Ho;typeof self>"u"&&typeof process<"u"&&process.hrtime?Ho=function(){let r=process.hrtime();return r[0]*1e3+r[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Ho=self.performance.now.bind(self.performance):Date.now!==void 0?Ho=Date.now:Ho=function(){return new Date().getTime()};var ui=class r{constructor(){r.prototype.__init.call(this),r.prototype.__init2.call(this),r.prototype.__init3.call(this),r.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return r._shared||(r._shared=new r),r._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Ho}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;let i=Object.keys(this._tweens);if(i.length==0)return!1;for(let s=0;s<i.length;s++){let o=this._tweens[i[s]];o&&o.update(t,!0)==!1&&!e&&delete this._tweens[i[s]]}return!0}},it={Step:{None(r){return r<.5?0:1}},Linear:{None(r){return r}},Quadratic:{In(r){return r*r},Out(r){return r*(2-r)},InOut(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}},Cubic:{In(r){return r*r*r},Out(r){return--r*r*r+1},InOut(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}},Quartic:{In(r){return r*r*r*r},Out(r){return 1- --r*r*r*r},InOut(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}},Quintic:{In(r){return r*r*r*r*r},Out(r){return--r*r*r*r*r+1},InOut(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}},Sinusoidal:{In(r){return 1-Math.cos(r*Math.PI/2)},Out(r){return Math.sin(r*Math.PI/2)},InOut(r){return .5*(1-Math.cos(Math.PI*r))}},Exponential:{In(r){return r==0?0:Math.pow(1024,r-1)},Out(r){return r==1?1:1-Math.pow(2,-10*r)},InOut(r){return r==0?0:r==1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}},Circular:{In(r){return 1-Math.sqrt(1-r*r)},Out(r){return Math.sqrt(1- --r*r)},InOut(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}},Elastic:{In(r){return r==0?0:r==1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out(r){return r==0?0:r==1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut(r){return r==0?0:r==1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}},Back:{In(r){return r*r*((1.70158+1)*r-1.70158)},Out(r){return--r*r*((1.70158+1)*r+1.70158)+1},InOut(r){let t=2.5949095;return(r*=2)<1?.5*(r*r*((t+1)*r-t)):.5*((r-=2)*r*((t+1)*r+t)+2)}},Bounce:{In(r){return 1-it.Bounce.Out(1-r)},Out(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut(r){return r<.5?it.Bounce.In(r*2)*.5:it.Bounce.Out(r*2-1)*.5+.5}}},Q={Geom:{Linear(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.Linear;return t<0?o(r[0],r[1],i):t>1?o(r[e],r[e-1],e-i):o(r[s],r[s+1>e?e:s+1],i-s)},Bezier(r,t){let e=0,i=r.length-1,s=Math.pow,o=Q.Utils.Bernstein;for(let n=0;n<=i;n++)e+=o(i,n)*s(1-t,i-n)*s(t,n)*r[n];return e},QuadraticBezier(r,t){let e=0,i=r.length-1;if(t==1)return r[i];let s=Math.pow,o=Q.Utils.Bernstein,n=i*t,a=Math.floor(n),l=(n-a)*.5+.5*(a%2),h=a-a%2,c=h+1,u=h+2;return e+=o(2,0)*s(1-l,2)*s(l,0)*r[h],e+=o(2,1)*s(1-l,1)*s(l,1)*r[c],e+=o(2,2)*s(1-l,0)*s(l,2)*r[u],e},CubicBezier(r,t){let e=0,i=r.length-1;if(t==1)return r[i];let s=Math.pow,o=Q.Utils.Bernstein,n=i*t,a=Math.floor(n),l=(n-a)*(1/3)+1/3*(a%3),h=a-a%3,c=h+1,u=h+2,d=h+3;return e+=o(3,0)*s(1-l,3)*s(l,0)*r[h],e+=o(3,1)*s(1-l,2)*s(l,1)*r[c],e+=o(3,2)*s(1-l,1)*s(l,2)*r[u],e+=o(3,3)*s(1-l,0)*s(l,3)*r[d],e},CatmullRom(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.CatmullRom;return r[0]==r[e]?(t<0&&(s=Math.floor(i=e*(1+t))),o(r[(s-1+e)%e],r[s],r[(s+1)%e],r[(s+2)%e],i-s)):t<0?r[0]-(o(r[0],r[0],r[1],r[1],-i)-r[0]):t>1?r[e]-(o(r[e],r[e],r[e-1],r[e-1],i-e)-r[e]):o(r[s?s-1:0],r[s],r[e<s+1?e:s+1],r[e<s+2?e:s+2],i-s)}},Angle:{Radians(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.WrapLinear;return t<0?o(r[0],r[1],i,2*Math.PI):t>1?o(r[e],r[e-1],e-i,2*Math.PI):o(r[s],r[s+1>e?e:s+1],i-s,2*Math.PI)},Degrees(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.WrapLinear;return t<0?o(r[0],r[1],i,360):t>1?o(r[e],r[e-1],e-i,360):o(r[s],r[s+1>e?e:s+1],i-s,360)}},Color:{RGB(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.RGBLinear;return t<0?o(r[0],r[1],i):t>1?o(r[e],r[e-1],e-i):o(r[s],r[s+1>e?e:s+1],i-s)},HSV(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.HSVLinear;return t<0?o(r[0],r[1],i):t>1?o(r[e],r[e-1],e-i):o(r[s],r[s+1>e?e:s+1],i-s)},HCL(r,t){let e=r.length-1,i=e*t,s=Math.floor(i),o=Q.Utils.HCLLinear;return t<0?o(r[0],r[1],i):t>1?o(r[e],r[e-1],e-i):o(r[s],r[s+1>e?e:s+1],i-s)}},Utils:{RGBsplit(r){let t=r>>24&255,e=r>>16&255,i=r>>8&255,s=r&255;return{a:t,r:e,g:i,b:s}},HSVsplit(r){let t=Q.Utils.RGBsplit(r);t.r/=255,t.g/=255,t.b/=255;let e=Math.max(t.r,t.g,t.b),i=Math.min(t.r,t.g,t.b),s,o=e,n=e-i,a=e==0?0:n/e;if(e==i)s=0;else{switch(e){case t.r:s=(t.g-t.b)/n+(t.g<t.b?6:0);break;case t.g:s=(t.b-t.r)/n+2;break;case t.b:s=(t.r-t.g)/n+4;break}s/=6}return{a:t.a,h:s,s:a,v:o}},HSVJoin(r){let t,e,i,s=Math.floor(r.h*6),o=r.h*6-s,n=r.v*(1-r.s),a=r.v*(1-o*r.s),l=r.v*(1-(1-o)*r.s);switch(s%6){case 0:t=r.v,e=l,i=n;break;case 1:t=a,e=r.v,i=n;break;case 2:t=n,e=r.v,i=l;break;case 3:t=n,e=a,i=r.v;break;case 4:t=l,e=n,i=r.v;break;case 5:t=r.v,e=n,i=a;break}return r.a<<24|t<<16|e<<8|i},HCLSplit(r){let i=.530454533953517,s=Q.Utils.RGBsplit(r),o={a:s.a,h:0,c:0,l:0},n=0,a=Math.min(s.r,Math.min(s.g,s.b)),l=Math.max(s.r,Math.max(s.g,s.b)),h=3/100;return o.c=l-a,o.c!=0&&(n=Math.atan2(s.g-s.b,s.r-s.g)/Math.PI,h*=a/l),h=Math.exp(h),o.h=(n/2-Math.min(n%1,-n%1)/6)%1,o.c*=h,o.l=Q.Utils.Linear(-a,l,h)/(i*2),o},HCLJoin(r){let i=.530454533953517,s={a:r.a,r:0,g:0,b:0};if(r.l!=0){let o=r.h,n=r.c,a=r.l*i,l=Math.exp((1-n/(2*a))*(3/100)),h=(2*a-n)/(2*l-1),c=n/l,u=(o+Math.min(2*o%1/4,-2*o%1/8))*Math.PI*2,d;o*=6,o<=.999?(d=Math.tan(u),s.r=1,s.g=d/(1+d)):o<=1.001?(s.r=1,s.g=1):o<=2?(d=Math.tan(u),s.r=(1+d)/d,s.g=1):o<=3?(d=Math.tan(u),s.g=1,s.b=1+d):o<=3.999?(d=Math.tan(u),s.g=1/(1+d),s.b=1):o<=4.001?(s.g=0,s.b=1):o<=5?(d=Math.tan(u),s.r=-1/d,s.b=1):(d=Math.tan(u),s.r=1,s.b=-d),s.r=s.r*c+h,s.g=s.g*c+h,s.b=s.b*c+h}return s.a<<24|s.r<<16|s.g<<8|s.b},WrapLinear(r,t,e,i){let s;return r=(r+i*Math.trunc(Math.abs(r/i)))%i,t=(t+i*Math.trunc(Math.abs(t/i)))%i,Math.abs(r-t)<=.5*i?s=Q.Utils.Linear(r,t,e):(r<t?s=Q.Utils.Linear(r+i,t,e):s=Q.Utils.Linear(r,t+i,e),s=s%i),s},RGBLinear(r,t,e){let i=Q.Utils.RGBsplit(r),s=Q.Utils.RGBsplit(t),o=Q.Utils.Linear(i.a,s.a,e),n=Q.Utils.Linear(i.r,s.r,e),a=Q.Utils.Linear(i.g,s.g,e),l=Q.Utils.Linear(i.b,s.b,e);return o<<24|n<<16|a<<8|l},HSVLinear(r,t,e){let i=Q.Utils.HSVsplit(r),s=Q.Utils.HSVsplit(t),o;Math.abs(i.h-s.h)<=.5?o=Q.Utils.Linear(i.h,s.h,e):(i.h<s.h?o=Q.Utils.Linear(i.h+1,s.h,e):o=Q.Utils.Linear(i.h,s.h+1,e),o=o%1);let n=Q.Utils.Linear(i.s,s.s,e),a=Q.Utils.Linear(i.v,s.v,e),l=Q.Utils.Linear(i.a,s.a,e);return Q.Utils.HSVJoin({a:l,h:o,s:n,v:a})},HCLLinear(r,t,e){let i=Q.Utils.HCLSplit(r),s=Q.Utils.HCLSplit(t),o;Math.abs(i.h-s.h)<=.5?o=Q.Utils.Linear(i.h,s.h,e):(i.h<s.h?o=Q.Utils.Linear(i.h+1,s.h,e):o=Q.Utils.Linear(i.h,s.h+1,e),o=o%1);let n=Q.Utils.Linear(i.c,s.c,e),a=Q.Utils.Linear(i.l,s.l,e),l=Q.Utils.Linear(i.a,s.a,e);return Q.Utils.HSVJoin({a:l,h:o,s:n,v:a})},Linear(r,t,e){return(t-r)*e+r},Bernstein(r,t){let e=Q.Utils.Factorial;return e(r)/e(t)/e(r-t)},Factorial:function(){let r=[1];return function(t){let e=1;if(r[t])return r[t];for(let i=t;i>1;i--)e*=i;return r[t]=e,e}}(),CatmullRom(r,t,e,i,s){let o=(e-r)*.5,n=(i-t)*.5,a=s*s,l=s*a;return(2*t-2*e+o+n)*l+(-3*t+3*e-2*o-n)*a+o*s+t}}},Ea=class r{static __initStatic(){this._nextId=0}static nextId(){return r._nextId++}};Ea.__initStatic();var Sa={safetyCheckFunction:r=>!0,easingFunction:it.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:Q.Geom.Linear},at=class r{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=Sa.safetyCheckFunction}__init15(){this._easingFunction=Sa.easingFunction}__init16(){this._yoyoEasingFunction=Sa.yoyoEasingFunction}__init17(){this._interpolationFunction=Sa.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Ea.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:ui.shared}set _group(t){this._groupRef=t}constructor(t,e){r.prototype.__init.call(this),r.prototype.__init2.call(this),r.prototype.__init3.call(this),r.prototype.__init4.call(this),r.prototype.__init5.call(this),r.prototype.__init6.call(this),r.prototype.__init7.call(this),r.prototype.__init8.call(this),r.prototype.__init9.call(this),r.prototype.__init10.call(this),r.prototype.__init11.call(this),r.prototype.__init12.call(this),r.prototype.__init13.call(this),r.prototype.__init14.call(this),r.prototype.__init15.call(this),r.prototype.__init16.call(this),r.prototype.__init17.call(this),r.prototype.__init18.call(this),r.prototype.__init19.call(this),r.prototype.__init20.call(this),r.prototype.__init21.call(this),r.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);let t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,i,s,o){for(let n in i){let a=t[n],l=Array.isArray(a),h=!Number.isNaN(Number(a)),c=l?"array":typeof a,u=c=="object",d=typeof i[n]=="object",p=!l&&Array.isArray(i[n]);c=="undefined"||c=="function"||i[n]==null||!l&&!h&&!u||((u||l||d)&&a&&!p?(typeof e[n]>"u"&&(e[n]=l?[]:{}),typeof s[n]>"u"&&(s[n]=l?[]:{}),this._setupProperties(a,e[n],i[n],s[n],o)):((typeof e[n]>"u"||o)&&(e[n]=a),(typeof s[n]>"u"||o)&&(p?s[n]=i[n].slice().reverse()[0]:s[n]=e[n]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let i=0,s=this._chainedTweens.length;i<s;i++)this._chainedTweens[i].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,i=this._chainedTweens.length;e<i;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){let i=this._internalUpdate(t);return!i&&!e&&this._group.remove(this),i}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;let i=this._duration,s=this._startTime+this._elapsedTime;if(s>i&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&s>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=s/this._duration,this._duration==0&&(s>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let o=Number.isFinite(s)?s%this._duration:s;Number.isNaN(o)&&(o=0);let n=Math.floor(s/this._duration),a;if(this._reversed&&this._yoyoEasingFunction?a=this._yoyoEasingFunction(e):a=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){let l=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+n),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||o<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let h=1;Number.isFinite(n)?h=this._repeatCount-l:Number.isFinite(this._repeat)&&(h=this._repeat-l);for(let c=0;c<h;c++)this._onRepeatCallback(this._object,l+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return o>0&&Number.isFinite(this._repeat)&&this._internalUpdate(o),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let l=0,h=this._chainedTweens.length;l<h;l++)this._chainedTweens[l].start(),o>0&&this._chainedTweens[l].update(o);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,i,s){for(let o in i){if(e[o]==null)continue;let n=e[o],a=i[o],l=Array.isArray(t[o]),h=Array.isArray(a);!l&&h?this._reversed?t[o]=this._interpolationFunction(a.concat([n]),s):t[o]=this._interpolationFunction([n].concat(a),s):typeof a=="object"&&a?this._updateProperties(t[o],n,a,s):(a=this._handleRelativeValue(n,a),typeof a=="number"&&(typeof n=="number"||typeof n=="string")&&(t[o]=Number(n)+(a-Number(n))*s,typeof n=="string"&&(t[o]=String(t[o]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(let i in t){let s=!Array.isArray(t[i])&&Array.isArray(e[i]);if(typeof t[i]=="object")this._swapEndStartRepeatValues(t[i],e[i]);else{let o=t[i];if(typeof e[i]=="string")t[i]=Number(t[i])+Number(e[i]),e[i]=o;else if(s){let n=e[i].slice().reverse();t[i]=n[0],e[i]=n}else t[i]=e[i],e[i]=o}}}_moveForwardStartRepeatValues(t,e){for(let i in t)typeof e[i]=="object"?this._moveForwardStartRepeatValues(t[i],e[i]):typeof e[i]=="string"&&(t[i]=Number(t[i])+Number(e[i]))}};var di=class r extends C{constructor(t,e=!0){super(t[0]instanceof b?t[0]:t[0].texture),this._textures=null,this._durations=null,this._autoUpdate=e,this._isConnectedToTicker=!1,this.animationSpeed=1,this.loop=!0,this.updateAnchor=!1,this.onComplete=null,this.onFrameChange=null,this.onLoop=null,this._currentTime=0,this._playing=!1,this._previousFrame=null,this.textures=t}stop(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(ut.shared.remove(this.update,this),this._isConnectedToTicker=!1))}play(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(ut.shared.add(this.update,this,De.HIGH),this._isConnectedToTicker=!0))}gotoAndStop(t){this.stop(),this.currentFrame=t}gotoAndPlay(t){this.currentFrame=t,this.play()}update(t){if(!this._playing)return;let e=this.animationSpeed*t,i=this.currentFrame;if(this._durations!==null){let s=this._currentTime%1*this._durations[this.currentFrame];for(s+=e/60*1e3;s<0;)this._currentTime--,s+=this._durations[this.currentFrame];let o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);s>=this._durations[this.currentFrame];)s-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=s/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):i!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<i||this.animationSpeed<0&&this.currentFrame>i)&&this.onLoop(),this.updateTexture())}updateTexture(){let t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))}destroy(t){this.stop(),super.destroy(t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null}static fromFrames(t){let e=[];for(let i=0;i<t.length;++i)e.push(b.from(t[i]));return new r(e)}static fromImages(t){let e=[];for(let i=0;i<t.length;++i)e.push(b.from(t[i]));return new r(e)}get totalFrames(){return this._textures.length}get textures(){return this._textures}set textures(t){if(t[0]instanceof b)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(let e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()}get currentFrame(){let t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t}set currentFrame(t){if(t<0||t>this.totalFrames-1)throw new Error(`[AnimatedSprite]: Invalid frame index value ${t}, expected to be between 0 and totalFrames ${this.totalFrames}.`);let e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()}get playing(){return this._playing}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(ut.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(ut.shared.add(this.update,this),this._isConnectedToTicker=!0))}};var eb={scale:1,speed:1,alpha:1,loop:!1},vs=class extends di{config;constructor(t,e){super(pe.get(t).animations.main),this.config=Object.assign({},eb,e),this.anchor.set(.5),this.scale.set(this.config.scale),this.alpha=this.config.alpha,this.animationSpeed=this.config.speed,this.loop=this.config.loop,this.play()}static getSheetData(t,e,i,s,o){let n={frames:{},animations:{main:[]},meta:{image:`${t}.png`,format:"RGBA8888",size:{w:e,h:i},scale:"1"}},a=0,l=0,h=Math.floor(n.meta.size.w/s),c=Math.floor(n.meta.size.h/o);for(let u=0;u<o;u++)for(let d=0;d<s;d++){a=d*h,l=u*c;let p=`frame_${d+u*s}`;n.frames[p]={frame:{x:a,y:l,w:h,h:c}},n.animations.main.push(p)}return n}};var rb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ib=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,sb=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`,Lr=class extends N{constructor(t=4,e=3,i=!1){super(rb,i?sb:ib),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new H,this.pixelSize=1,this._clamp=i,Array.isArray(t)?this.kernels=t:(this._blur=t,this.quality=e)}apply(t,e,i,s){let o=this._pixelSize.x/e._frame.width,n=this._pixelSize.y/e._frame.height,a;if(this._quality===1||this._blur===0)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*o,this.uniforms.uOffset[1]=a*n,t.applyFilter(this,e,i,s);else{let l=t.getFilterTexture(),h=e,c=l,u,d=this._quality-1;for(let p=0;p<d;p++)a=this._kernels[p]+.5,this.uniforms.uOffset[0]=a*o,this.uniforms.uOffset[1]=a*n,t.applyFilter(this,h,c,1),u=h,h=c,c=u;a=this._kernels[d]+.5,this.uniforms.uOffset[0]=a*o,this.uniforms.uOffset[1]=a*n,t.applyFilter(this,h,i,s),t.returnFilterTexture(l)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((t,e)=>t+e+.5,0))}_generateKernels(){let t=this._blur,e=this._quality,i=[t];if(t>0){let s=t,o=t/e;for(let n=1;n<e;n++)s-=o,i.push(s)}this._kernels=i,this._updatePadding()}get kernels(){return this._kernels}set kernels(t){Array.isArray(t)&&t.length>0?(this._kernels=t,this._quality=t.length,this._blur=Math.max(...t)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(t){typeof t=="number"?(this._pixelSize.x=t,this._pixelSize.y=t):Array.isArray(t)?(this._pixelSize.x=t[0],this._pixelSize.y=t[1]):t instanceof H?(this._pixelSize.x=t.x,this._pixelSize.y=t.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(t){this._quality=Math.max(1,Math.round(t)),this._generateKernels()}get blur(){return this._blur}set blur(t){this._blur=t,this._generateKernels()}};var fm=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ob=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`,Cc=class extends N{constructor(t=.5){super(fm,ob),this.threshold=t}get threshold(){return this.uniforms.threshold}set threshold(t){this.uniforms.threshold=t}},nb=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`,mm=class extends N{constructor(r){super(fm,nb),this.bloomScale=1,this.brightness=1,this._resolution=S.FILTER_RESOLUTION,typeof r=="number"&&(r={threshold:r});let t=Object.assign(mm.defaults,r);this.bloomScale=t.bloomScale,this.brightness=t.brightness;let{kernels:e,blur:i,quality:s,pixelSize:o,resolution:n}=t;this._extractFilter=new Cc(t.threshold),this._extractFilter.resolution=n,this._blurFilter=e?new Lr(e):new Lr(i,s),this.pixelSize=o,this.resolution=n}apply(r,t,e,i,s){let o=r.getFilterTexture();this._extractFilter.apply(r,t,o,1,s);let n=r.getFilterTexture();this._blurFilter.apply(r,o,n,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=n,r.applyFilter(this,t,e,i),r.returnFilterTexture(n),r.returnFilterTexture(o)}get resolution(){return this._resolution}set resolution(r){this._resolution=r,this._extractFilter&&(this._extractFilter.resolution=r),this._blurFilter&&(this._blurFilter.resolution=r)}get threshold(){return this._extractFilter.threshold}set threshold(r){this._extractFilter.threshold=r}get kernels(){return this._blurFilter.kernels}set kernels(r){this._blurFilter.kernels=r}get blur(){return this._blurFilter.blur}set blur(r){this._blurFilter.blur=r}get quality(){return this._blurFilter.quality}set quality(r){this._blurFilter.quality=r}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(r){this._blurFilter.pixelSize=r}},ab=mm;ab.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:S.FILTER_RESOLUTION};var fG=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);var hb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,cb=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`,ym=class extends N{constructor(r){super(hb,cb),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,ym.defaults,r)}apply(r,t,e,i){let{width:s,height:o}=t.filterFrame;this.uniforms.dimensions[0]=s,this.uniforms.dimensions[1]=o,r.applyFilter(this,t,e,i)}get radius(){return this.uniforms.radius}set radius(r){this.uniforms.radius=r}get strength(){return this.uniforms.strength}set strength(r){this.uniforms.strength=r}get center(){return this.uniforms.center}set center(r){this.uniforms.center=r}},ub=ym;ub.defaults={center:[.5,.5],radius:100,strength:1};var db=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    // mix resulting color with current color
    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
}
`,pb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,pi=pi||{};pi.stringify=function(){var r={"visit_linear-gradient":function(t){return r.visit_gradient(t)},"visit_repeating-linear-gradient":function(t){return r.visit_gradient(t)},"visit_radial-gradient":function(t){return r.visit_gradient(t)},"visit_repeating-radial-gradient":function(t){return r.visit_gradient(t)},visit_gradient:function(t){var e=r.visit(t.orientation);return e&&(e+=", "),t.type+"("+e+r.visit(t.colorStops)+")"},visit_shape:function(t){var e=t.value,i=r.visit(t.at),s=r.visit(t.style);return s&&(e+=" "+s),i&&(e+=" at "+i),e},"visit_default-radial":function(t){var e="",i=r.visit(t.at);return i&&(e+=i),e},"visit_extent-keyword":function(t){var e=t.value,i=r.visit(t.at);return i&&(e+=" at "+i),e},"visit_position-keyword":function(t){return t.value},visit_position:function(t){return r.visit(t.value.x)+" "+r.visit(t.value.y)},"visit_%":function(t){return t.value+"%"},visit_em:function(t){return t.value+"em"},visit_px:function(t){return t.value+"px"},visit_literal:function(t){return r.visit_color(t.value,t)},visit_hex:function(t){return r.visit_color("#"+t.value,t)},visit_rgb:function(t){return r.visit_color("rgb("+t.value.join(", ")+")",t)},visit_rgba:function(t){return r.visit_color("rgba("+t.value.join(", ")+")",t)},visit_color:function(t,e){var i=t,s=r.visit(e.length);return s&&(i+=" "+s),i},visit_angular:function(t){return t.value+"deg"},visit_directional:function(t){return"to "+t.value},visit_array:function(t){var e="",i=t.length;return t.forEach(function(s,o){e+=r.visit(s),o<i-1&&(e+=", ")}),e},visit:function(t){if(!t)return"";var e="";if(t instanceof Array)return r.visit_array(t,e);if(t.type){var i=r["visit_"+t.type];if(i)return i(t);throw Error("Missing visitor visit_"+t.type)}else throw Error("Invalid node.")}};return function(t){return r.visit(t)}}();var pi=pi||{};pi.parse=function(){var r={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function e(R){var E=new Error(t+": "+R);throw E.source=t,E}function i(){var R=s();return t.length>0&&e("Invalid input not EOF"),R}function s(){return g(o)}function o(){return n("linear-gradient",r.linearGradient,l)||n("repeating-linear-gradient",r.repeatingLinearGradient,l)||n("radial-gradient",r.radialGradient,u)||n("repeating-radial-gradient",r.repeatingRadialGradient,u)}function n(R,E,D){return a(E,function(q){var rt=D();return rt&&(bt(r.comma)||e("Missing comma before color stops")),{type:R,orientation:rt,colorStops:g(v)}})}function a(R,E){var D=bt(R);if(D){bt(r.startCall)||e("Missing (");var q=E(D);return bt(r.endCall)||e("Missing )"),q}}function l(){return h()||c()}function h(){return O("directional",r.sideOrCorner,1)}function c(){return O("angular",r.angleValue,1)}function u(){var R,E=d(),D;return E&&(R=[],R.push(E),D=t,bt(r.comma)&&(E=d(),E?R.push(E):t=D)),R}function d(){var R=p()||f();if(R)R.at=x();else{var E=m();if(E){R=E;var D=x();D&&(R.at=D)}else{var q=y();q&&(R={type:"default-radial",at:q})}}return R}function p(){var R=O("shape",/^(circle)/i,0);return R&&(R.style=G()||m()),R}function f(){var R=O("shape",/^(ellipse)/i,0);return R&&(R.style=lt()||m()),R}function m(){return O("extent-keyword",r.extentKeywords,1)}function x(){if(O("position",/^at/,0)){var R=y();return R||e("Missing positioning value"),R}}function y(){var R=_();if(R.x||R.y)return{type:"position",value:R}}function _(){return{x:lt(),y:lt()}}function g(R){var E=R(),D=[];if(E)for(D.push(E);bt(r.comma);)E=R(),E?D.push(E):e("One extra comma");return D}function v(){var R=U();return R||e("Expected color definition"),R.length=lt(),R}function U(){return L()||X()||k()||V()}function V(){return O("literal",r.literalColor,0)}function L(){return O("hex",r.hexColor,1)}function k(){return a(r.rgbColor,function(){return{type:"rgb",value:g(Z)}})}function X(){return a(r.rgbaColor,function(){return{type:"rgba",value:g(Z)}})}function Z(){return bt(r.number)[1]}function lt(){return O("%",r.percentageValue,1)||Tt()||G()}function Tt(){return O("position-keyword",r.positionKeywords,1)}function G(){return O("px",r.pixelValue,1)||O("em",r.emValue,1)}function O(R,E,D){var q=bt(E);if(q)return{type:R,value:q[D]}}function bt(R){var E,D;return D=/^[\n\r\t\s]+/.exec(t),D&&Ft(D[0].length),E=R.exec(t),E&&Ft(E[0].length),E}function Ft(R){t=t.substr(R)}return function(R){return t=R.toString(),i()}}();var fb=pi.parse;pi.stringify;var xm={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},vm={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function mb(r){var t,e=[],i=1,s;if(typeof r=="string")if(xm[r])e=xm[r].slice(),s="rgb";else if(r==="transparent")i=0,s="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(r)){var o=r.slice(1),n=o.length,a=n<=4;i=1,a?(e=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],n===4&&(i=parseInt(o[3]+o[3],16)/255)):(e=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],n===8&&(i=parseInt(o[6]+o[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(r)){var l=t[1],h=l==="rgb",o=l.replace(/a$/,"");s=o;var n=o==="cmyk"?4:o==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(d,p){if(/%$/.test(d))return p===n?parseFloat(d)/100:o==="rgb"?parseFloat(d)*255/100:parseFloat(d);if(o[p]==="h"){if(/deg$/.test(d))return parseFloat(d);if(vm[d]!==void 0)return vm[d]}return parseFloat(d)}),l===o&&e.push(1),i=h||e[n]===void 0?1:e[n],e=e.slice(0,n)}else r.length>10&&/[0-9](?:\s|\/)/.test(r)&&(e=r.match(/([0-9]+)/g).map(function(c){return parseFloat(c)}),s=r.match(/([a-z])/ig).join("").toLowerCase());else isNaN(r)?Array.isArray(r)||r.length?(e=[r[0],r[1],r[2]],s="rgb",i=r.length===4?r[3]:1):r instanceof Object&&(r.r!=null||r.red!=null||r.R!=null?(s="rgb",e=[r.r||r.red||r.R||0,r.g||r.green||r.G||0,r.b||r.blue||r.B||0]):(s="hsl",e=[r.h||r.hue||r.H||0,r.s||r.saturation||r.S||0,r.l||r.lightness||r.L||r.b||r.brightness]),i=r.a||r.alpha||r.opacity||1,r.opacity!=null&&(i/=100)):(s="rgb",e=[r>>>16,(r&65280)>>>8,r&255]);return{space:s,values:e,alpha:i}}var Ac={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},Sc={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var t=r[0]/360,e=r[1]/100,i=r[2]/100,s,o,n,a,l;if(e===0)return l=i*255,[l,l,l];i<.5?o=i*(1+e):o=i+e-i*e,s=2*i-o,a=[0,0,0];for(var h=0;h<3;h++)n=t+1/3*-(h-1),n<0?n++:n>1&&n--,6*n<1?l=s+(o-s)*6*n:2*n<1?l=o:3*n<2?l=s+(o-s)*(2/3-n)*6:l=s,a[h]=l*255;return a}};Ac.hsl=function(r){var t=r[0]/255,e=r[1]/255,i=r[2]/255,s=Math.min(t,e,i),o=Math.max(t,e,i),n=o-s,a,l,h;return o===s?a=0:t===o?a=(e-i)/n:e===o?a=2+(i-t)/n:i===o&&(a=4+(t-e)/n),a=Math.min(a*60,360),a<0&&(a+=360),h=(s+o)/2,o===s?l=0:h<=.5?l=n/(o+s):l=n/(2-o-s),[a,l*100,h*100]};function gb(r){Array.isArray(r)&&r.raw&&(r=String.raw(...arguments));var t,e=mb(r);if(!e.space)return[];let i=e.space[0]==="h"?Sc.min:Ac.min,s=e.space[0]==="h"?Sc.max:Ac.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],i[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],i[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],i[2]),s[2]),e.space[0]==="h"&&(t=Sc.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function Tm(r){switch(typeof r){case"string":return yb(r);case"number":return A.hex2rgb(r);default:return r}}function yb(r){let t=gb(r);if(!t)throw new Error(`Unable to parse color "${r}" as RGBA.`);return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function xb(r){let t=fb(Ab(r));if(t.length===0)throw new Error("Invalid CSS gradient.");if(t.length!==1)throw new Error("Unsupported CSS gradient (multiple gradients is not supported).");let e=t[0],i=vb(e.type),s=bb(e.colorStops),o=Sb(e.orientation);return{type:i,stops:s,angle:o}}function vb(r){let t={"linear-gradient":0,"radial-gradient":1};if(!(r in t))throw new Error(`Unsupported gradient type "${r}"`);return t[r]}function bb(r){let t=Tb(r),e=[];for(let i=0;i<r.length;i++){let s=_b(r[i]);e.push({offset:t[i],color:s.slice(0,3),alpha:s[3]})}return e}function _b(r){return Tm(wb(r))}function wb(r){switch(r.type){case"hex":return`#${r.value}`;case"literal":return r.value;default:return`${r.type}(${r.value.join(",")})`}}function Tb(r){let t=[];for(let s=0;s<r.length;s++){let o=r[s],n=-1;o.type==="literal"&&o.length&&"type"in o.length&&o.length.type==="%"&&"value"in o.length&&(n=parseFloat(o.length.value)/100),t.push(n)}let e=s=>{for(let o=s;o<t.length;o++)if(t[o]!==-1)return{indexDelta:o-s,offset:t[o]};return{indexDelta:t.length-1-s,offset:1}},i=0;for(let s=0;s<t.length;s++){let o=t[s];if(o!==-1)i=o;else if(s===0)t[s]=0;else if(s+1===t.length)t[s]=1;else{let n=e(s),a=(n.offset-i)/(1+n.indexDelta);for(let l=0;l<=n.indexDelta;l++)t[s+l]=i+(l+1)*a;s+=n.indexDelta,i=t[s]}}return t.map(Cb)}function Cb(r){return r.toString().length>6?parseFloat(r.toString().substring(0,6)):r}function Sb(r){if(typeof r>"u")return 0;if("type"in r&&"value"in r)switch(r.type){case"angular":return parseFloat(r.value);case"directional":return Eb(r.value)}return 0}function Eb(r){let t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(r in t))throw new Error(`Unsupported directional value "${r}"`);return t[r]}function Ab(r){let t=r.replace(/\s{2,}/gu," ");return t=t.replace(/;/g,""),t=t.replace(/ ,/g,","),t=t.replace(/\( /g,"("),t=t.replace(/ \)/g,")"),t.trim()}var Ib=Object.defineProperty,Pb=Object.defineProperties,Mb=Object.getOwnPropertyDescriptors,bm=Object.getOwnPropertySymbols,Rb=Object.prototype.hasOwnProperty,Fb=Object.prototype.propertyIsEnumerable,_m=(r,t,e)=>t in r?Ib(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ec=(r,t)=>{for(var e in t||(t={}))Rb.call(t,e)&&_m(r,e,t[e]);if(bm)for(var e of bm(t))Fb.call(t,e)&&_m(r,e,t[e]);return r},Lb=(r,t)=>Pb(r,Mb(t)),wm=90;function Bb(r){return[...r].sort((t,e)=>t.offset-e.offset)}var Ic=class extends N{constructor(r){r&&"css"in r&&(r=Lb(Ec({},xb(r.css||"")),{alpha:r.alpha,maxColors:r.maxColors}));let t=Ec(Ec({},Ic.defaults),r);if(!t.stops||t.stops.length<2)throw new Error("ColorGradientFilter requires at least 2 color stops.");super(pb,db),this._stops=[],this.autoFit=!1,Object.assign(this,t)}get stops(){return this._stops}set stops(r){let t=Bb(r),e=new Float32Array(t.length*3),i=0,s=1,o=2;for(let n=0;n<t.length;n++){let a=Tm(t[n].color),l=n*3;e[l+i]=a[i],e[l+s]=a[s],e[l+o]=a[o]}this.uniforms.uColors=e,this.uniforms.uOffsets=t.map(n=>n.offset),this.uniforms.uAlphas=t.map(n=>n.alpha),this.uniforms.uNumStops=t.length,this._stops=t}set type(r){this.uniforms.uType=r}get type(){return this.uniforms.uType}set angle(r){this.uniforms.uAngle=r-wm}get angle(){return this.uniforms.uAngle+wm}set alpha(r){this.uniforms.uAlpha=r}get alpha(){return this.uniforms.uAlpha}set maxColors(r){this.uniforms.uMaxColors=r}get maxColors(){return this.uniforms.uMaxColors}},Aa=Ic;Aa.LINEAR=0,Aa.RADIAL=1,Aa.CONIC=2,Aa.defaults={type:Ic.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};var kb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ob=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`,Cm=class extends N{constructor(r){super(kb,Ob),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Cm.defaults,r)}apply(r,t,e,i){let{width:s,height:o}=t.filterFrame;this.uniforms.dimensions[0]=s,this.uniforms.dimensions[1]=o,this.uniforms.seed=this.seed,this.uniforms.time=this.time,r.applyFilter(this,t,e,i)}set curvature(r){this.uniforms.curvature=r}get curvature(){return this.uniforms.curvature}set lineWidth(r){this.uniforms.lineWidth=r}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(r){this.uniforms.lineContrast=r}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(r){this.uniforms.verticalLine=r}get verticalLine(){return this.uniforms.verticalLine}set noise(r){this.uniforms.noise=r}get noise(){return this.uniforms.noise}set noiseSize(r){this.uniforms.noiseSize=r}get noiseSize(){return this.uniforms.noiseSize}set vignetting(r){this.uniforms.vignetting=r}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(r){this.uniforms.vignettingAlpha=r}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(r){this.uniforms.vignettingBlur=r}get vignettingBlur(){return this.uniforms.vignettingBlur}},Db=Cm;Db.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};var Nb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Ub=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,Gb=Object.defineProperty,Sm=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,jb=Object.prototype.propertyIsEnumerable,Em=(r,t,e)=>t in r?Gb(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Am=(r,t)=>{for(var e in t||(t={}))zb.call(t,e)&&Em(r,e,t[e]);if(Sm)for(var e of Sm(t))jb.call(t,e)&&Em(r,e,t[e]);return r},Pc=class extends N{constructor(r){super(),this.angle=45,this._distance=5,this._resolution=S.FILTER_RESOLUTION;let t=r?Am(Am({},Pc.defaults),r):Pc.defaults,{kernels:e,blur:i,quality:s,pixelSize:o,resolution:n}=t;this._offset=new ce(this._updatePadding,this),this._tintFilter=new N(Nb,Ub),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=n,this._blurFilter=e?new Lr(e):new Lr(i,s),this.pixelSize=o,this.resolution=n;let{shadowOnly:a,rotation:l,distance:h,offset:c,alpha:u,color:d}=t;this.shadowOnly=a,l!==void 0&&h!==void 0?(this.rotation=l,this.distance=h):this.offset=c,this.alpha=u,this.color=d}apply(r,t,e,i){let s=r.getFilterTexture();this._tintFilter.apply(r,t,s,1),this._blurFilter.apply(r,s,e,i),this.shadowOnly!==!0&&r.applyFilter(this,t,e,0),r.returnFilterTexture(s)}_updatePadding(){let r=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=r+this.blur*2}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(r){this._offset.copyFrom(r),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(r){this._resolution=r,this._tintFilter&&(this._tintFilter.resolution=r),this._blurFilter&&(this._blurFilter.resolution=r)}get distance(){return this._distance}set distance(r){A.deprecation("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=r,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/ke}set rotation(r){A.deprecation("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=r*ke,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(r){this._tintFilter.uniforms.alpha=r}get color(){return A.rgb2hex(this._tintFilter.uniforms.color)}set color(r){A.hex2rgb(r,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(r){this._blurFilter.kernels=r}get blur(){return this._blurFilter.blur}set blur(r){this._blurFilter.blur=r,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(r){this._blurFilter.quality=r}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(r){this._blurFilter.pixelSize=r}},fi=Pc;fi.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:S.FILTER_RESOLUTION};var Vb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Hb=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`,Mc=class extends N{constructor(r){super(Vb,Hb),this.offset=100,this.fillMode=Mc.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=b.from(this._canvas,{scaleMode:Gt.NEAREST}),Object.assign(this,Mc.defaults,r)}apply(r,t,e,i){let{width:s,height:o}=t.filterFrame;this.uniforms.dimensions[0]=s,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/s,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,r.applyFilter(this,t,e,i)}_randomizeSizes(){let r=this._sizes,t=this._slices-1,e=this.sampleSize,i=Math.min(this.minSize/e,.9/this._slices);if(this.average){let s=this._slices,o=1;for(let n=0;n<t;n++){let a=o/(s-n),l=Math.max(a*(1-Math.random()*.6),i);r[n]=l,o-=l}r[t]=o}else{let s=1,o=Math.sqrt(1/this._slices);for(let n=0;n<t;n++){let a=Math.max(o*s*Math.random(),i);r[n]=a,s-=a}r[t]=s}this.shuffle()}shuffle(){let r=this._sizes,t=this._slices-1;for(let e=t;e>0;e--){let i=Math.random()*e>>0,s=r[e];r[e]=r[i],r[i]=s}}_randomizeOffsets(){for(let r=0;r<this._slices;r++)this._offsets[r]=Math.random()*(Math.random()<.5?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){let r=this.sampleSize,t=this.texture,e=this._canvas.getContext("2d");e.clearRect(0,0,8,r);let i,s=0;for(let o=0;o<this._slices;o++){i=Math.floor(this._offsets[o]*256);let n=this._sizes[o]*r,a=i>0?i:0,l=i<0?-i:0;e.fillStyle=`rgba(${a}, ${l}, 0, 1)`,e.fillRect(0,s>>0,r,n+1>>0),s+=n}t.baseTexture.update(),this.uniforms.displacementMap=t}set sizes(r){let t=Math.min(this._slices,r.length);for(let e=0;e<t;e++)this._sizes[e]=r[e]}get sizes(){return this._sizes}set offsets(r){let t=Math.min(this._slices,r.length);for(let e=0;e<t;e++)this._offsets[e]=r[e]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(r){this._slices!==r&&(this._slices=r,this.uniforms.slices=r,this._sizes=this.uniforms.slicesWidth=new Float32Array(r),this._offsets=this.uniforms.slicesOffset=new Float32Array(r),this.refresh())}get direction(){return this._direction}set direction(r){if(this._direction===r)return;this._direction=r;let t=r*ke;this.uniforms.sinDir=Math.sin(t),this.uniforms.cosDir=Math.cos(t)}get red(){return this.uniforms.red}set red(r){this.uniforms.red=r}get green(){return this.uniforms.green}set green(r){this.uniforms.green=r}get blue(){return this.uniforms.blue}set blue(r){this.uniforms.blue=r}destroy(){var r;(r=this.texture)==null||r.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}},bs=Mc;bs.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},bs.TRANSPARENT=0,bs.ORIGINAL=1,bs.LOOP=2,bs.CLAMP=3,bs.MIRROR=4;var $b=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Xb=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`,Im=class extends N{constructor(r){let t=Object.assign({},Im.defaults,r),{outerStrength:e,innerStrength:i,color:s,knockout:o,quality:n,alpha:a}=t,l=Math.round(t.distance);super($b,Xb.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/n/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:s,outerStrength:e,innerStrength:i,padding:l,knockout:o,alpha:a})}get color(){return A.rgb2hex(this.uniforms.glowColor)}set color(r){A.hex2rgb(r,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(r){this.uniforms.outerStrength=r}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(r){this.uniforms.innerStrength=r}get knockout(){return this.uniforms.knockout}set knockout(r){this.uniforms.knockout=r}get alpha(){return this.uniforms.alpha}set alpha(r){this.uniforms.alpha=r}},Wb=Im;Wb.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};var Yb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,qb=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,Kb=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`,Pm=class extends N{constructor(r){super(Yb,Kb.replace("${perlin}",qb)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);let t=Object.assign(Pm.defaults,r);this._angleLight=new H,this.angle=t.angle,this.gain=t.gain,this.lacunarity=t.lacunarity,this.alpha=t.alpha,this.parallel=t.parallel,this.center=t.center,this.time=t.time}apply(r,t,e,i){let{width:s,height:o}=t.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=s,this.uniforms.dimensions[1]=o,this.uniforms.aspect=o/s,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,r.applyFilter(this,t,e,i)}get angle(){return this._angle}set angle(r){this._angle=r;let t=r*ke;this._angleLight.x=Math.cos(t),this._angleLight.y=Math.sin(t)}get gain(){return this.uniforms.gain}set gain(r){this.uniforms.gain=r}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(r){this.uniforms.lacunarity=r}get alpha(){return this.uniforms.alpha}set alpha(r){this.uniforms.alpha=r}},Zb=Pm;Zb.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};var Qb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Jb=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`,Mm=class extends N{constructor(r){super(Qb,Jb),this._hue=0;let t=Object.assign({},Mm.defaults,r);Object.assign(this,t)}get hue(){return this._hue}set hue(r){this._hue=r,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(r){this.uniforms.uAlpha=r}get colorize(){return this.uniforms.uColorize}set colorize(r){this.uniforms.uColorize=r}get lightness(){return this.uniforms.uLightness}set lightness(r){this.uniforms.uLightness=r}get saturation(){return this.uniforms.uSaturation}set saturation(r){this.uniforms.uSaturation=r}},t_=Mm;t_.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};var e_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,r_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`,Rm=class extends N{constructor(r,t=0){super(e_,r_),this.seed=0,this.uniforms.dimensions=new Float32Array(2),typeof r=="number"?(this.seed=r,r=void 0):this.seed=t,Object.assign(this,Rm.defaults,r)}apply(r,t,e,i){var s,o;this.uniforms.dimensions[0]=(s=t.filterFrame)==null?void 0:s.width,this.uniforms.dimensions[1]=(o=t.filterFrame)==null?void 0:o.height,this.uniforms.seed=this.seed,r.applyFilter(this,t,e,i)}set sepia(r){this.uniforms.sepia=r}get sepia(){return this.uniforms.sepia}set noise(r){this.uniforms.noise=r}get noise(){return this.uniforms.noise}set noiseSize(r){this.uniforms.noiseSize=r}get noiseSize(){return this.uniforms.noiseSize}set scratch(r){this.uniforms.scratch=r}get scratch(){return this.uniforms.scratch}set scratchDensity(r){this.uniforms.scratchDensity=r}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(r){this.uniforms.scratchWidth=r}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(r){this.uniforms.vignetting=r}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(r){this.uniforms.vignettingAlpha=r}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(r){this.uniforms.vignettingBlur=r}get vignettingBlur(){return this.uniforms.vignettingBlur}},i_=Rm;i_.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};var s_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`,Ia=class extends N{constructor(r=1,t=0,e=.1,i=1,s=!1){super(s_,o_.replace(/\$\{angleStep\}/,Ia.getAngleStep(e))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=i,this.uniforms.uKnockout=s,Object.assign(this,{thickness:r,color:t,quality:e,alpha:i,knockout:s})}static getAngleStep(r){let t=Math.max(r*Ia.MAX_SAMPLES,Ia.MIN_SAMPLES);return(Math.PI*2/t).toFixed(7)}apply(r,t,e,i){this.uniforms.uThickness[0]=this._thickness/t._frame.width,this.uniforms.uThickness[1]=this._thickness/t._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,r.applyFilter(this,t,e,i)}get alpha(){return this._alpha}set alpha(r){this._alpha=r}get color(){return A.rgb2hex(this.uniforms.uColor)}set color(r){A.hex2rgb(r,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(r){this._knockout=r}get thickness(){return this._thickness}set thickness(r){this._thickness=r,this.padding=r}},Fm=Ia;Fm.MIN_SAMPLES=1,Fm.MAX_SAMPLES=100;var n_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`,Lm=class extends N{constructor(r){super(n_,a_),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,Lm.defaults,r)}apply(r,t,e,i){var s,o;this.uniforms.dimensions[0]=(s=t.filterFrame)==null?void 0:s.width,this.uniforms.dimensions[1]=(o=t.filterFrame)==null?void 0:o.height,this.uniforms.time=this.time,r.applyFilter(this,t,e,i)}set mirror(r){this.uniforms.mirror=r}get mirror(){return this.uniforms.mirror}set boundary(r){this.uniforms.boundary=r}get boundary(){return this.uniforms.boundary}set amplitude(r){this.uniforms.amplitude[0]=r[0],this.uniforms.amplitude[1]=r[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(r){this.uniforms.waveLength[0]=r[0],this.uniforms.waveLength[1]=r[1]}get waveLength(){return this.uniforms.waveLength}set alpha(r){this.uniforms.alpha[0]=r[0],this.uniforms.alpha[1]=r[1]}get alpha(){return this.uniforms.alpha}},l_=Lm;l_.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};var h_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,c_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`,Bm=class extends N{constructor(r=[0,0],t,e=0){super(h_,c_),this.center=r,Object.assign(this,Bm.defaults,t),this.time=e}apply(r,t,e,i){this.uniforms.time=this.time,r.applyFilter(this,t,e,i)}get center(){return this.uniforms.center}set center(r){this.uniforms.center=r}get amplitude(){return this.uniforms.amplitude}set amplitude(r){this.uniforms.amplitude=r}get wavelength(){return this.uniforms.wavelength}set wavelength(r){this.uniforms.wavelength=r}get brightness(){return this.uniforms.brightness}set brightness(r){this.uniforms.brightness=r}get speed(){return this.uniforms.speed}set speed(r){this.uniforms.speed=r}get radius(){return this.uniforms.radius}set radius(r){this.uniforms.radius=r}},u_=Bm;u_.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};var d_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,p_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,Pa=class extends N{constructor(t){var e,i;super(d_,p_),this.uniforms.blur=t.blur,this.uniforms.gradientBlur=t.gradientBlur,this.uniforms.start=(e=t.start)!=null?e:new H(0,window.innerHeight/2),this.uniforms.end=(i=t.end)!=null?i:new H(600,window.innerHeight/2),this.uniforms.delta=new H(30,30),this.uniforms.texSize=new H(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(t){this.uniforms.blur=t}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(t){this.uniforms.gradientBlur=t}get start(){return this.uniforms.start}set start(t){this.uniforms.start=t,this.updateDelta()}get end(){return this.uniforms.end}set end(t){this.uniforms.end=t,this.updateDelta()}},Rc=class extends Pa{updateDelta(){let t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.x=t/i,this.uniforms.delta.y=e/i}},Fc=class extends Pa{updateDelta(){let t=this.uniforms.end.x-this.uniforms.start.x,e=this.uniforms.end.y-this.uniforms.start.y,i=Math.sqrt(t*t+e*e);this.uniforms.delta.x=-e/i,this.uniforms.delta.y=t/i}},km=class extends N{constructor(r,t,e,i){super(),typeof r=="number"&&(A.deprecation("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),r={blur:r,gradientBlur:t,start:e,end:i}),r=Object.assign({},km.defaults,r),this.tiltShiftXFilter=new Rc(r),this.tiltShiftYFilter=new Fc(r)}apply(r,t,e,i){let s=r.getFilterTexture();this.tiltShiftXFilter.apply(r,t,s,1),this.tiltShiftYFilter.apply(r,s,e,i),r.returnFilterTexture(s)}get blur(){return this.tiltShiftXFilter.blur}set blur(r){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=r}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(r){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=r}get start(){return this.tiltShiftXFilter.start}set start(r){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=r}get end(){return this.tiltShiftXFilter.end}set end(r){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=r}},f_=km;f_.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};var m_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,g_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`,Om=class extends N{constructor(r){super(m_,g_),Object.assign(this,Om.defaults,r)}get offset(){return this.uniforms.offset}set offset(r){this.uniforms.offset=r}get radius(){return this.uniforms.radius}set radius(r){this.uniforms.radius=r}get angle(){return this.uniforms.angle}set angle(r){this.uniforms.angle=r}},y_=Om;y_.defaults={radius:200,angle:4,padding:20,offset:new H};var x_=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,v_=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,Dm=Object.getOwnPropertySymbols,b_=Object.prototype.hasOwnProperty,__=Object.prototype.propertyIsEnumerable,w_=(r,t)=>{var e={};for(var i in r)b_.call(r,i)&&t.indexOf(i)<0&&(e[i]=r[i]);if(r!=null&&Dm)for(var i of Dm(r))t.indexOf(i)<0&&__.call(r,i)&&(e[i]=r[i]);return e},Nm=class extends N{constructor(r){let t=Object.assign(Nm.defaults,r),{maxKernelSize:e}=t,i=w_(t,["maxKernelSize"]);super(x_,v_.replace("${maxKernelSize}",e.toFixed(1))),Object.assign(this,i)}get center(){return this.uniforms.uCenter}set center(r){this.uniforms.uCenter=r}get strength(){return this.uniforms.uStrength}set strength(r){this.uniforms.uStrength=r}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(r){this.uniforms.uInnerRadius=r}get radius(){return this.uniforms.uRadius}set radius(r){(r<0||r===1/0)&&(r=-1),this.uniforms.uRadius=r}},T_=Nm;T_.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};var Br=class extends I{halfWidth=.5;roadX=0;lane;body;health=100;tintColor={r:255,g:255,b:255};tintTween;constructor(){super(),this.body=new C,this.body.anchor.set(.5),It.disableShadows||(this.body.filters=[new fi({blur:2,offset:{x:-6,y:6}})]),this.addChild(this.body),this.scale.set(.8),this.tintTween=new at(this.tintColor).from({r:256,g:128,b:128}).to({r:256,g:256,b:256},200).yoyo().easing(it.Quadratic.In).yoyoEasing(it.Quadratic.Out).onUpdate(()=>{this.body.tint=tt.shared.setValue(this.tintColor).toHex()})}takeDamage(t){this.tintTween.isPlaying()||this.tintTween.start()}};var Nt=class{inactiveInstances=[];activeInstances=[];createFunction;resetFunction;destroyFunction;constructor(t,e,i){this.createFunction=t,this.resetFunction=e,this.destroyFunction=i}getInstance(){let t=this.inactiveInstances.pop()||this.createFunction();return this.activeInstances.push(t),this.resetFunction(t),t}release(t){t.parent&&t.parent.removeChild(t),this.activeInstances=this.activeInstances.filter(e=>e!=t),this.inactiveInstances.push(t)}destroy(){[...this.activeInstances,...this.inactiveInstances].forEach(t=>this.destroyFunction(t))}};var C_={firePeriodMS:300,projectileSpeed:1},Um=["Yellow","Green","Blue","Pink"],ve=class{lastFiredMS;config;onFire=new Pe;projectiles;body;flashes;flashTween;canFire=!1;constructor(t,e){this.config=Object.assign({},C_,t||{}),this.body=new C,this.projectiles=e,this.flashes=new I,this.lastFiredMS=this.config.firePeriodMS,this.flashTween=new at(this.flashes),this.flashes.alpha=0}update(t){this.canFire&&(this.lastFiredMS+=t,this.lastFiredMS>this.config.firePeriodMS&&(this.lastFiredMS-=this.config.firePeriodMS,this.fire())),this.projectiles.activeInstances.forEach(e=>{this.updateProjectile(e,t)})}fire(){this.flashes.alpha=1,this.flashTween.to({alpha:0},200).easing(it.Sinusoidal.Out).start()}updateProjectile(t,e){t.y+=this.config.projectileSpeed*Math.sin(t.rotation-Math.PI/2)*e,t.x+=this.config.projectileSpeed*Math.cos(t.rotation-Math.PI/2)*e,(t.y>P.height||t.y<0)&&this.projectiles.release(t)}addMuzzleFlash(t,e){let i=new C(t);i.anchor.set(.5),this.flashes.addChild(i),i.position.copyFrom(e)}getColor(t){return Um[t%Um.length]}getProjectileDamage(){return 10}static resetProjectile(t){t.rotation=0}static destroyProjectile(t){t.destroy()}};var kr=[{gun:"Weapon-1-Yellow",flash:"Fire-Exit-1-Yellow",projectile:"Fire-1-Yellow",projectileCount:1},{gun:"Weapon-1-Green",flash:"Fire-Exit-1-Green",projectile:"Fire-1-Green",projectileCount:1},{gun:"Weapon-1-Blue",flash:"Fire-Exit-1-Blue",projectile:"Fire-1-Blue",projectileCount:1},{gun:"Weapon-2-Yellow",flash:"Fire-Exit-1-Yellow",projectile:"Fire-1-Yellow",projectileCount:2},{gun:"Weapon-2-Green",flash:"Fire-Exit-1-Green",projectile:"Fire-1-Green",projectileCount:2},{gun:"Weapon-2-Blue",flash:"Fire-Exit-1-Blue",projectile:"Fire-1-Blue",projectileCount:2},{gun:"Weapon-2-Pink",flash:"Fire-Exit-1-Pink",projectile:"Fire-1-Pink",projectileCount:2},{gun:"Weapon-3-Standart",flash:"Fire-Exit-3-Yellow",projectile:"Fire-1-Yellow",projectileCount:3},{gun:"Weapon-3-Standart",flash:"Fire-Exit-3-Green",projectile:"Fire-1-Green",projectileCount:3},{gun:"Weapon-3-Standart",flash:"Fire-Exit-3-Blue",projectile:"Fire-1-Blue",projectileCount:3},{gun:"Weapon-3-Standart",flash:"Fire-Exit-3-Pink",projectile:"Fire-1-Pink",projectileCount:3}],Ma=class r extends ve{level;constructor(t,e=1){super(t||{},new Nt(()=>r.createProjectile(e),ve.resetProjectile,ve.destroyProjectile)),this.level=e,this.body.texture=b.from(kr[this.level].gun),this.body.anchor.set(.5,.85),this.body.scale.set(.5),this.upgrade(this.level)}fire(){if(super.fire(),this.level<3){let t=this.projectiles.getInstance();t.position.set(0,-65),this.onFire.dispatch([t])}else if(this.level<7){let t=this.projectiles.getInstance(),e=this.projectiles.getInstance();t.position.set(-14,-65),e.position.set(14,-65),this.onFire.dispatch([t,e])}else{let t=this.projectiles.getInstance(),e=this.projectiles.getInstance(),i=this.projectiles.getInstance();t.position.set(-14,-60),e.position.set(0,-65),i.position.set(14,-60),this.onFire.dispatch([t,e,i])}}setupMuzzleFlash(t){this.flashes.removeChildren(),t<3?this.addMuzzleFlash(b.from(kr[t].flash),{x:0,y:-125}):t<7?(this.addMuzzleFlash(b.from(kr[t].flash),{x:-16,y:-120}),this.addMuzzleFlash(b.from(kr[t].flash),{x:16,y:-120})):this.addMuzzleFlash(b.from(kr[t].flash),{x:1,y:-110})}upgrade(t){this.body.texture=b.from(kr[t].gun),this.setupMuzzleFlash(t)}getProjectileDamage(){return(this.level*2+20)/kr[this.level].projectileCount}static createProjectile(t){let e=new C(b.from(kr[t].projectile));return e.anchor.set(.5),e}};var $o=class extends ve{side;level;constructor(t,e,i){super(t,new Nt(()=>{let s=new C(b.from(`Fire-1-${this.getColor(i)}`));return s.anchor.set(.5),s},ve.resetProjectile,ve.destroyProjectile)),this.level=i,this.side=e,this.body.texture=b.from("Weapon-Side"),this.body.anchor.set(.5),this.body.scale.set(.5),e=="Right"&&(this.body.scale.x*=-1),this.body.visible=this.level!=0,this.setupMuzzleFlash(this.level)}setupMuzzleFlash(t){if(this.flashes.removeChildren(),t>0){let e=this.getColor(t);this.addMuzzleFlash(b.from(`Fire-Exit-1-${e}`),{x:this.side=="Left"?-102:102,y:-72})}}fire(){if(this.level==0)return;super.fire();let t=this.projectiles.getInstance();t.position.set(this.side=="Left"?18:-18,-20),this.onFire.dispatch([t])}getProjectileDamage(){return(this.level*2+5)/2}upgrade(t){this.level=t,this.body.visible=this.level!=0}};var S_={maxHealth:100,baseHealth:45},_s=class extends Br{leftGun;mainGun;rightGun;magnetEffect;hpEffect;moneyEffect;guns=[];constructor(t,e){super();let i=`Player-Car-${t+1}`;this.body.texture=b.from(i),this.mainGun=new Ma({firePeriodMS:150},e.damage),this.guns.push(this.mainGun),this.resetHP(e.armor),this.addChild(this.body),this.addChild(this.mainGun.flashes),this.addChild(this.mainGun.body),this.addSideGuns(e.guns),this.magnetEffect=new vs("shield_loop",{scale:2,speed:.2,loop:!0}),this.magnetEffect.tint=3386111,this.addChild(this.magnetEffect),this.magnetEffect.visible=!1,new at(this.magnetEffect).from({alpha:.5}).to({alpha:.8},300).repeat(1/0).yoyo().easing(it.Sinusoidal.InOut).start(),this.hpEffect=new vs("hp_loop",{scale:2,speed:.3,loop:!1}),this.hpEffect.tint=16777022,this.addChild(this.hpEffect),this.hpEffect.visible=!1,this.moneyEffect=new vs("money_loop",{scale:2,speed:.3,alpha:.5,loop:!0}),this.moneyEffect.tint=3136256,this.addChild(this.moneyEffect),this.moneyEffect.visible=!1}addSideGuns(t){this.leftGun=new $o({},"Left",t),this.rightGun=new $o({},"Right",t),this.leftGun.body.x=-this.body.width/2,this.rightGun.body.x=this.body.width/2,this.guns.push(this.leftGun),this.guns.push(this.rightGun),this.addChild(this.leftGun.flashes),this.addChild(this.leftGun.body),this.addChild(this.rightGun.flashes),this.addChild(this.rightGun.body)}resetHP(t){this.health=this.getMaxHealth(t)}getMaxHealth(t){return S_.baseHealth+t*4}updateGuns(t){this.guns.forEach(e=>e.update(t))}setFiringPermission(t){this.guns.forEach(e=>e.canFire=t)}};var Lc={en:{Race:"Race",Rank:"Rank",Name:"Name",Rep:"Rep","Rep:":"Rep:",Upgrade:"Upgrade","More games":"More games",Settings:"Settings",Music:"Music",Sounds:"Sounds",Armor:"Armor","Main gun":"Main gun","Extra guns":"Extra guns",Max:"Max","Tap to play":`Tap and hold
to play`,Restart:"Restart",Home:"Home",Boss:"Boss!","Boss defeated":"Boss Defeated!",Bounty:"Bounty",Reward:"Reward",Continue:"Continue","Continue?":"Continue?",Yes:"Yes",Victory:"Victory!",Defeat:"Defeat!"},ru:{Race:"\u0413\u043E\u043D\u043A\u0430",Rank:"\u041C\u0435\u0441\u0442\u043E",Name:"\u0418\u043C\u044F",Rep:"\u0421\u0447\u0451\u0442","Rep:":"\u0421\u0447\u0451\u0442:",Upgrade:"\u0423\u043B\u0443\u0447\u0448\u0435\u043D\u0438\u044F","More games":"\u0411\u043E\u043B\u044C\u0448\u0435 \u0438\u0433\u0440",Settings:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",Music:"\u041C\u0443\u0437\u044B\u043A\u0430",Sounds:"\u0417\u0432\u0443\u043A\u0438",Armor:"\u0411\u0440\u043E\u043D\u044F","Main gun":"\u041E\u0440\u0443\u0436\u0438\u0435","Extra guns":"\u0414\u043E\u043F. \u043F\u0443\u0448\u043A\u0438",Max:"\u041C\u0430\u043A\u0441.","Tap to play":`\u0423\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0439 \u0442\u0430\u043F,
\u0447\u0442\u043E\u0431\u044B \u0435\u0445\u0430\u0442\u044C`,Restart:"\u0417\u0430\u043D\u043E\u0432\u043E",Home:"\u041C\u0435\u043D\u044E",Boss:"\u0411\u043E\u0441\u0441!","Boss defeated":"\u0411\u043E\u0441\u0441 \u043F\u043E\u0431\u0435\u0436\u0434\u0451\u043D!",Bounty:"\u041D\u0430\u0433\u0440\u0430\u0434\u0430",Reward:"\u041D\u0430\u0433\u0440\u0430\u0434\u0430",Continue:"\u0414\u0430\u043B\u0435\u0435","Continue?":"\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C?",Yes:"\u0414\u0430",Victory:"\u041F\u043E\u0431\u0435\u0434\u0430!",Defeat:"\u041F\u043E\u0440\u0430\u0436\u0435\u043D\u0438\u0435!"}};var F=class r{static locale="en";static font="rajdhani";static setLocale(t){Object.keys(Lc).includes(t)&&(r.locale=t),r.locale=="ru"&&(r.font="rubik")}static getText(t){return Lc[r.locale][t]||t}};var ws=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(ws||{});var Ra={willReadFrequently:!0},Ze=class z{static get experimentalLetterSpacingSupported(){let t=z._experimentalLetterSpacingSupported;if(t!==void 0){let e=S.ADAPTER.getCanvasRenderingContext2D().prototype;t=z._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,o,n,a,l,h){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=o,this.lineWidths=n,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}static measureText(t,e,i,s=z._canvas){i=i??e.wordWrap;let o=e.toFontString(),n=z.measureFont(o);n.fontSize===0&&(n.fontSize=e.fontSize,n.ascent=e.fontSize);let a=s.getContext("2d",Ra);a.font=o;let l=(i?z.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length),c=0;for(let f=0;f<l.length;f++){let m=z._measureText(l[f],e.letterSpacing,a);h[f]=m,c=Math.max(c,m)}let u=c+e.strokeThickness;e.dropShadow&&(u+=e.dropShadowDistance);let d=e.lineHeight||n.fontSize+e.strokeThickness,p=Math.max(d,n.fontSize+e.strokeThickness*2)+e.leading+(l.length-1)*(d+e.leading);return e.dropShadow&&(p+=e.dropShadowDistance),new z(t,e,u,p,l,h,d+e.leading,c,n)}static _measureText(t,e,i){let s=!1;z.experimentalLetterSpacingSupported&&(z.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let o=i.measureText(t).width;return o>0&&(s?o-=e:o+=(z.graphemeSegmenter(t).length-1)*e),o}static wordWrap(t,e,i=z._canvas){let s=i.getContext("2d",Ra),o=0,n="",a="",l=Object.create(null),{letterSpacing:h,whiteSpace:c}=e,u=z.collapseSpaces(c),d=z.collapseNewlines(c),p=!u,f=e.wordWrapWidth+h,m=z.tokenize(t);for(let x=0;x<m.length;x++){let y=m[x];if(z.isNewline(y)){if(!d){a+=z.addLine(n),p=!u,n="",o=0;continue}y=" "}if(u){let g=z.isBreakingSpace(y),v=z.isBreakingSpace(n[n.length-1]);if(g&&v)continue}let _=z.getFromCache(y,h,l,s);if(_>f)if(n!==""&&(a+=z.addLine(n),n="",o=0),z.canBreakWords(y,e.breakWords)){let g=z.wordWrapSplit(y);for(let v=0;v<g.length;v++){let U=g[v],V=U,L=1;for(;g[v+L];){let X=g[v+L];if(!z.canBreakChars(V,X,y,v,e.breakWords))U+=X;else break;V=X,L++}v+=L-1;let k=z.getFromCache(U,h,l,s);k+o>f&&(a+=z.addLine(n),p=!1,n="",o=0),n+=U,o+=k}}else{n.length>0&&(a+=z.addLine(n),n="",o=0);let g=x===m.length-1;a+=z.addLine(y,!g),p=!1,n="",o=0}else _+o>f&&(p=!1,a+=z.addLine(n),n="",o=0),(n.length>0||!z.isBreakingSpace(y)||p)&&(n+=y,o+=_)}return a+=z.addLine(n,!1),a}static addLine(t,e=!0){return t=z.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,s){let o=i[t];return typeof o!="number"&&(o=z._measureText(t,e,s)+e,i[t]=o),o}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){let i=t[e];if(!z.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:z._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:z._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){let e=[],i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){let o=t[s],n=t[s+1];if(z.isBreakingSpace(o,n)||z.isNewline(o)){i!==""&&(e.push(i),i=""),e.push(o);continue}i+=o}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,o){return!0}static wordWrapSplit(t){return z.graphemeSegmenter(t)}static measureFont(t){if(z._fonts[t])return z._fonts[t];let e={ascent:0,descent:0,fontSize:0},i=z._canvas,s=z._context;s.font=t;let o=z.METRICS_STRING+z.BASELINE_SYMBOL,n=Math.ceil(s.measureText(o).width),a=Math.ceil(s.measureText(z.BASELINE_SYMBOL).width),l=Math.ceil(z.HEIGHT_MULTIPLIER*a);if(a=a*z.BASELINE_MULTIPLIER|0,n===0||l===0)return z._fonts[t]=e,e;i.width=n,i.height=l,s.fillStyle="#f00",s.fillRect(0,0,n,l),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(o,0,a);let h=s.getImageData(0,0,n,l).data,c=h.length,u=n*4,d=0,p=0,f=!1;for(d=0;d<a;++d){for(let m=0;m<u;m+=4)if(h[p+m]!==255){f=!0;break}if(!f)p+=u;else break}for(e.ascent=a-d,p=c-u,f=!1,d=l;d>a;--d){for(let m=0;m<u;m+=4)if(h[p+m]!==255){f=!0;break}if(!f)p-=u;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,z._fonts[t]=e,e}static clearMetrics(t=""){t?delete z._fonts[t]:z._fonts={}}static get _canvas(){if(!z.__canvas){let t;try{let e=new OffscreenCanvas(0,0);if(e.getContext("2d",Ra)?.measureText)return z.__canvas=e,e;t=S.ADAPTER.createCanvas()}catch{t=S.ADAPTER.createCanvas()}t.width=t.height=10,z.__canvas=t}return z.__canvas}static get _context(){return z.__context||(z.__context=z._canvas.getContext("2d",Ra)),z.__context}};Ze.METRICS_STRING="|\xC9q\xC5",Ze.BASELINE_SYMBOL="M",Ze.BASELINE_MULTIPLIER=1.4,Ze.HEIGHT_MULTIPLIER=2,Ze.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){let r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})(),Ze.experimentalLetterSpacing=!1,Ze._fonts={},Ze._newlines=[10,13],Ze._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var Or=Ze;var A_=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Gm=class Xo{constructor(t){this.styleID=0,this.reset(),kc(this,t,t)}clone(){let t={};return kc(t,this,Xo.defaultStyle),new Xo(t)}reset(){kc(this,Xo.defaultStyle,Xo.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){let e=Bc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){let e=Bc(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){I_(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){let e=Bc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){let t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!A_.includes(s)&&(s=`"${s}"`),e[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};Gm.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:ws.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};var Fa=Gm;function Bc(r){let t=tt.shared,e=i=>{let s=t.setValue(i);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(r)?r.map(e):e(r)}function I_(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function kc(r,t,e){for(let i in e)Array.isArray(t[i])?r[i]=t[i].slice():r[i]=t[i]}var P_={texture:!0,children:!1,baseTexture:!0},zm=class Oc extends C{constructor(t,e,i){let s=!1;i||(i=S.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;let o=b.from(i);o.orig=new $,o.trim=new $,super(o),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=Oc.defaultResolution??S.RESOLUTION,this._autoResolution=Oc.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return Or.experimentalLetterSpacing}static set experimentalLetterSpacing(t){A.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Or.experimentalLetterSpacing=t}updateText(t){let e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();let i=this.context,s=Or.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,n=s.height,a=s.lines,l=s.lineHeight,h=s.lineWidths,c=s.maxLineWidth,u=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let d,p,f=e.dropShadow?2:1;for(let m=0;m<f;++m){let x=e.dropShadow&&m===0,y=x?Math.ceil(Math.max(1,n)+e.padding*2):0,_=y*this._resolution;if(x){i.fillStyle="black",i.strokeStyle="black";let v=e.dropShadowColor,U=e.dropShadowBlur*this._resolution,V=e.dropShadowDistance*this._resolution;i.shadowColor=tt.shared.setValue(v).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=U,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*V,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*V+_}else i.fillStyle=this._generateFillStyle(e,a,s),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let g=(l-u.fontSize)/2;l-u.fontSize<0&&(g=0);for(let v=0;v<a.length;v++)d=e.strokeThickness/2,p=e.strokeThickness/2+v*l+u.ascent+g,e.align==="right"?d+=c-h[v]:e.align==="center"&&(d+=(c-h[v])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[v],d+e.padding,p+e.padding-y,!0),e.fill&&this.drawLetterSpacing(a[v],d+e.padding,p+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,i,s=!1){let o=this._style.letterSpacing,n=!1;if(Or.experimentalLetterSpacingSupported&&(Or.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,n=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||n){s?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let a=e,l=Or.graphemeSegmenter(t),h=this.context.measureText(t).width,c=0;for(let u=0;u<l.length;++u){let d=l[u];s?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let p="";for(let f=u+1;f<l.length;++f)p+=l[f];c=this.context.measureText(p).width,a+=h-c+o,h=c}}updateTexture(){let t=this.canvas;if(this._style.trim){let n=A.trimCanvas(t);n.data&&(t.width=n.width,t.height=n.height,this.context.putImageData(n.data,0,0))}let e=this._texture,i=this._style,s=i.trim?0:i.padding,o=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){let s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let o,n=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,l=this.canvas.width/this._resolution-n-a*2,h=this.canvas.height/this._resolution-n-a*2,c=s.slice(),u=t.fillGradientStops.slice();if(!u.length){let d=c.length+1;for(let p=1;p<d;++p)u.push(p/d)}if(c.unshift(s[0]),u.unshift(0),c.push(s[s.length-1]),u.push(1),t.fillGradientType===ws.LINEAR_VERTICAL){o=this.context.createLinearGradient(l/2,a,l/2,h+a);let d=i.fontProperties.fontSize+t.strokeThickness;for(let p=0;p<e.length;p++){let f=i.lineHeight*(p-1)+d,m=i.lineHeight*p,x=m;p>0&&f>m&&(x=(m+f)/2);let y=m+d,_=i.lineHeight*(p+1),g=y;p+1<e.length&&_<y&&(g=(y+_)/2);let v=(g-x)/h;for(let U=0;U<c.length;U++){let V=0;typeof u[U]=="number"?V=u[U]:V=U/c.length;let L=Math.min(1,Math.max(0,x/h+V*v));L=Number(L.toFixed(5)),o.addColorStop(L,c[U])}}}else{o=this.context.createLinearGradient(a,h/2,l+a,h/2);let d=c.length+1,p=1;for(let f=0;f<c.length;f++){let m;typeof u[f]=="number"?m=u[f]:m=p/d,o.addColorStop(m,c[f]),p++}}return o}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},P_,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);let e=A.sign(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);let e=A.sign(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof Fa?this._style=t:this._style=new Fa(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};zm.defaultAutoResolution=!0;var J=zm;var yt=class extends I{bg;text;constructor(t,e,i){super(),this.bg=new C(e||b.WHITE),this.bg.anchor.set(.5),this.eventMode="static",this.on("pointerdown",()=>ot.emit("BUTTON_PRESS")),this.text=new J(t,i),this.text.style.align="center",this.text.anchor.set(.5),this.addChild(this.bg),this.addChild(this.text)}};var Ht=class extends I{type;text;constructor(t){super(),this.type=t;let e=new C(b.from("panel-currency")),i=new C(this.getIconTexture(this.type));this.text=new J("0",{fontFamily:F.font,fontSize:42,fill:16777215}),this.text.y=-1,i.position.set(-e.width/2,-3),[e,i,this.text].forEach(s=>{s.anchor.set(.5)}),this.addChild(e),this.addChild(i),this.addChild(this.text)}updateValue(t){this.text.text=t.toString()}getIconTexture(t){switch(t){case"Money":return b.from("icon-money")}}};var Ts=class extends C{constructor(t){super(b.from(t,{scaleMode:Gt.NEAREST})),this.anchor.set(.5,0),this.scale.set(P.width/this.texture.width+4,1)}};var La=class extends I{currentLevel;maxLevel;constructor(t){super(),this.currentLevel=new J(0,{fontFamily:F.font,fontSize:48,fill:t}),this.maxLevel=new J("/10",{fontFamily:F.font,fontSize:36,fill:6452386}),this.currentLevel.anchor.set(1,1),this.maxLevel.anchor.set(0,1),this.maxLevel.y=-2,this.addChild(this.currentLevel),this.addChild(this.maxLevel)}updateLevel(t){this.currentLevel.text=t.toString()}};var M_=10,Ba=class extends I{bg;marks;constructor(t){super(),this.bg=new C(b.from("panel-upgrade")),this.bg.anchor.set(.5),this.addChild(this.bg),this.marks=[];let e=this.bg.getBounds().left+5;for(let i=0;i<M_;i++){let s=new C(b.from("upgrade-mark"));s.anchor.set(.5),s.x=e+s.width/2+i*(s.width+8),this.marks.push(s),this.addChild(s)}this.setLevel(t)}setLevel(t){this.marks.forEach((e,i)=>{e.visible=i<t})}};var Oa=["armor","damage","guns"],ka={armor:{colorName:"blue",colorValue:2916309,basePrice:[50,70,90,110,160,180,230,290,360,550],priceWeight:1},damage:{colorName:"orange",colorValue:16090682,basePrice:[80,120,150,170,250,290,370,460,580,870],priceWeight:1.6},guns:{colorName:"purple",colorValue:10442486,basePrice:[60,90,120,140,190,230,290,360,450,680],priceWeight:1.25}},Dc={total:[0,7800,29200],coefs:[.07,.15,.25,.38,.54,.75,1,1.3,1.7,2.3]},Cs=class r extends I{kind;level;state;bg;label;button;icon;progressBar;maxedText;price;levelCounter;onPress;constructor(t,e,i){super(),this.state="default",this.kind=e,this.level=i;let s=ka[e];this.onPress=new Pe,this.bg=new C(b.from(`box-${s.colorName}`)),this.bg.anchor.set(.5),this.label=new J(this.getUpgradeName(e).toUpperCase(),{fontFamily:F.font,fontSize:40,fill:16777215}),this.label.anchor.set(.5),this.label.y=-205,this.icon=new C(b.from(`icon-${e}`)),this.icon.anchor.set(.5),this.icon.y=-50,this.levelCounter=new La(s.colorValue),this.levelCounter.updateLevel(i),this.progressBar=new Ba(this.level),this.progressBar.y=100,this.button=new yt("",b.from("btn-orange-2")),this.price=new Ht("Money"),this.price.text.style.fontSize=48,this.price.x+=10,this.button.addChild(this.price),this.setupButtonAction(t),this.maxedText=new J(F.getText("Max"),{fontFamily:F.font,fill:16777215,fontSize:54}),this.maxedText.anchor.set(.5),this.button.addChild(this.maxedText),this.maxedText.visible=!1,this.button.y=190,this.setLevel(t,this.level),this.addChild(this.bg),this.addChild(this.label),this.addChild(this.icon),this.addChild(this.levelCounter),this.addChild(this.progressBar),this.addChild(this.button),this.positionElements()}positionElements(){this.levelCounter.position.set(85,45)}getUpgradeName(t){switch(t){case"armor":return F.getText("Armor");case"damage":return F.getText("Main gun");case"guns":return F.getText("Extra guns")}}increaseLevel(t){this.setLevel(t,++this.level)}setLevel(t,e){this.level=e;let i=ka[this.kind].basePrice.length;this.level<i?(this.state=="maxed"&&(this.button.bg.visible=!0,this.state="default",this.button.addChild(this.price),this.maxedText.visible=!1,this.setupButtonAction(t)),this.price.updateValue(r.getPrice(t,this.level,this.kind))):this.state!="maxed"&&(this.button.removeAllListeners(),this.button.removeChild(this.price),this.button.bg.visible=!1,this.maxedText.visible=!0,this.state="maxed"),this.levelCounter.updateLevel(e),this.progressBar.setLevel(e)}setupButtonAction(t){this.button.on("pointerdown",()=>{this.onPress.dispatch({kind:this.kind,price:r.getPrice(t,this.level,this.kind)})})}static getPrice(t,e,i){let s=ka[i];if(t==0)return s.basePrice[e];let o=Dc.total[t],n=Math.round(o*Dc.coefs[e]/100)*100;e>0&&(n-=o*Dc.coefs[e-1]),n=Math.round(n/100)*100;let a=Object.values(ka).map(h=>h.priceWeight).reduce((h,c)=>h+c);return Math.round(n*s.priceWeight/a/10)*10}};function Da(){return new yt(F.getText("Race").toUpperCase(),b.from("btn-orange"),{fontFamily:F.font,fontSize:96,fill:8928518})}var Nc=class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ut.system.add(this.tickerUpdate,this,De.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ut.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}},Qe=new Nc;var mi=class r{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=r.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new H,this.page=new H,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,s,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}};var Je=class extends mi{constructor(){super(...arguments),this.client=new H,this.movement=new H,this.offset=new H,this.global=new H,this.screen=new H}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,s,o,n,a,l,h,c,u,d,p,f,m){throw new Error("Method not implemented.")}};var Zt=class extends Je{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}};var Ge=class extends Je{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}};Ge.DOM_DELTA_PIXEL=0,Ge.DOM_DELTA_LINE=1,Ge.DOM_DELTA_PAGE=2;var R_=2048,F_=new H,Uc=new H,Wo=class{constructor(t){this.dispatch=new A.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,s)=>i.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;let e=this.mappingTable[t.type];if(e)for(let i=0,s=e.length;i<s;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){Qe.pauseUpdate=!0;let i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,F_.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;let i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,o=i.length-1;s<o;s++)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=i.length-2;s>=0;s--)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;let s=Array.isArray(e)?e:[e];for(let o=i.length-1;o>=0;o--)s.forEach(n=>{t.currentTarget=i[o],this.notifyTarget(t,n)})}propagationPath(t){let e=[t];for(let i=0;i<R_&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,s,o,n=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Qe.pauseUpdate=!1),t.interactiveChildren&&t.children){let c=t.children;for(let u=c.length-1;u>=0;u--){let d=c[u],p=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,s,o,n||o(t,i));if(p){if(p.length>0&&!p[p.length-1].parent)continue;let f=t.isInteractive();(p.length>0||f)&&(f&&this._allInteractiveElements.push(t),p.push(t)),this._hitElements.length===0&&(this._hitElements=p),a=!0}}}let l=this._isInteractive(e),h=t.isInteractive();return l&&h&&this._allInteractiveElements.push(t),n||this._hitElements.length>0?null:a?this._hitElements:l&&!o(t,i)&&s(t,i)?h?[t]:[]:null}hitTestRecursive(t,e,i,s,o){if(this._interactivePrune(t)||o(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(Qe.pauseUpdate=!1),t.interactiveChildren&&t.children){let l=t.children;for(let h=l.length-1;h>=0;h--){let c=l[h],u=this.hitTestRecursive(c,this._isInteractive(e)?e:c.eventMode,i,s,o);if(u){if(u.length>0&&!u[u.length-1].parent)continue;let d=t.isInteractive();return(u.length>0||d)&&u.push(t),u}}}let n=this._isInteractive(e),a=t.isInteractive();return n&&s(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,Uc),!t.hitArea.contains(Uc.x,Uc.y)))return!0;if(t._mask){let i=t._mask.isMaskData?t._mask.maskObject:t._mask;if(i&&!i.containsPoint?.(e))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){e=e??t.type;let i=`on${e}`;t.currentTarget[i]?.(t);let s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){let s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}let i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;let i=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),o=this.findMountedTarget(s.overTargets);if(s.overTargets?.length>0&&o!==e.target){let l=t.type==="mousemove"?"mouseout":"pointerout",h=this.createPointerEvent(t,l,o);if(this.dispatchEvent(h,"pointerout"),i&&this.dispatchEvent(h,"mouseout"),!e.composedPath().includes(o)){let c=this.createPointerEvent(t,"pointerleave",o);for(c.eventPhase=c.AT_TARGET;c.target&&!e.composedPath().includes(c.target);)c.currentTarget=c.target,this.notifyTarget(c),i&&this.notifyTarget(c,"mouseleave"),c.target=c.target.parent;this.freeEvent(c)}this.freeEvent(h)}if(o!==e.target){let l=t.type==="mousemove"?"mouseover":"pointerover",h=this.clonePointerEvent(e,l);this.dispatchEvent(h,"pointerover"),i&&this.dispatchEvent(h,"mouseover");let c=o?.parent;for(;c&&c!==this.rootTarget.parent&&c!==e.target;)c=c.parent;if(!c||c===this.rootTarget.parent){let u=this.clonePointerEvent(e,"pointerenter");for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==o&&u.target!==this.rootTarget.parent;)u.currentTarget=u.target,this.notifyTarget(u),i&&this.notifyTarget(u,"mouseenter"),u.target=u.target.parent;this.freeEvent(u)}this.freeEvent(h)}let n=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?n.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&n.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?n.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&n.push("globaltouchmove")),i&&(this.moveOnAll?n.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&n.push("globalmousemove"),this.cursor=e.target?.cursor),n.length>0&&this.all(e,n),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),s=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=i.target?.cursor);let o=this.clonePointerEvent(i,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),s&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let e=this.trackingData(t.pointerId);if(e.overTargets){let i=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),o=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(o),i&&this.dispatchEvent(o,"mouseout");let n=this.createPointerEvent(t,"pointerleave",s);for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseleave"),n.target=n.target.parent;e.overTargets=null,this.freeEvent(o),this.freeEvent(n)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}let s=this.trackingData(t.pointerId),o=this.findMountedTarget(s.pressTargetsByButton[t.button]),n=o;if(o&&!i.composedPath().includes(o)){let a=o;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){let l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete s.pressTargetsByButton[t.button],n=a}if(n){let a=this.clonePointerEvent(i,"click");a.target=n,a.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});let l=s.clicksByButton[t.button];if(l.target===a.target&&e-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=e,a.detail=l.clickCount,a.pointerType==="mouse"){let h=a.button===2;this.dispatchEvent(a,h?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof Zt)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(i){let o=i;for(;o;)s.currentTarget=o,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof Ge)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){let s=this.allocateEvent(Zt);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof e=="string"&&(s.type=e),s}createWheelEvent(t){let e=this.allocateEvent(Ge);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){let i=this.allocateEvent(Zt);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Zt&&e instanceof Zt&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Je&&e instanceof Je&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);let e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");let e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){let i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let s=0,o=i.length;s<o&&!t.propagationImmediatelyStopped;s++)i[s].once&&t.currentTarget.removeListener(e,i[s].fn,void 0,!0),i[s].fn.call(i[s].context,t)}};var L_=1,B_={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Gc=class zc{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new Wo(null),Qe.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Zt(null),this.rootWheelEvent=new Ge(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...zc.defaultEventFeatures},{set:(e,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){let{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,zc._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;let i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,s=e.length;i<s;i++){let o=e[i],n=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Qe.pointerMoved();let e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){let o=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);let i=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let o=0,n=s.length;o<n;o++){let a=this.bootstrapEvent(this.rootPointerEvent,s[o]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){let o=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;let e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,Qe.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;Qe.addTickerListener();let t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;Qe.removeTickerListener();let t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){let s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},o=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*o,t.y=(i-s.top)*(this.domElement.height/s.height)*o}normalizeToPointerData(t){let e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,s=t.changedTouches.length;i<s;i++){let o=t.changedTouches[i];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,e.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){let i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=L_),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){let e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=B_[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Gc.extension={name:"events",type:[w.RendererSystem,w.CanvasRendererSystem]},Gc.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};var Yo=Gc;T.add(Yo);function jm(r){return r==="dynamic"||r==="static"}var Vm={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??jm(Yo.defaultEventMode)},set interactive(r){A.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??Yo.defaultEventMode},set eventMode(r){this._internalInteractive=jm(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,t,e){let i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.on(r,t,s)},removeEventListener(r,t,e){let i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.off(r,t,s)},dispatchEvent(r){if(!(r instanceof mi))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};Ke.mixin(Vm);var qo={carSkins:["Player-Car-1","Player-Car-2","Player-Car-3"],carPrices:[0,1e4,3e4]},Na=class extends I{game;progress;bg;bottomShadow;playerCar;selectedCarId;btnBack;moneyCounter;btnNextCar;btnPrevCar;btnSelectCar;upgrades;btnPurchaseCar;carPurchasePrice;btnStartRace;constructor(t,e){super(),this.game=t,this.progress=e,this.bg=new C(b.from("garage")),this.bg.scale.set(P.height/this.bg.height),this.bg.anchor.x=.5,this.bg.x=P.width/2,this.bottomShadow=new Ts("shadow-blue"),this.selectedCarId=e.data.selectedCar,this.playerCar=new _s(this.selectedCarId,this.progress.getCarUpgrades(this.selectedCarId)),this.playerCar.scale.set(2),this.btnBack=new yt("",b.from("btn-back")),this.btnBack.on("pointerdown",()=>{this.progress.data.cars.find(i=>i.id==this.selectedCarId)?.unlocked&&(this.progress.data.selectedCar=this.selectedCarId,this.progress.saveLocal()),this.game.audio.playSound("ui_menu_whoosh"),ot.emit("START_MENU")}),this.moneyCounter=new Ht("Money"),this.moneyCounter.updateValue(e.data.money),this.btnPrevCar=new yt("",b.from("btn-arrow")),this.btnPrevCar.scale.x=-1,this.btnPrevCar.on("pointerdown",()=>{this.selectedCarId>0&&(this.selectedCarId--,this.game.audio.playSound("ui_menu_whoosh"),this.reloadPlayerCar(this.selectedCarId),this.updateGarageUI(this.selectedCarId))}),this.btnNextCar=new yt("",b.from("btn-arrow")),this.btnNextCar.on("pointerdown",()=>{this.selectedCarId<qo.carSkins.length-1&&(this.selectedCarId++,this.game.audio.playSound("ui_menu_whoosh"),this.reloadPlayerCar(this.selectedCarId),this.updateGarageUI(this.selectedCarId))}),this.btnSelectCar=new yt("Select",b.from("btn-green"),{fontFamily:F.font,fill:16777215,fontSize:48}),this.btnSelectCar.on("pointerdown",()=>{this.progress.data.selectedCar=this.selectedCarId,this.progress.saveLocal()}),this.upgrades=new I,this.addUpgradeButtons(),this.btnPurchaseCar=new yt("",b.from("btn-orange"),{fontFamily:F.font,fill:16777215,fontSize:48}),this.carPurchasePrice=new Ht("Money"),this.carPurchasePrice.scale.set(1.5),this.carPurchasePrice.updateValue(qo.carPrices[this.selectedCarId]),this.btnPurchaseCar.addChild(this.carPurchasePrice),this.carPurchasePrice.x=10,this.btnPurchaseCar.on("pointerdown",()=>{let i=qo.carPrices[this.selectedCarId];i<=this.progress.data.money&&(this.progress.data.cars[this.selectedCarId].unlocked=!0,this.progress.data.money-=i,this.moneyCounter.updateValue(this.progress.data.money),this.progress.saveLocal(),this.updateGarageUI(this.selectedCarId))}),this.btnStartRace=Da(),this.btnStartRace.on("pointerdown",()=>{ot.emit("START_RACE")}),this.updateGarageUI(this.selectedCarId),this.addChild(this.bg),this.addChild(this.bottomShadow),this.addChild(this.btnBack),this.addChild(this.moneyCounter),this.addChild(this.playerCar),this.addChild(this.btnPrevCar),this.addChild(this.btnNextCar),this.addChild(this.upgrades),this.addChild(this.btnPurchaseCar),this.positionElements()}positionElements(){this.bottomShadow.position.set(P.width/2,P.height-this.bottomShadow.height),this.moneyCounter.position.set(P.width/2+400,80),this.playerCar.position.set(P.width/2,this.height/2-200),this.btnPrevCar.position.set(P.width/2-380,this.playerCar.y),this.btnNextCar.position.set(P.width/2+380,this.playerCar.y),this.btnBack.position.set(100,80),this.btnStartRace.position.set(P.width/2,this.height-this.btnSelectCar.height),this.btnSelectCar.position.set(P.width/2,this.btnStartRace.y-this.btnStartRace.height),this.btnPurchaseCar.position.set(P.width/2,this.playerCar.y+800),this.upgrades.position.set(P.width/2,this.playerCar.y+700)}reloadPlayerCar(t){this.playerCar.body.texture=b.from(qo.carSkins[t])}addUpgradeButtons(){[...Oa].forEach((t,e)=>{let i=new Cs(this.selectedCarId,t,this.progress.getCarUpgrade(t,this.selectedCarId));i.onPress.add(s=>{(s.price<this.progress.data.money||It.freeUpgrades)&&(this.game.audio.playSound("upgrade_3"),this.progress.upgradeCar(this.selectedCarId,s.kind),this.progress.data.money-=It.freeUpgrades?0:s.price,this.progress.saveLocal(),this.moneyCounter.updateValue(this.progress.data.money),i.increaseLevel(this.selectedCarId),s.kind=="guns"&&(this.playerCar.leftGun.upgrade(this.progress.getCarUpgrade("guns",this.selectedCarId)),this.playerCar.rightGun.upgrade(this.progress.getCarUpgrade("guns",this.selectedCarId))),s.kind=="damage"&&this.playerCar.mainGun.upgrade(this.progress.getCarUpgrade("damage",this.selectedCarId)))}),i.position.x=(e-1)*320,this.upgrades.addChild(i)})}updateGarageUI(t){let e=this.progress.data.cars[t].unlocked;this.upgrades.visible=e,this.btnPurchaseCar.visible=!e,this.playerCar.mainGun.upgrade(this.progress.getCarUpgrade("damage",this.selectedCarId)),this.playerCar.leftGun.upgrade(this.progress.getCarUpgrade("guns",this.selectedCarId)),this.playerCar.rightGun.upgrade(this.progress.getCarUpgrade("guns",this.selectedCarId)),e?this.upgrades.children.forEach(i=>{i.setLevel(t,this.progress.getCarUpgrade(i.kind,t))}):this.carPurchasePrice.updateValue(qo.carPrices[t])}};var jc={evenRowColor:1323346,oddRowColor:1787253,playerRowColor:16774656},Ua=class extends I{bg;rankText;nameText;repIcon;repCountText;formatter;constructor(t){super(),this.bg=new C(b.from("panel-lb-entry")),this.bg.tint=this.getColor(t,!1),this.formatter=Intl.NumberFormat("en",{notation:"compact"});let e={fontFamily:F.font,fill:16777215,fontSize:54};this.rankText=new J(t.toString(),e),this.nameText=new J("",e),this.repIcon=new C(b.from("icon-rep")),this.repCountText=new J("",e),this.bg.anchor.set(.5),this.rankText.anchor.set(.5,.5),this.nameText.anchor.set(0,.5),this.repIcon.anchor.set(.5,.5),this.repCountText.anchor.set(0,.5);let i=this.bg.getBounds().left,s=this.bg.getBounds().right;this.rankText.x=i+70,this.nameText.x=i+150,this.repCountText.x=s-200,this.repIcon.x=this.repCountText.x-80,this.addChild(this.bg),this.addChild(this.rankText),this.addChild(this.nameText),this.addChild(this.repIcon),this.addChild(this.repCountText)}fillData(t,e,i,s=!1){this.bg.tint=this.getColor(t,s),this.rankText.text=t.toString(),this.rankText.style.fill=s?65793:16777215,this.nameText.text=e.toString(),this.nameText.style.fill=s?65793:16777215,this.repCountText.text=this.formatter.format(i),this.repCountText.style.fill=s?65793:16777215}getColor(t,e){return e?jc.playerRowColor:t%2==1?jc.oddRowColor:jc.evenRowColor}};var Ga=class extends I{bg;rankLabel;nameLabel;repLabel;constructor(){super(),this.bg=new C(b.from("panel-lb-entry")),this.bg.scale.y=.8,this.bg.tint=926265;let t={fontFamily:F.font,fill:16777215,fontSize:40};this.rankLabel=new J(F.getText("Rank").toUpperCase(),t),this.nameLabel=new J(F.getText("Name").toUpperCase(),t),this.repLabel=new J(F.getText("Rep").toUpperCase(),t),this.bg.anchor.set(.5),this.rankLabel.anchor.set(.5,.5),this.nameLabel.anchor.set(0,.5),this.repLabel.anchor.set(0,.5);let e=this.bg.getBounds().left,i=this.bg.getBounds().right;this.rankLabel.x=e+70,this.nameLabel.x=e+150,this.repLabel.x=i-200,this.addChild(this.bg),this.addChild(this.rankLabel),this.addChild(this.nameLabel),this.addChild(this.repLabel)}};var tr={name:"Reputation",rows:5,maxNameLength:15};var za=class extends I{header;entries;constructor(){super(),this.header=new Ga,this.addChild(this.header),this.createEntries()}createEntries(){this.entries=[];for(let t=0;t<tr.rows;t++){let e=new Ua(t+1);e.y=this.header.getBounds().bottom+e.height/2+e.height*t,this.entries.push(e),this.addChild(e),e.visible=!1}}displayEntries(t,e){let i=e-1>4?4:e-1;for(let s=0;s<Math.min(tr.rows,t.length);s++){let o=s==i,n=o?e:s+1;this.entries[s].fillData(n,this.formatDisplayName(t[s].player.publicName),t[s].score,o),this.entries[s].visible=!0}}formatDisplayName(t){let e=0,i="";for(let s of t.split(" ")){if(e+=s.length+1,e>tr.maxNameLength)return i+=" "+s.substring(0,1)+".",i;i+=" "+s}return i}};var Hm=["MoneyBill","MoneyStack","Health","Magnet","MoneyX2"],Va={MoneyBill:{textureKey:"MoneyBill"},MoneyStack:{textureKey:"MoneyStack"},Health:{textureKey:"Heal"},Magnet:{textureKey:"Magnet",durationMS:5e3},MoneyX2:{textureKey:"X2",durationMS:3e3}},er={maxVerticalVelocity:2,maxHorizVelocity:.6,spinVelocity:.1,gravity:.005,magnetPower:2},ja=class extends C{kind;velocity;constructor(t){super(),this.velocity=new H,this.anchor.set(.5),this.reset(t)}reset(t){this.kind=t,this.texture=b.from(Va[t].textureKey),this.velocity.set(Math.random()*er.maxHorizVelocity*2-er.maxHorizVelocity,-Math.random()*.5)}applyGravity(t){this.velocity.y=Math.min(er.maxVerticalVelocity,this.velocity.y+er.gravity*t)}applyMagnet(t,e){let i=t.x-this.x,s=t.y-this.y,o=i*i+s*s,n=er.magnetPower/Math.sqrt(o);Math.abs(i)>50?this.velocity.x+=n*Math.sign(i)*e:this.velocity.x*=.95,this.velocity.x<-er.maxHorizVelocity&&(this.velocity.x=-er.maxHorizVelocity),this.velocity.x>er.maxHorizVelocity&&(this.velocity.x=er.maxHorizVelocity)}move(t){this.y+=this.velocity.y*t,this.x+=this.velocity.x*t}spin(t){this.angle+=er.spinVelocity*t*Math.sign(this.velocity.x)}bounceOffRoadBorders(t,e){e.left<t.left&&(this.velocity.x=-this.velocity.x,this.x+=t.left-e.left),e.right>t.right&&(this.velocity.x=-this.velocity.x,this.x-=e.right-t.right)}};function Ut(r,t){let e=t.reduce((s,o)=>s+o),i=Math.floor(Math.random()*e);for(let s=0;s<t.length;s++){if(i-t[s]<0)return r[s];i-=t[s]}}var Ha=class r{static recentChoice=0;pickups=new Nt(()=>{let t=Ut(["Health","Magnet","MoneyX2"],[1,1,1]);return new ja(t)},t=>{let e=r.getNextKind([...Hm]);t.reset(e)},t=>{t.destroy()});constructor(){}getFromEnemy(t){let e=this.pickups.getInstance();if(t.extraLoot&&Math.random()<t.extraLoot.chance){let i=Ut(t.extraLoot.drop,Array(t.extraLoot.drop.length).fill(1));return e.reset(i),e}if(t.regularLoot){let i=Ut(Object.keys(t.regularLoot),Object.values(t.regularLoot));return e.reset(i),e}}static getNextKind(t){return t[r.recentChoice++%t.length]}};var $a=class{target;_active=!1;initialTargetCoord;initialPointerCoord;leftBound;rightBound;factor=.02;constructor(t){this.target=t}start(t){this.initialPointerCoord=t.x,this.initialTargetCoord=this.target.roadX,this._active=!0}stop(){this._active=!1}update(t){if(!this.active)return;let e=t.x-this.initialPointerCoord,i=this.initialTargetCoord+e*this.factor;this.target.roadX=Math.min(this.rightBound,Math.max(this.leftBound,i))}setBounds(t,e){this.leftBound=t,this.rightBound=e}get active(){return this._active}};var Ss=class extends I{bgSprite;fillSprite;constructor(){super(),this.reset()}reset(){this.removeChildren(),this.bgSprite=new C(b.from("enemy-progress-bar-back")),this.bgSprite.anchor.set(.5),this.fillSprite=new C(b.from("enemy-progress-bar-full")),this.fillSprite.anchor.set(.5);let t=new C(b.from("enemy-progress-bar-mask"));t.anchor.set(.5),this.fillSprite.mask=t,this.addChild(this.bgSprite),this.addChild(this.fillSprite),this.addChild(t),this.scale.set(.5),this.updateValue(1)}updateValue(t){this.fillSprite.x=-this.fillSprite.width*(1-t)}};var yr={minDamage:10,maxDamage:45,minRadius:300,maxRadius:800},Xa=["regular","fuel","taxi","hpvan","moneyvan","mystery"],Ko={regular:{gfx:"Enemy-Car",hp:60,rep:1,regularLoot:{MoneyBill:.8,MoneyStack:.2},extraLoot:{chance:.05,drop:["Health","Magnet","MoneyX2"]}},fuel:{gfx:"Gas-Car",hp:90,rep:5,regularLoot:{MoneyBill:.6,MoneyStack:.4},extraLoot:{chance:.1,drop:["Health","Magnet","MoneyX2"]}},taxi:{gfx:"Taxi-Car",hp:120,rep:5,regularLoot:{MoneyBill:.6,MoneyStack:.4},extraLoot:{chance:.1,drop:["Health","Magnet","MoneyX2"]}},hpvan:{gfx:"Heal-Car",hp:120,rep:5,extraLoot:{chance:1,drop:["Health"]}},moneyvan:{gfx:"Money-Car",hp:120,rep:5,extraLoot:{chance:1,drop:["MoneyStack"]}},mystery:{gfx:"Mystery-Car",hp:480,rep:5,extraLoot:{chance:1,drop:["Health","Magnet","MoneyX2"]}}},Es=class extends Br{kind;dead;maxHealth;healthBar;constructor(){super(),this.healthBar=new Ss,this.addChild(this.healthBar)}takeDamage(t){super.takeDamage(t),this.health-=t,this.healthBar.visible=!0,this.healthBar.updateValue(this.health/this.maxHealth)}static getFuelExplosionDamage(t){return Math.min(yr.maxDamage,yr.minDamage+(yr.maxRadius-t)/(yr.maxRadius-yr.minRadius)*(yr.maxDamage-yr.minDamage))}};function rr(r,t){return r=Math.ceil(r),t=Math.floor(t),Math.floor(Math.random()*(t-r+1))+r}var k_={spawnPeriodMS:1e3},As=class r{static lastid=0;config;lastSpawnedMS;cars=new Nt(()=>new Es,t=>{t.dead=!1,t.healthBar.visible=!1},t=>{t.destroy({children:!0})});onSpawn=new Pe;constructor(t){this.config=Object.assign({},k_,t||{}),this.lastSpawnedMS=0}spawn(){this.onSpawn.dispatch()}update(t){this.lastSpawnedMS+=t,this.lastSpawnedMS>this.config.spawnPeriodMS&&(this.lastSpawnedMS-=this.config.spawnPeriodMS,this.spawn())}resetTimer(t){this.lastSpawnedMS=this.config.spawnPeriodMS-t}static randomizeCar(t){let e=Ut([...Xa],[0,1,0,0,0]);r.changeCarKind(t,e)}static changeCarKind(t,e){let i=Ko[e];t.kind=e,t.body.texture=b.from(i.gfx),t.maxHealth=i.hp,t.health=i.hp,t.healthBar.y=t.body.height/2+t.healthBar.height/2+10,t.healthBar.updateValue(1)}static loadNextCar(t){let e=Xa[r.lastid++%Xa.length];t.kind=e,this.changeCarKind(t,e)}};var gi={build(r){let t=r.points,e,i,s,o,n,a;if(r.type===ct.CIRC){let f=r.shape;e=f.x,i=f.y,n=a=f.radius,s=o=0}else if(r.type===ct.ELIP){let f=r.shape;e=f.x,i=f.y,n=f.width,a=f.height,s=o=0}else{let f=r.shape,m=f.width/2,x=f.height/2;e=f.x+m,i=f.y+x,n=a=Math.max(0,Math.min(f.radius,Math.min(m,x))),s=m-n,o=x-a}if(!(n>=0&&a>=0&&s>=0&&o>=0)){t.length=0;return}let l=Math.ceil(2.3*Math.sqrt(n+a)),h=l*8+(s?4:0)+(o?4:0);if(t.length=h,h===0)return;if(l===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=i+o,t[2]=t[4]=e-s,t[5]=t[7]=i-o;return}let c=0,u=l*4+(s?2:0)+2,d=u,p=h;{let f=s+n,m=o,x=e+f,y=e-f,_=i+m;if(t[c++]=x,t[c++]=_,t[--u]=_,t[--u]=y,o){let g=i-m;t[d++]=y,t[d++]=g,t[--p]=g,t[--p]=x}}for(let f=1;f<l;f++){let m=Math.PI/2*(f/l),x=s+Math.cos(m)*n,y=o+Math.sin(m)*a,_=e+x,g=e-x,v=i+y,U=i-y;t[c++]=_,t[c++]=v,t[--u]=v,t[--u]=g,t[d++]=g,t[d++]=U,t[--p]=U,t[--p]=_}{let f=s,m=o+a,x=e+f,y=e-f,_=i+m,g=i-m;t[c++]=x,t[c++]=_,t[--p]=g,t[--p]=x,s&&(t[c++]=y,t[c++]=_,t[--p]=g,t[--p]=y)}},triangulate(r,t){let e=r.points,i=t.points,s=t.indices;if(e.length===0)return;let o=i.length/2,n=o,a,l;if(r.type!==ct.RREC){let c=r.shape;a=c.x,l=c.y}else{let c=r.shape;a=c.x+c.width/2,l=c.y+c.height/2}let h=r.matrix;i.push(r.matrix?h.a*a+h.c*l+h.tx:a,r.matrix?h.b*a+h.d*l+h.ty:l),o++,i.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)i.push(e[c],e[c+1]),s.push(o++,n,o);s.push(n+1,n,o)}};function $m(r,t=!1){let e=r.length;if(e<6)return;let i=0;for(let s=0,o=r[e-2],n=r[e-1];s<e;s+=2){let a=r[s],l=r[s+1];i+=(a-o)*(l+n),o=a,n=l}if(!t&&i>0||t&&i<=0){let s=e/2;for(let o=s+s%2;o<e;o+=2){let n=e-o-2,a=e-o-1,l=o,h=o+1;[r[n],r[l]]=[r[l],r[n]],[r[a],r[h]]=[r[h],r[a]]}}}var Zo={build(r){r.points=r.shape.points.slice()},triangulate(r,t){let e=r.points,i=r.holes,s=t.points,o=t.indices;if(e.length>=6){$m(e,!1);let n=[];for(let h=0;h<i.length;h++){let c=i[h];$m(c.points,!0),n.push(e.length/2),e=e.concat(c.points)}let a=A.earcut(e,n,2);if(!a)return;let l=s.length/2;for(let h=0;h<a.length;h+=3)o.push(a[h]+l),o.push(a[h+1]+l),o.push(a[h+2]+l);for(let h=0;h<e.length;h++)s.push(e[h])}}};var Vc={build(r){let t=r.shape,e=t.x,i=t.y,s=t.width,o=t.height,n=r.points;n.length=0,s>=0&&o>=0&&n.push(e,i,e+s,i,e+s,i+o,e,i+o)},triangulate(r,t){let e=r.points,i=t.points;if(e.length===0)return;let s=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};var Hc={build(r){gi.build(r)},triangulate(r,t){gi.triangulate(r,t)}};var Qt=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(Qt||{}),Me=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Me||{}),Re={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,t=20){if(!this.adaptive||!r||isNaN(r))return t;let e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};var yi=class{static curveTo(t,e,i,s,o,n){let a=n[n.length-2],l=n[n.length-1]-e,h=a-t,c=s-e,u=i-t,d=Math.abs(l*u-h*c);if(d<1e-8||o===0)return(n[n.length-2]!==t||n[n.length-1]!==e)&&n.push(t,e),null;let p=l*l+h*h,f=c*c+u*u,m=l*c+h*u,x=o*Math.sqrt(p)/d,y=o*Math.sqrt(f)/d,_=x*m/p,g=y*m/f,v=x*u+y*h,U=x*c+y*l,V=h*(y+_),L=l*(y+_),k=u*(x+g),X=c*(x+g),Z=Math.atan2(L-U,V-v),lt=Math.atan2(X-U,k-v);return{cx:v+t,cy:U+e,radius:o,startAngle:Z,endAngle:lt,anticlockwise:h*c>u*l}}static arc(t,e,i,s,o,n,a,l,h){let c=a-n,u=Re._segmentsCount(Math.abs(c)*o,Math.ceil(Math.abs(c)/Ar)*40),d=c/(u*2),p=d*2,f=Math.cos(d),m=Math.sin(d),x=u-1,y=x%1/x;for(let _=0;_<=x;++_){let g=_+y*_,v=d+n+p*g,U=Math.cos(v),V=-Math.sin(v);h.push((f*U+m*V)*o+i,(f*-V+m*U)*o+s)}}};var Is=class{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}};var Ps=class r{static curveLength(t,e,i,s,o,n,a,l){let h=0,c=0,u=0,d=0,p=0,f=0,m=0,x=0,y=0,_=0,g=0,v=t,U=e;for(let V=1;V<=10;++V)c=V/10,u=c*c,d=u*c,p=1-c,f=p*p,m=f*p,x=m*t+3*f*c*i+3*p*u*o+d*a,y=m*e+3*f*c*s+3*p*u*n+d*l,_=v-x,g=U-y,v=x,U=y,h+=Math.sqrt(_*_+g*g);return h}static curveTo(t,e,i,s,o,n,a){let l=a[a.length-2],h=a[a.length-1];a.length-=2;let c=Re._segmentsCount(r.curveLength(l,h,t,e,i,s,o,n)),u=0,d=0,p=0,f=0,m=0;a.push(l,h);for(let x=1,y=0;x<=c;++x)y=x/c,u=1-y,d=u*u,p=d*u,f=y*y,m=f*y,a.push(p*l+3*d*y*t+3*u*f*i+m*o,p*h+3*d*y*e+3*u*f*s+m*n)}};function Xm(r,t,e,i,s,o,n,a){let l=r-e*s,h=t-i*s,c=r+e*o,u=t+i*o,d,p;n?(d=i,p=-e):(d=-i,p=e);let f=l+d,m=h+p,x=c+d,y=u+p;return a.push(f,m,x,y),2}function xi(r,t,e,i,s,o,n,a){let l=e-r,h=i-t,c=Math.atan2(l,h),u=Math.atan2(s-r,o-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c,p=u-c,f=Math.abs(p),m=Math.sqrt(l*l+h*h),x=(15*f*Math.sqrt(m)/Math.PI>>0)+1,y=p/x;if(d+=y,a){n.push(r,t,e,i);for(let _=1,g=d;_<x;_++,g+=y)n.push(r,t,r+Math.sin(g)*m,t+Math.cos(g)*m);n.push(r,t,s,o)}else{n.push(e,i,r,t);for(let _=1,g=d;_<x;_++,g+=y)n.push(r+Math.sin(g)*m,t+Math.cos(g)*m,r,t);n.push(s,o,r,t)}return x*2}function O_(r,t){let e=r.shape,i=r.points||e.points.slice(),s=t.closePointEps;if(i.length===0)return;let o=r.lineStyle,n=new H(i[0],i[1]),a=new H(i[i.length-2],i[i.length-1]),l=e.type!==ct.POLY||e.closeStroke,h=Math.abs(n.x-a.x)<s&&Math.abs(n.y-a.y)<s;if(l){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));let R=(n.x+a.x)*.5,E=(a.y+n.y)*.5;i.unshift(R,E),i.push(R,E)}let c=t.points,u=i.length/2,d=i.length,p=c.length/2,f=o.width/2,m=f*f,x=o.miterLimit*o.miterLimit,y=i[0],_=i[1],g=i[2],v=i[3],U=0,V=0,L=-(_-v),k=y-g,X=0,Z=0,lt=Math.sqrt(L*L+k*k);L/=lt,k/=lt,L*=f,k*=f;let Tt=o.alignment,G=(1-Tt)*2,O=Tt*2;l||(o.cap===Me.ROUND?d+=xi(y-L*(G-O)*.5,_-k*(G-O)*.5,y-L*G,_-k*G,y+L*O,_+k*O,c,!0)+2:o.cap===Me.SQUARE&&(d+=Xm(y,_,L,k,G,O,!0,c))),c.push(y-L*G,_-k*G,y+L*O,_+k*O);for(let R=1;R<u-1;++R){y=i[(R-1)*2],_=i[(R-1)*2+1],g=i[R*2],v=i[R*2+1],U=i[(R+1)*2],V=i[(R+1)*2+1],L=-(_-v),k=y-g,lt=Math.sqrt(L*L+k*k),L/=lt,k/=lt,L*=f,k*=f,X=-(v-V),Z=g-U,lt=Math.sqrt(X*X+Z*Z),X/=lt,Z/=lt,X*=f,Z*=f;let E=g-y,D=_-v,q=g-U,rt=V-v,gt=E*q+D*rt,St=D*q-rt*E,xt=St<0;if(Math.abs(St)<.001*Math.abs(gt)){c.push(g-L*G,v-k*G,g+L*O,v+k*O),gt>=0&&(o.join===Qt.ROUND?d+=xi(g,v,g-L*G,v-k*G,g-X*G,v-Z*G,c,!1)+4:d+=2,c.push(g-X*O,v-Z*O,g+X*G,v+Z*G));continue}let Xt=(-L+y)*(-k+v)-(-L+g)*(-k+_),ae=(-X+U)*(-Z+v)-(-X+g)*(-Z+V),te=(E*ae-q*Xt)/St,le=(rt*Xt-D*ae)/St,Pt=(te-g)*(te-g)+(le-v)*(le-v),Et=g+(te-g)*G,Mt=v+(le-v)*G,Wt=g-(te-g)*O,ee=v-(le-v)*O,Us=Math.min(E*E+D*D,q*q+rt*rt),Vu=xt?G:O,ly=Us+Vu*Vu*m,hy=Pt<=ly,fn=o.join;if(fn===Qt.MITER&&Pt/m>x&&(fn=Qt.BEVEL),hy)switch(fn){case Qt.MITER:{c.push(Et,Mt,Wt,ee);break}case Qt.BEVEL:{xt?c.push(Et,Mt,g+L*O,v+k*O,Et,Mt,g+X*O,v+Z*O):c.push(g-L*G,v-k*G,Wt,ee,g-X*G,v-Z*G,Wt,ee),d+=2;break}case Qt.ROUND:{xt?(c.push(Et,Mt,g+L*O,v+k*O),d+=xi(g,v,g+L*O,v+k*O,g+X*O,v+Z*O,c,!0)+4,c.push(Et,Mt,g+X*O,v+Z*O)):(c.push(g-L*G,v-k*G,Wt,ee),d+=xi(g,v,g-L*G,v-k*G,g-X*G,v-Z*G,c,!1)+4,c.push(g-X*G,v-Z*G,Wt,ee));break}}else{switch(c.push(g-L*G,v-k*G,g+L*O,v+k*O),fn){case Qt.MITER:{xt?c.push(Wt,ee,Wt,ee):c.push(Et,Mt,Et,Mt),d+=2;break}case Qt.ROUND:{xt?d+=xi(g,v,g+L*O,v+k*O,g+X*O,v+Z*O,c,!0)+2:d+=xi(g,v,g-L*G,v-k*G,g-X*G,v-Z*G,c,!1)+2;break}}c.push(g-X*G,v-Z*G,g+X*O,v+Z*O),d+=2}}y=i[(u-2)*2],_=i[(u-2)*2+1],g=i[(u-1)*2],v=i[(u-1)*2+1],L=-(_-v),k=y-g,lt=Math.sqrt(L*L+k*k),L/=lt,k/=lt,L*=f,k*=f,c.push(g-L*G,v-k*G,g+L*O,v+k*O),l||(o.cap===Me.ROUND?d+=xi(g-L*(G-O)*.5,v-k*(G-O)*.5,g-L*G,v-k*G,g+L*O,v+k*O,c,!1)+2:o.cap===Me.SQUARE&&(d+=Xm(g,v,L,k,G,O,!1,c)));let bt=t.indices,Ft=Re.epsilon*Re.epsilon;for(let R=p;R<d+p-2;++R)y=c[R*2],_=c[R*2+1],g=c[(R+1)*2],v=c[(R+1)*2+1],U=c[(R+2)*2],V=c[(R+2)*2+1],!(Math.abs(y*(v-V)+g*(V-_)+U*(_-v))<Ft)&&bt.push(R,R+1,R+2)}function D_(r,t){let e=0,i=r.shape,s=r.points||i.points,o=i.type!==ct.POLY||i.closeStroke;if(s.length===0)return;let n=t.points,a=t.indices,l=s.length/2,h=n.length/2,c=h;for(n.push(s[0],s[1]),e=1;e<l;e++)n.push(s[e*2],s[e*2+1]),a.push(c,c+1),c++;o&&a.push(c,h)}function Qo(r,t){r.lineStyle.native?D_(r,t):O_(r,t)}var Ms=class r{static curveLength(t,e,i,s,o,n){let a=t-2*i+o,l=e-2*s+n,h=2*i-2*t,c=2*s-2*e,u=4*(a*a+l*l),d=4*(a*h+l*c),p=h*h+c*c,f=2*Math.sqrt(u+d+p),m=Math.sqrt(u),x=2*u*m,y=2*Math.sqrt(p),_=d/m;return(x*f+m*d*(f-y)+(4*p*u-d*d)*Math.log((2*m+_+f)/(_+y)))/(4*x)}static curveTo(t,e,i,s,o){let n=o[o.length-2],a=o[o.length-1],l=Re._segmentsCount(r.curveLength(n,a,t,e,i,s)),h=0,c=0;for(let u=1;u<=l;++u){let d=u/l;h=n+(t-n)*d,c=a+(e-a)*d,o.push(h+(t+(i-t)*d-h)*d,c+(e+(s-e)*d-c)*d)}}};var Jo={[ct.POLY]:Zo,[ct.CIRC]:gi,[ct.ELIP]:gi,[ct.RECT]:Vc,[ct.RREC]:Hc},Wa=[],Rs=[];var Fs=class r{constructor(t,e=null,i=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new r(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}};var Ls=new H,Wm=class Ym extends qr{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new qe,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Rs.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){let e=this.batches[t];e.reset(),Wa.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,s=null){let o=new Fs(t,e,i,s);return this.graphicsData.push(o),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;let i=new Fs(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){let e=this.graphicsData;for(let i=0;i<e.length;++i){let s=e[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Ls):Ls.copyFrom(t),s.shape.contains(Ls.x,Ls.y))){let o=!1;if(s.holes){for(let n=0;n<s.holes.length;n++)if(s.holes[n].shape.contains(Ls.x,Ls.y)){o=!0;break}}if(!o)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let t=this.uvs,e=this.graphicsData,i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let l=this.shapeIndex;l<e.length;l++){this.shapeIndex++;let h=e[l],c=h.fillStyle,u=h.lineStyle;Jo[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(c.visible||u.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){let p=d===0?c:u;if(!p.visible)continue;let f=p.texture.baseTexture,m=this.indices.length,x=this.points.length/2;f.wrapMode=vr.REPEAT,d===0?this.processFill(h):this.processLine(h);let y=this.points.length/2-x;y!==0&&(i&&!this._compareStyles(s,p)&&(i.end(m,x),i=null),i||(i=Wa.pop()||new Is,i.begin(p,m,x),this.batches.push(i),s=p),this.addUvs(this.points,t,p.texture,x,y,p.matrix))}}let o=this.indices.length,n=this.points.length/2;if(i&&i.end(o,n),this.batches.length===0){this.batchable=!0;return}let a=n>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){let i=this.graphicsData[t],s=i.fillStyle,o=i.lineStyle;if(s&&!s.texture.baseTexture.valid||o&&!o.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let t=this.batches;for(let e=0,i=t.length;e<i;e++){let s=t[e];for(let o=0;o<s.size;o++){let n=s.start+o;this.indicesUint16[n]=this.indicesUint16[n]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;let t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<Ym.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++Y._globalBatch;for(let u=0;u<this.drawCalls.length;u++)this.drawCalls[u].texArray.clear(),Rs.push(this.drawCalls[u]);this.drawCalls.length=0;let e=this.colors,i=this.textureIds,s=Rs.pop();s||(s=new Er,s.texArray=new Pr),s.texArray.count=0,s.start=0,s.size=0,s.type=Fe.TRIANGLES;let o=0,n=null,a=0,l=!1,h=Fe.TRIANGLES,c=0;this.drawCalls.push(s);for(let u=0;u<this.batches.length;u++){let d=this.batches[u],p=8,f=d.style,m=f.texture.baseTexture;l!==!!f.native&&(l=!!f.native,h=l?Fe.LINES:Fe.TRIANGLES,n=null,o=p,t++),n!==m&&(n=m,m._batchEnabled!==t&&(o===p&&(t++,o=0,s.size>0&&(s=Rs.pop(),s||(s=new Er,s.texArray=new Pr),this.drawCalls.push(s)),s.start=c,s.size=0,s.texArray.count=0,s.type=h),m.touched=1,m._batchEnabled=t,m._batchLocation=o,m.wrapMode=vr.REPEAT,s.texArray.elements[s.texArray.count++]=m,o++)),s.size+=d.size,c+=d.size,a=m._batchLocation,this.addColors(e,f.color,f.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}Y._globalBatch=t,this.packAttributes()}packAttributes(){let t=this.points,e=this.uvs,i=this.colors,s=this.textureIds,o=new ArrayBuffer(t.length*3*4),n=new Float32Array(o),a=new Uint32Array(o),l=0;for(let h=0;h<t.length/2;h++)n[l++]=t[h*2],n[l++]=t[h*2+1],n[l++]=e[h*2],n[l++]=e[h*2+1],a[l++]=i[h],n[l++]=s[h];this._buffer.update(o),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?Zo.triangulate(t,this):Jo[t.type].triangulate(t,this)}processLine(t){Qo(t,this);for(let e=0;e<t.holes.length;e++)Qo(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){let i=t[e];Jo[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){let t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){let s=t[i*2],o=t[i*2+1];t[i*2]=e.a*s+e.c*o+e.tx,t[i*2+1]=e.b*s+e.d*o+e.ty}}addColors(t,e,i,s,o=0){let n=tt.shared.setValue(e).toLittleEndianNumber(),a=tt.shared.setValue(n).toPremultiplied(i);t.length=Math.max(t.length,o+s);for(let l=0;l<s;l++)t[o+l]=a}addTextureIds(t,e,i,s=0){t.length=Math.max(t.length,s+i);for(let o=0;o<i;o++)t[s+o]=e}addUvs(t,e,i,s,o,n=null){let a=0,l=e.length,h=i.frame;for(;a<o;){let u=t[(s+a)*2],d=t[(s+a)*2+1];if(n){let p=n.a*u+n.c*d+n.tx;d=n.b*u+n.d*d+n.ty,u=p}a++,e.push(u/h.width,d/h.height)}let c=i.baseTexture;(h.width<c.width||h.height<c.height)&&this.adjustUvs(e,i,l,o)}adjustUvs(t,e,i,s){let o=e.baseTexture,n=1e-6,a=i+s*2,l=e.frame,h=l.width/o.width,c=l.height/o.height,u=l.x/l.width,d=l.y/l.height,p=Math.floor(t[i]+n),f=Math.floor(t[i+1]+n);for(let m=i+2;m<a;m+=2)p=Math.min(p,Math.floor(t[m]+n)),f=Math.min(f,Math.floor(t[m+1]+n));u-=p,d-=f;for(let m=i;m<a;m+=2)t[m]=(t[m]+u)*h,t[m+1]=(t[m+1]+d)*c}};Wm.BATCHABLE_SIZE=100;var $c=Wm;var vi=class r{constructor(){this.color=16777215,this.alpha=1,this.texture=b.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=b.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}};var tn=class r extends vi{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Me.BUTT,this.join=Qt.MITER,this.miterLimit=10}clone(){let t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Me.BUTT,this.join=Qt.MITER,this.miterLimit=10}};var Xc={},Wc=class Ya extends I{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new vi,this._lineStyle=new tn,this._matrix=null,this._holeMode=!1,this.state=Se.for2d(),this._geometry=t||new $c,this._geometry.refCount++,this._transformID=-1,this._tintColor=new tt(16777215),this.blendMode=j.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new Ya(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,s=.5,o=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:s,native:o}),this.lineTextureStyle(t)}lineTextureStyle(t){let e={width:0,texture:b.WHITE,color:t?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Me.BUTT,join:Qt.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();let i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Ir,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Ir,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);let i=this.currentPath.points,s=i[i.length-2],o=i[i.length-1];return(s!==t||o!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,s){this._initCurve();let o=this.currentPath.points;return o.length===0&&this.moveTo(0,0),Ms.curveTo(t,e,i,s,o),this}bezierCurveTo(t,e,i,s,o,n){return this._initCurve(),Ps.curveTo(t,e,i,s,o,n,this.currentPath.points),this}arcTo(t,e,i,s,o){this._initCurve(t,e);let n=this.currentPath.points,a=yi.curveTo(t,e,i,s,o,n);if(a){let{cx:l,cy:h,radius:c,startAngle:u,endAngle:d,anticlockwise:p}=a;this.arc(l,h,c,u,d,p)}return this}arc(t,e,i,s,o,n=!1){if(s===o)return this;if(!n&&o<=s?o+=Ar:n&&s<=o&&(s+=Ar),o-s===0)return this;let a=t+Math.cos(s)*i,l=e+Math.sin(s)*i,h=this._geometry.closePointEps,c=this.currentPath?this.currentPath.points:null;if(c){let u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);u<h&&d<h||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return yi.arc(a,l,t,e,i,s,o,n,c),this}beginFill(t=0,e){return this.beginTextureFill({texture:b.WHITE,color:t,alpha:e})}normalizeColor(t){let e=tt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){let e={texture:b.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();let i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,s){return this.drawShape(new $(t,e,i,s))}drawRoundedRect(t,e,i,s,o){return this.drawShape(new qi(t,e,i,s,o))}drawCircle(t,e,i){return this.drawShape(new Wi(t,e,i))}drawEllipse(t,e,i,s){return this.drawShape(new Yi(t,e,i,s))}drawPolygon(...t){let e,i=!0,s=t[0];s.points?(i=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;let o=new Ir(e);return o.closeStroke=i,this.drawShape(o),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===ct.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();let e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){let t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let s=0;s<i;s++){let o=t.batches[s],n=o.style.color,a=new Float32Array(this.vertexData.buffer,o.attribStart*4*2,o.attribSize*2),l=new Float32Array(t.uvsFloat32.buffer,o.attribStart*4*2,o.attribSize*2),h=new Uint16Array(t.indicesUint16.buffer,o.start*2,o.size),c={vertexData:a,blendMode:e,indices:h,uvs:l,_batchRGB:tt.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:o.style.texture,alpha:o.style.alpha,worldAlpha:1};this.batches[s]=c}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){let s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){let e=this._resolveDirectShader(t),i=this._geometry,s=this.worldAlpha,o=e.uniforms,n=i.drawCalls;o.translationMatrix=this.transform.worldTransform,tt.shared.setValue(this._tintColor).premultiply(s).toArray(o.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,l=n.length;a<l;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){let{texArray:i,type:s,size:o,start:n}=e,a=i.count;for(let l=0;l<a;l++)t.texture.bind(i.elements[l],l);t.geometry.draw(s,o,n)}_resolveDirectShader(t){let e=this.shader,i=this.pluginName;if(!e){if(!Xc[i]){let{maxTextures:s}=t.plugins[i],o=new Int32Array(s);for(let l=0;l<s;l++)o[l]=l;let n={tint:new Float32Array([1,1,1,1]),translationMatrix:new st,default:oe.from({uSamplers:o},!0)},a=t.plugins[i]._shader.program;Xc[i]=new hr(a,n)}e=Xc[i]}return e}_calculateBounds(){this.finishPoly();let t=this._geometry;if(!t.graphicsData.length)return;let{minX:e,minY:i,maxX:s,maxY:o}=t.bounds;this._bounds.addFrame(this.transform,e,i,s,o)}containsPoint(t){return this.worldTransform.applyInverse(t,Ya._TEMP_POINT),this._geometry.containsPoint(Ya._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){let e=this.batches[t];e._tintRGB=tt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;let e=this.transform.worldTransform,i=e.a,s=e.b,o=e.c,n=e.d,a=e.tx,l=e.ty,h=this._geometry.points,c=this.vertexData,u=0;for(let d=0;d<h.length;d+=2){let p=h[d],f=h[d+1];c[u++]=i*p+o*f+a,c[u++]=n*f+s*p+l}}closePath(){let t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Wc.curves=Re,Wc._TEMP_POINT=new H;var en=Wc;var N_=[1,2,4],qa={hitboxPadding:40},Bs=class r extends I{hitbox;roadMark;items;lane;constructor(){super(),this.roadMark=new C(b.from("Obs-11")),this.roadMark.anchor.set(.5,0),this.items=new I,this.hitbox=new en,this.scale.set(.5),this.addChild(this.roadMark),this.addChild(this.hitbox),this.addChild(this.items)}static create(){let t=new r;return r.reset(t),t}static reset(t){let e=r.getRandomId(),i=Math.floor(Math.random()*3)+4;t.items.removeChildren();let s=0,o=0;for(let n=0;n<i;n++){let a=new C(b.from(`Obs-${e}`));a.position.set(s,o),s+=a.width,s>t.roadMark.width-2*qa.hitboxPadding&&(s=0,o+=a.width),t.items.addChild(a)}t.items.pivot.x=t.items.width/2,It.disableShadows||(t.items.filters=[new fi({blur:2,offset:{x:-6,y:4}})]),t.hitbox.clear(),t.hitbox.beginFill(16777215,.5),t.hitbox.drawRect(-t.items.width/2+qa.hitboxPadding,qa.hitboxPadding,t.items.width-qa.hitboxPadding*2,t.items.height*.9),t.hitbox.endFill(),t.hitbox.visible=!1}static destroyObstacle(t){t.destroy({children:!0})}static getRandomId(){return Ut([...N_],[1,1,1])}};var U_={spawnPeriodMS:5e3},Ka=class{config;lastSpawnedMS;obstacles=new Nt(Bs.create,Bs.reset,Bs.destroyObstacle);onSpawn=new Pe;constructor(t){this.config=Object.assign({},U_,t||{}),this.lastSpawnedMS=0}spawn(){return this.obstacles.getInstance()}update(t){this.lastSpawnedMS+=t,this.lastSpawnedMS>this.config.spawnPeriodMS&&(this.lastSpawnedMS-=this.config.spawnPeriodMS,this.spawn())}};var Za=160,Yc=[[{lane:0,possibleEnemies:["regular","taxi","obstacle"],offsetRange:[0,0]},{lane:1,possibleEnemies:["fuel","regular","taxi","obstacle"],offsetRange:[0,Za]}],[{lane:0,possibleEnemies:["regular","taxi"],offsetRange:[0,Za]},{lane:2,possibleEnemies:["regular"],offsetRange:[0,0]}],[{lane:0,possibleEnemies:["regular","taxi"],offsetRange:[0,Za]},{lane:2,possibleEnemies:["fuel","moneyvan","hpvan","obstacle"],offsetRange:[0,Za]},{lane:4,possibleEnemies:["regular","obstacle"],offsetRange:[0,0]}]],Qa=class{laneData;constructor(t,e=0,i=!1){this.laneData=t.map(s=>({lane:this.pickLane(s.lane,e,i),enemy:this.pickEnemyKind(s.possibleEnemies),offset:this.pickEnemyOffset(s.offsetRange)}))}pickLane(t,e,i){return(t+e)%Jt.laneCount}pickEnemyKind(t){return Ut(t,Array(t.length).fill(1))}pickEnemyOffset(t){return rr(t[0],t[1])}};var Ja=class{road;enemySpawner;obstacleSpawner;container;enemyContainer;obstacleContainer;timeToMysteryCarMS;timeToBossMS;bossMode;constructor(t){this.road=t,this.timeToBossMS=mt.timeToBossMS,this.bossMode=!1,this.enemySpawner=new As,this.obstacleSpawner=new Ka,this.container=new I,this.enemyContainer=new I,this.obstacleContainer=new I,this.container.addChild(this.obstacleContainer),this.container.addChild(this.enemyContainer),this.enemySpawner.onSpawn.add(()=>{this.timeToBossMS>1500&&this.spawnThreats()}),this.timeToMysteryCarMS=mt.mysteryCarPeriodMS}spawnThreats(){let t=Ut(Yc,Array(Yc.length).fill(1));new Qa(t,rr(0,Jt.laneCount-1)).laneData.forEach(i=>{if(this.road.lanes[i.lane]<1){let s,o;i.enemy!="obstacle"?(s=this.enemySpawner.cars.getInstance(),o=this.enemyContainer,As.changeCarKind(s,i.enemy)):(s=this.obstacleSpawner.obstacles.getInstance(),o=this.obstacleContainer),this.addThreatToLane(s,o,i.lane,i.offset)}})}addThreatToLane(t,e,i,s=0){t.lane=i,e.addChild(t),t.position.set(this.road.getLaneX(i),-t.height-s),this.road.increaseLaneOccupancy(i)}update(t){this.bossMode||(this.timeToBossMS-=t,this.checkMysteryCarSpawn(t),this.enemySpawner.update(t),this.timeToBossMS<=0&&this.spawnBoss())}spawnBoss(){this.bossMode=!0,ot.emit("BOSS_APPEAR")}disableBossMode(){this.bossMode=!1,this.timeToBossMS=mt.timeToBossMS}clearThreats(){this.enemySpawner.cars.activeInstances.forEach(t=>this.enemySpawner.cars.release(t)),this.obstacleSpawner.obstacles.activeInstances.forEach(t=>this.obstacleSpawner.obstacles.release(t)),this.road.clearLanes()}resetTimers(t){this.enemySpawner.resetTimer(t),this.timeToMysteryCarMS=mt.mysteryCarPeriodMS+t}checkMysteryCarSpawn(t){if(this.timeToMysteryCarMS-=t,this.timeToMysteryCarMS<0){let e=this.road.getFreeLane();if(e!==void 0){let i=this.enemySpawner.cars.getInstance();As.changeCarKind(i,"mystery"),this.addThreatToLane(i,this.enemyContainer,e,0),this.timeToMysteryCarMS=mt.mysteryCarPeriodMS}}}releaseEnemy(t){this.road.decreaseLaneOccupancy(t.lane),this.enemySpawner.cars.release(t)}releaseObstacle(t){this.road.decreaseLaneOccupancy(t.lane),this.obstacleSpawner.obstacles.release(t)}get enemies(){return this.enemySpawner.cars}get activeEnemies(){return this.enemySpawner.cars.activeInstances}get obstacles(){return this.obstacleSpawner.obstacles}get activeObstacles(){return this.obstacleSpawner.obstacles.activeInstances}clearSignals(){this.enemySpawner.onSpawn.removeAll(),this.obstacleSpawner.onSpawn.removeAll()}};var tl={projectileOffsetX:30,projectileOffsetY:-150},el=class extends ve{rotation=0;body;level=1;constructor(t){super(t||{},new Nt(()=>{let e=new C;return e.anchor.set(.5),e.scale.set(1.5),e},e=>{e.rotation=0,e.texture=b.from(`Fire-1-${this.getColor(this.level)}`)},ve.destroyProjectile)),this.lastFiredMS=0,this.body=new C(b.from("Boss_Weapon_Front")),this.body.scale.set(.5),this.body.anchor.set(.5,.7),this.body.addChild(this.flashes)}setupMuzzleFlash(t){this.flashes.removeChildren();let e=this.getColor(t);this.addMuzzleFlash(b.from(`Fire-Exit-1-${e}`),{x:-32,y:-180}),this.addMuzzleFlash(b.from(`Fire-Exit-1-${e}`),{x:30,y:-180})}upgrade(t){this.level=t,this.setupMuzzleFlash(t)}aim(t){this.rotation=Math.atan2(t.y-this.body.parent.y,t.x-this.body.parent.x),this.body.rotation=this.rotation+Math.PI/2}fire(){super.fire();let t=this.projectiles.getInstance();t.rotation=this.rotation+Math.PI/2,this.body.addChild(t),t.position.set(-tl.projectileOffsetX,tl.projectileOffsetY),this.onFire.dispatch([t]);let e=this.projectiles.getInstance();e.rotation=this.rotation+Math.PI/2,this.body.addChild(e),e.position.set(tl.projectileOffsetX,tl.projectileOffsetY),this.onFire.dispatch([e])}};function qm(r){return r<.5?2*r*r:1-Math.pow(-2*r+2,2)/2}var G_={threshold:.2,moveTime:1e3,checkPeriodMS:2e3},rl=class{config;checkTime;steeredCar;targetCar;oldX;targetX;movementTime;constructor(t,e,i){this.config=Object.assign({},G_,t),this.steeredCar=e,this.targetCar=i,this.oldX=this.steeredCar.roadX,this.targetX=this.targetCar.roadX,this.checkTime=0}update(t){this.checkTime+=t,this.checkTime>=this.config.checkPeriodMS&&Math.abs(this.steeredCar.roadX-this.targetCar.roadX)>this.config.threshold&&(this.checkTime-=this.config.checkPeriodMS,this.startMoving(this.targetCar.roadX)),this.movementTime<this.config.moveTime&&this.adjustPosition(t)}reset(){this.checkTime=0,this.movementTime=this.config.moveTime}startMoving(t){this.oldX=this.steeredCar.roadX,this.targetX=t,this.movementTime=0}adjustPosition(t){this.movementTime+=t,this.steeredCar.roadX=this.oldX+(this.targetX-this.oldX)*qm(this.movementTime/this.config.moveTime)}};var il=class extends Br{target;steering;healthBar;level;gun;constructor(t){super(),this.level=t,this.body.texture=b.from("Boss-Car"),this.body.scale.set(.75),this.gun=new el({firePeriodMS:1e3,projectileSpeed:.7}),this.addChild(this.gun.body),this.scale.set(1.5),this.resetHealth(t),this.gun.aim({x:this.x,y:this.y+100})}setTarget(t){this.target=t,this.steering=new rl({},this,this.target)}update(t){this.gun.aim(this.target.position),this.gun.body.tint=this.body.tint,this.steering&&this.steering.update(t)}revive(t){this.level=t,this.steering.reset(),this.resetHealth(t),this.gun.upgrade(t)}takeDamage(t){super.takeDamage(t),this.health-=t,this.healthBar.alpha=1,this.healthBar.updateValue(this.health/this.getHealthForLevel(this.level))}resetHealth(t){this.healthBar&&this.removeChild(this.healthBar),this.health=this.getHealthForLevel(t),this.healthBar=new Ss,this.healthBar.y=this.body.height/2+this.healthBar.height/2,console.log(this.healthBar),this.healthBar.scale.set(.25),this.healthBar.alpha=0,this.addChild(this.healthBar)}getHealthForLevel(t){return It.weakBosses?200:1800+t*300}getRewardForLevel(t){return Math.round((130+t*(10+t))/10)*10}};var sl=class extends I{icon;bg;fill;fillMask;tween;constructor(){super(),this.icon=new C(b.from("icon-health")),this.bg=new C(b.from("health-progress-back")),this.fill=new C(b.from("health-progress-full")),[this.bg,this.fill,this.icon].forEach(t=>t.anchor.set(.5)),this.icon.position.x-=this.bg.width/2,this.tween=new at(this.fill).easing(it.Cubic.InOut).duration(300),this.updateValue(1),this.fillMask=new en,this.fillMask.beginFill(16777215),this.fillMask.drawRect(-this.bg.width/2+4,-this.bg.height/2,this.bg.width,this.bg.height),this.fill.mask=this.fillMask,this.addChild(this.fillMask),this.addChild(this.bg),this.addChild(this.fill),this.addChild(this.icon)}updateValue(t){this.tween.dynamicTo({x:-this.bg.width*(1-t)}).restart()}};var ks=class extends I{text;constructor(){super();let t=new C(b.from("panel-profile")),e=new C(b.from("icon-rep")),i=new C(b.from("icon-profile")),s=new J("0",{fontFamily:F.font,fontSize:48,fill:16777215});[t,i,e].forEach(o=>{o.anchor.set(.5)}),s.anchor.set(0,.5),i.position.set(-145,-15),e.position.set(-30,0),s.position.set(20,0),this.addChild(t),this.addChild(i),this.addChild(e),this.text=this.addChild(s)}updateValue(t){this.text.text=t.toString()}};var $t={width:300,height:30},ol=class extends I{start;finish;fullBar;currentProgress;currentMarker;duration;g;progressValue=0;constructor(){super(),this.fullBar=new C(b.WHITE),this.fullBar.scale.set($t.width/16,$t.height/16),this.fullBar.alpha=.5,this.fullBar.anchor.set(.5),this.currentProgress=new C(b.WHITE),this.currentProgress.scale.set($t.width/16*this.progressValue,$t.height/16),this.currentProgress.anchor.set(0,.5),this.currentProgress.x=-$t.width/2,this.currentProgress.tint=2017783,this.start=new C(b.from("progress-meter-start")),this.finish=new C(b.from("progress-meter-finish")),this.currentMarker=new C(b.from("icon-car")),[this.start,this.finish,this.currentMarker].forEach(t=>t.anchor.set(.5)),this.start.x=-$t.width/2,this.currentMarker.position.set(this.start.x,-35),this.finish.x=$t.width/2,this.addChild(this.fullBar),this.addChild(this.currentProgress),this.addChild(this.currentMarker),this.addChild(this.start),this.addChild(this.finish)}drawBar(){this.g.clear(),this.g.beginFill(tt.shared.setValue({r:255,g:255,b:255,a:.5})),this.g.drawRect(-$t.width/2,-$t.height/2,$t.width,$t.height),this.g.endFill(),this.g.beginFill(2217723),this.g.drawRect(-$t.width/2,-$t.height/2,$t.width*this.progressValue,$t.height)}updateValue(t){this.progressValue=t,this.currentMarker.x=$t.width*(t-.5),this.currentProgress.scale.x=$t.width/16*this.progressValue}};var nl=class extends I{playerHealth;progress;money;reputation;constructor(){super(),this.money=new Ht("Money"),this.reputation=new ks,this.progress=new ol,this.playerHealth=new sl,this.addChild(this.progress),this.addChild(this.money),this.addChild(this.reputation),this.addChild(this.playerHealth),this.positionElements()}setMoney(t){this.money.updateValue(t)}setReputation(t){this.reputation.updateValue(t)}setProgress(t){this.progress.updateValue(t)}setHealth(t){this.playerHealth.updateValue(t)}positionElements(){this.reputation.position.set(P.width/2-300,80),this.progress.position.set(P.width/2+40,80),this.money.position.set(P.width/2+400,80),this.playerHealth.position.set(this.reputation.position.x-20,this.reputation.getBounds().bottom+5)}};function z_(r,t){let e=t.x-r.x,i=t.y-r.y;return e*e+i*i}function Km(r,t){return Math.sqrt(z_(r,t))}var al=class extends I{title;titleBg;titleLabel;rewards;mainBg;rewardLabel;reward;constructor(t){super(),this.title=new I,this.titleBg=new C(b.from("panel-boss-title")),this.mainBg=new C(b.from("panel-boss-appear")),this.titleLabel=new J(F.getText("Boss").toUpperCase(),{fontFamily:F.font,fill:2108255,fontSize:54}),this.rewards=new I,this.rewardLabel=new J(F.getText("Bounty").toUpperCase(),{fontFamily:F.font,fill:16777215,fontSize:54}),this.reward=new Ht("Money"),this.reward.updateValue(t),[this.titleBg,this.mainBg,this.titleLabel,this.rewardLabel].forEach(e=>e.anchor.set(.5)),this.title.addChild(this.titleBg),this.title.addChild(this.titleLabel),this.rewards.addChild(this.rewardLabel),this.rewards.addChild(this.reward),this.addChild(this.mainBg),this.addChild(this.title),this.addChild(this.rewards),this.positionElements()}positionElements(){this.title.position.set(10,-100),this.mainBg.position.set(0,-30),this.rewards.position.set(-15,10),this.rewardLabel.position.set(-150,0),this.reward.position.set(150,0)}};var ll=class extends I{title;titleBg;titleLabel;rewards;mainBg;rewardLabel;reward;constructor(t){super(),this.title=new I,this.titleBg=new C(b.from("panel-boss-title")),this.mainBg=new C(b.from("panel-boss-complete")),this.titleLabel=new J(F.getText("Boss defeated").toUpperCase(),{fontFamily:F.font,fill:2108255,fontSize:54}),this.rewards=new I,this.rewardLabel=new J(F.getText("Reward").toUpperCase(),{fontFamily:F.font,fill:16777215,fontSize:54}),this.reward=new Ht("Money"),this.reward.updateValue(t),[this.titleBg,this.mainBg,this.titleLabel,this.rewardLabel].forEach(e=>e.anchor.set(.5)),this.title.addChild(this.titleBg),this.title.addChild(this.titleLabel),this.rewards.addChild(this.rewardLabel),this.rewards.addChild(this.reward),this.addChild(this.mainBg),this.addChild(this.title),this.addChild(this.rewards),this.positionElements()}positionElements(){this.title.position.set(10,-100),this.mainBg.position.set(0,-30),this.rewards.position.set(-15,10),this.rewardLabel.position.set(-150,0),this.reward.position.set(150,0)}};var hl=class extends I{dimmer;text;tween;constructor(){super(),this.tween=new at(this).from({alpha:0}).to({alpha:1},300).easing(it.Quadratic.InOut),this.dimmer=new C(b.WHITE),this.dimmer.scale.set(P.width/this.dimmer.texture.width,P.height/this.dimmer.texture.height),this.dimmer.tint=0,this.dimmer.alpha=.7,this.text=new J(F.getText("Tap to play"),{fontFamily:F.font,fontSize:108,fill:16777215,align:"center"}),this.text.anchor.set(.5),this.text.position.set(P.width/2,P.height*.7),this.alpha=0,this.addChild(this.dimmer),this.addChild(this.text)}tweenShow(){this.tween.start()}};var cl=class extends I{text;constructor(){super();let t=new C(b.from("panel-end-rep")),e=new C(b.from("icon-rep"));e.scale.set(1.5);let i=new J(F.getText("Rep:"),{fontFamily:F.font,fontSize:64,fill:16777215}),s=new J("0",{fontFamily:F.font,fontSize:64,fill:16777215});[t].forEach(o=>{o.anchor.set(.5)}),[i,e,s].forEach(o=>{o.anchor.set(0,.5)}),i.position.set(-t.width/2+40,0),e.position.set(i.getBounds().right+40,0),s.position.set(e.getBounds().right+40,0),this.addChild(t),this.addChild(i),this.addChild(e),this.text=this.addChild(s)}updateValue(t){this.text.text=t.toString()}};var j_=Object.defineProperty,V_=(r,t,e)=>t in r?j_(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,wt=(r,t,e)=>(V_(r,typeof t!="symbol"?t+"":t,e),e);var bg=function(r){let t=[],e=0;for(let i=0;i<r.length;i++){let s=r.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<r.length&&(r.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},H_=function(r){let t=[],e=0,i=0;for(;e<r.length;){let s=r[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){let o=r[e++];t[i++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){let o=r[e++],n=r[e++],a=r[e++],l=((s&7)<<18|(o&63)<<12|(n&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(l>>10)),t[i++]=String.fromCharCode(56320+(l&1023))}else{let o=r[e++],n=r[e++];t[i++]=String.fromCharCode((s&15)<<12|(o&63)<<6|n&63)}}return t.join("")},_g={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();let e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<r.length;s+=3){let o=r[s],n=s+1<r.length,a=n?r[s+1]:0,l=s+2<r.length,h=l?r[s+2]:0,c=o>>2,u=(o&3)<<4|a>>4,d=(a&15)<<2|h>>6,p=h&63;l||(p=64,n||(d=64)),i.push(e[c],e[u],e[d],e[p])}return i.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(bg(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):H_(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();let e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<r.length;){let o=e[r.charAt(s++)],n=s<r.length?e[r.charAt(s)]:0;++s;let a=s<r.length?e[r.charAt(s)]:64;++s;let l=s<r.length?e[r.charAt(s)]:64;if(++s,o==null||n==null||a==null||l==null)throw new nu;let h=o<<2|n>>4;if(i.push(h),a!==64){let c=n<<4&240|a>>2;if(i.push(c),l!==64){let u=a<<6&192|l;i.push(u)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}},nu=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},$_=function(r){let t=bg(r);return _g.encodeByteArray(t,!0)},wg=function(r){return $_(r).replace(/\./g,"")},X_=function(r){try{return _g.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function W_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var Y_=()=>W_().__FIREBASE_DEFAULTS__,q_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let r=process.env.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},K_=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=r&&X_(r[1]);return t&&JSON.parse(t)},Z_=()=>{try{return Y_()||q_()||K_()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},Tg=()=>{var r;return(r=Z_())===null||r===void 0?void 0:r.config};var au=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}};function Q_(){let r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Lu(){try{return typeof indexedDB=="object"}catch{return!1}}function Cg(){return new Promise((r,t)=>{try{let e=!0,i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),r(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var o;t(((o=s.error)===null||o===void 0?void 0:o.message)||"")}}catch(e){t(e)}})}function J_(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}var t1="FirebaseError",xr=class r extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=t1,Object.setPrototypeOf(this,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ti.prototype.create)}},Ti=class{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){let i=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],n=o?e1(o,i):"Error",a=`${this.serviceName}: ${n} (${s}).`;return new xr(s,a,i)}};function e1(r,t){return r.replace(r1,(e,i)=>{let s=t[i];return s!=null?String(s):`<${i}?>`})}var r1=/\{\$([^}]+)}/g;function pl(r,t){if(r===t)return!0;let e=Object.keys(r),i=Object.keys(t);for(let s of e){if(!i.includes(s))return!1;let o=r[s],n=t[s];if(Zm(o)&&Zm(n)){if(!pl(o,n))return!1}else if(o!==n)return!1}for(let s of i)if(!e.includes(s))return!1;return!0}function Zm(r){return r!==null&&typeof r=="object"}var i1=1e3,s1=2,o1=4*60*60*1e3,n1=.5;function lu(r,t=i1,e=s1){let i=t*Math.pow(e,r),s=Math.round(n1*i*(Math.random()-.5)*2);return Math.min(o1,i+s)}function zr(r){return r&&r._delegate?r._delegate:r}var ze=class{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}};var bi="[DEFAULT]";var hu=class{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){let e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){let i=new au;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{let s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;let i=this.normalizeInstanceIdentifier(t?.identifier),s=(e=t?.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(o){if(s)return null;throw o}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(l1(t))try{this.getOrInitializeService({instanceIdentifier:bi})}catch{}for(let[e,i]of this.instancesDeferred.entries()){let s=this.normalizeInstanceIdentifier(e);try{let o=this.getOrInitializeService({instanceIdentifier:s});i.resolve(o)}catch{}}}}clearInstance(t=bi){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){let t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=bi){return this.instances.has(t)}getOptions(t=bi){return this.instancesOptions.get(t)||{}}initialize(t={}){let{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(let[o,n]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);i===a&&n.resolve(s)}return s}onInit(t,e){var i;let s=this.normalizeInstanceIdentifier(e),o=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;o.add(t),this.onInitCallbacks.set(s,o);let n=this.instances.get(s);return n&&t(n,s),()=>{o.delete(t)}}invokeOnInitCallbacks(t,e){let i=this.onInitCallbacks.get(e);if(i)for(let s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:a1(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=bi){return this.component?this.component.multipleInstances?t:bi:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function a1(r){return r===bi?void 0:r}function l1(r){return r.instantiationMode==="EAGER"}var cu=class{constructor(t){this.name=t,this.providers=new Map}addComponent(t){let e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);let e=new hu(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}};var dt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(dt||(dt={}));var h1={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},c1=dt.INFO,u1={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},d1=(r,t,...e)=>{if(t<r.logLevel)return;let i=new Date().toISOString(),s=u1[t];if(s)console[s](`[${i}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)},nn=class{constructor(t){this.name=t,this._logLevel=c1,this._logHandler=d1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in dt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?h1[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...t),this._logHandler(this,dt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...t),this._logHandler(this,dt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...t),this._logHandler(this,dt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...t),this._logHandler(this,dt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...t),this._logHandler(this,dt.ERROR,...t)}},p1=(r,t)=>t.some(e=>r instanceof e),Qm,Jm;function f1(){return Qm||(Qm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function m1(){return Jm||(Jm=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Sg=new WeakMap,uu=new WeakMap,Eg=new WeakMap,qc=new WeakMap,Bu=new WeakMap;function g1(r){let t=new Promise((e,i)=>{let s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",n)},o=()=>{e(Dr(r.result)),s()},n=()=>{i(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",n)});return t.then(e=>{e instanceof IDBCursor&&Sg.set(e,r)}).catch(()=>{}),Bu.set(t,r),t}function y1(r){if(uu.has(r))return;let t=new Promise((e,i)=>{let s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",n),r.removeEventListener("abort",n)},o=()=>{e(),s()},n=()=>{i(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",n),r.addEventListener("abort",n)});uu.set(r,t)}var du={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return uu.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Eg.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Dr(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function x1(r){du=r(du)}function v1(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){let i=r.call(Kc(this),t,...e);return Eg.set(i,t.sort?t.sort():[t]),Dr(i)}:m1().includes(r)?function(...t){return r.apply(Kc(this),t),Dr(Sg.get(this))}:function(...t){return Dr(r.apply(Kc(this),t))}}function b1(r){return typeof r=="function"?v1(r):(r instanceof IDBTransaction&&y1(r),p1(r,f1())?new Proxy(r,du):r)}function Dr(r){if(r instanceof IDBRequest)return g1(r);if(qc.has(r))return qc.get(r);let t=b1(r);return t!==r&&(qc.set(r,t),Bu.set(t,r)),t}var Kc=r=>Bu.get(r);function _1(r,t,{blocked:e,upgrade:i,blocking:s,terminated:o}={}){let n=indexedDB.open(r,t),a=Dr(n);return i&&n.addEventListener("upgradeneeded",l=>{i(Dr(n.result),l.oldVersion,l.newVersion,Dr(n.transaction),l)}),e&&n.addEventListener("blocked",l=>e(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}var w1=["get","getKey","getAll","getAllKeys","count"],T1=["put","add","delete","clear"],Zc=new Map;function tg(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(Zc.get(t))return Zc.get(t);let e=t.replace(/FromIndex$/,""),i=t!==e,s=T1.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||w1.includes(e)))return;let o=async function(n,...a){let l=this.transaction(n,s?"readwrite":"readonly"),h=l.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[e](...a),s&&l.done]))[0]};return Zc.set(t,o),o}x1(r=>({...r,get:(t,e,i)=>tg(t,e)||r.get(t,e,i),has:(t,e)=>!!tg(t,e)||r.has(t,e)}));var pu=class{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(C1(t)){let e=t.getImmediate();return`${e.library}/${e.version}`}else return null}).filter(t=>t).join(" ")}};function C1(r){let t=r.getComponent();return t?.type==="VERSION"}var fu="@firebase/app",eg="0.9.25";var Ci=new nn("@firebase/app"),S1="@firebase/app-compat",E1="@firebase/analytics-compat",A1="@firebase/analytics",I1="@firebase/app-check-compat",P1="@firebase/app-check",M1="@firebase/auth",R1="@firebase/auth-compat",F1="@firebase/database",L1="@firebase/database-compat",B1="@firebase/functions",k1="@firebase/functions-compat",O1="@firebase/installations",D1="@firebase/installations-compat",N1="@firebase/messaging",U1="@firebase/messaging-compat",G1="@firebase/performance",z1="@firebase/performance-compat",j1="@firebase/remote-config",V1="@firebase/remote-config-compat",H1="@firebase/storage",$1="@firebase/storage-compat",X1="@firebase/firestore",W1="@firebase/firestore-compat",Y1="firebase",q1="10.7.1";var mu="[DEFAULT]",K1={[fu]:"fire-core",[S1]:"fire-core-compat",[A1]:"fire-analytics",[E1]:"fire-analytics-compat",[P1]:"fire-app-check",[I1]:"fire-app-check-compat",[M1]:"fire-auth",[R1]:"fire-auth-compat",[F1]:"fire-rtdb",[L1]:"fire-rtdb-compat",[B1]:"fire-fn",[k1]:"fire-fn-compat",[O1]:"fire-iid",[D1]:"fire-iid-compat",[N1]:"fire-fcm",[U1]:"fire-fcm-compat",[G1]:"fire-perf",[z1]:"fire-perf-compat",[j1]:"fire-rc",[V1]:"fire-rc-compat",[H1]:"fire-gcs",[$1]:"fire-gcs-compat",[X1]:"fire-fst",[W1]:"fire-fst-compat","fire-js":"fire-js",[Y1]:"fire-js-all"};var fl=new Map,gu=new Map;function Z1(r,t){try{r.container.addComponent(t)}catch(e){Ci.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function Gr(r){let t=r.name;if(gu.has(t))return Ci.debug(`There were multiple attempts to register component ${t}.`),!1;gu.set(t,r);for(let e of fl.values())Z1(e,r);return!0}function ln(r,t){let e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}var Q1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Nr=new Ti("app","Firebase",Q1);var yu=class{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ze("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Nr.create("app-deleted",{appName:this._name})}};var J1=q1;function Ag(r,t={}){let e=r;typeof t!="object"&&(t={name:t});let i=Object.assign({name:mu,automaticDataCollectionEnabled:!1},t),s=i.name;if(typeof s!="string"||!s)throw Nr.create("bad-app-name",{appName:String(s)});if(e||(e=Tg()),!e)throw Nr.create("no-options");let o=fl.get(s);if(o){if(pl(e,o.options)&&pl(i,o.config))return o;throw Nr.create("duplicate-app",{appName:s})}let n=new cu(s);for(let l of gu.values())n.addComponent(l);let a=new yu(e,i,n);return fl.set(s,a),a}function Ig(r=mu){let t=fl.get(r);if(!t&&r===mu&&Tg())return Ag();if(!t)throw Nr.create("no-app",{appName:r});return t}function ir(r,t,e){var i;let s=(i=K1[r])!==null&&i!==void 0?i:r;e&&(s+=`-${e}`);let o=s.match(/\s|\//),n=t.match(/\s|\//);if(o||n){let a=[`Unable to register library "${s}" with version "${t}":`];o&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&n&&a.push("and"),n&&a.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ci.warn(a.join(" "));return}Gr(new ze(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}var tw="firebase-heartbeat-database",ew=1,an="firebase-heartbeat-store",Qc=null;function Pg(){return Qc||(Qc=_1(tw,ew,{upgrade:(r,t)=>{switch(t){case 0:r.createObjectStore(an)}}}).catch(r=>{throw Nr.create("idb-open",{originalErrorMessage:r.message})})),Qc}async function rw(r){try{return await(await Pg()).transaction(an).objectStore(an).get(Mg(r))}catch(t){if(t instanceof xr)Ci.warn(t.message);else{let e=Nr.create("idb-get",{originalErrorMessage:t?.message});Ci.warn(e.message)}}}async function rg(r,t){try{let e=(await Pg()).transaction(an,"readwrite");await e.objectStore(an).put(t,Mg(r)),await e.done}catch(e){if(e instanceof xr)Ci.warn(e.message);else{let i=Nr.create("idb-set",{originalErrorMessage:e?.message});Ci.warn(i.message)}}}function Mg(r){return`${r.name}!${r.options.appId}`}var iw=1024,sw=30*24*60*60*1e3,xu=class{constructor(t){this.container=t,this._heartbeatsCache=null;let e=this.container.getProvider("app").getImmediate();this._storage=new vu(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ig();if(!(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{let n=new Date(o.date).valueOf();return Date.now()-n<=sw}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=ig(),{heartbeatsToSend:i,unsentEntries:s}=ow(this._heartbeatsCache.heartbeats),o=wg(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}};function ig(){return new Date().toISOString().substring(0,10)}function ow(r,t=iw){let e=[],i=r.slice();for(let s of r){let o=e.find(n=>n.agent===s.agent);if(o){if(o.dates.push(s.date),sg(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),sg(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}var vu=class{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Lu()?Cg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await rw(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){let i=await this.read();return rg(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){let i=await this.read();return rg(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}};function sg(r){return wg(JSON.stringify({version:2,heartbeats:r})).length}function nw(r){Gr(new ze("platform-logger",t=>new pu(t),"PRIVATE")),Gr(new ze("heartbeat",t=>new xu(t),"PRIVATE")),ir(fu,eg,r),ir(fu,eg,"esm2017"),ir("fire-js","")}nw("");var aw="firebase",lw="10.7.1";ir(aw,lw,"app");var hw=(r,t)=>t.some(e=>r instanceof e),og,ng;function cw(){return og||(og=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uw(){return ng||(ng=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Rg=new WeakMap,bu=new WeakMap,Fg=new WeakMap,Jc=new WeakMap,ku=new WeakMap;function dw(r){let t=new Promise((e,i)=>{let s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",n)},o=()=>{e(Ur(r.result)),s()},n=()=>{i(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",n)});return t.then(e=>{e instanceof IDBCursor&&Rg.set(e,r)}).catch(()=>{}),ku.set(t,r),t}function pw(r){if(bu.has(r))return;let t=new Promise((e,i)=>{let s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",n),r.removeEventListener("abort",n)},o=()=>{e(),s()},n=()=>{i(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",n),r.addEventListener("abort",n)});bu.set(r,t)}var _u={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return bu.get(r);if(t==="objectStoreNames")return r.objectStoreNames||Fg.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Ur(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function fw(r){_u=r(_u)}function mw(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){let i=r.call(tu(this),t,...e);return Fg.set(i,t.sort?t.sort():[t]),Ur(i)}:uw().includes(r)?function(...t){return r.apply(tu(this),t),Ur(Rg.get(this))}:function(...t){return Ur(r.apply(tu(this),t))}}function gw(r){return typeof r=="function"?mw(r):(r instanceof IDBTransaction&&pw(r),hw(r,cw())?new Proxy(r,_u):r)}function Ur(r){if(r instanceof IDBRequest)return dw(r);if(Jc.has(r))return Jc.get(r);let t=gw(r);return t!==r&&(Jc.set(r,t),ku.set(t,r)),t}var tu=r=>ku.get(r);function yw(r,t,{blocked:e,upgrade:i,blocking:s,terminated:o}={}){let n=indexedDB.open(r,t),a=Ur(n);return i&&n.addEventListener("upgradeneeded",l=>{i(Ur(n.result),l.oldVersion,l.newVersion,Ur(n.transaction))}),e&&n.addEventListener("blocked",()=>e()),a.then(l=>{o&&l.addEventListener("close",()=>o()),s&&l.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}var xw=["get","getKey","getAll","getAllKeys","count"],vw=["put","add","delete","clear"],eu=new Map;function ag(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(eu.get(t))return eu.get(t);let e=t.replace(/FromIndex$/,""),i=t!==e,s=vw.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||xw.includes(e)))return;let o=async function(n,...a){let l=this.transaction(n,s?"readwrite":"readonly"),h=l.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[e](...a),s&&l.done]))[0]};return eu.set(t,o),o}fw(r=>({...r,get:(t,e,i)=>ag(t,e)||r.get(t,e,i),has:(t,e)=>!!ag(t,e)||r.has(t,e)}));var Lg="@firebase/installations",Ou="0.6.4";var Bg=1e4,kg=`w:${Ou}`,Og="FIS_v2",bw="https://firebaseinstallations.googleapis.com/v1",_w=60*60*1e3,ww="installations",Tw="Installations";var Cw={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Si=new Ti(ww,Tw,Cw);function Dg(r){return r instanceof xr&&r.code.includes("request-failed")}function Ng({projectId:r}){return`${bw}/projects/${r}/installations`}function Ug(r){return{token:r.token,requestStatus:2,expiresIn:Ew(r.expiresIn),creationTime:Date.now()}}async function Gg(r,t){let e=(await t.json()).error;return Si.create("request-failed",{requestName:r,serverCode:e.code,serverMessage:e.message,serverStatus:e.status})}function zg({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function Sw(r,{refreshToken:t}){let e=zg(r);return e.append("Authorization",Aw(t)),e}async function jg(r){let t=await r();return t.status>=500&&t.status<600?r():t}function Ew(r){return Number(r.replace("s","000"))}function Aw(r){return`${Og} ${r}`}async function Iw({appConfig:r,heartbeatServiceProvider:t},{fid:e}){let i=Ng(r),s=zg(r),o=t.getImmediate({optional:!0});if(o){let h=await o.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}let n={fid:e,authVersion:Og,appId:r.appId,sdkVersion:kg},a={method:"POST",headers:s,body:JSON.stringify(n)},l=await jg(()=>fetch(i,a));if(l.ok){let h=await l.json();return{fid:h.fid||e,registrationStatus:2,refreshToken:h.refreshToken,authToken:Ug(h.authToken)}}else throw await Gg("Create Installation",l)}function Vg(r){return new Promise(t=>{setTimeout(t,r)})}function Pw(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}var Mw=/^[cdef][\w-]{21}$/,wu="";function Rw(){try{let r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;let t=Fw(r);return Mw.test(t)?t:wu}catch{return wu}}function Fw(r){return Pw(r).substr(0,22)}function vl(r){return`${r.appName}!${r.appId}`}var Hg=new Map;function $g(r,t){let e=vl(r);Xg(e,t),Lw(e,t)}function Xg(r,t){let e=Hg.get(r);if(e)for(let i of e)i(t)}function Lw(r,t){let e=Bw();e&&e.postMessage({key:r,fid:t}),kw()}var wi=null;function Bw(){return!wi&&"BroadcastChannel"in self&&(wi=new BroadcastChannel("[Firebase] FID Change"),wi.onmessage=r=>{Xg(r.data.key,r.data.fid)}),wi}function kw(){Hg.size===0&&wi&&(wi.close(),wi=null)}var Ow="firebase-installations-database",Dw=1,Ei="firebase-installations-store",ru=null;function Du(){return ru||(ru=yw(Ow,Dw,{upgrade:(r,t)=>{switch(t){case 0:r.createObjectStore(Ei)}}})),ru}async function ml(r,t){let e=vl(r),i=(await Du()).transaction(Ei,"readwrite"),s=i.objectStore(Ei),o=await s.get(e);return await s.put(t,e),await i.done,(!o||o.fid!==t.fid)&&$g(r,t.fid),t}async function Wg(r){let t=vl(r),e=(await Du()).transaction(Ei,"readwrite");await e.objectStore(Ei).delete(t),await e.done}async function bl(r,t){let e=vl(r),i=(await Du()).transaction(Ei,"readwrite"),s=i.objectStore(Ei),o=await s.get(e),n=t(o);return n===void 0?await s.delete(e):await s.put(n,e),await i.done,n&&(!o||o.fid!==n.fid)&&$g(r,n.fid),n}async function Nu(r){let t,e=await bl(r.appConfig,i=>{let s=Nw(i),o=Uw(r,s);return t=o.registrationPromise,o.installationEntry});return e.fid===wu?{installationEntry:await t}:{installationEntry:e,registrationPromise:t}}function Nw(r){let t=r||{fid:Rw(),registrationStatus:0};return Yg(t)}function Uw(r,t){if(t.registrationStatus===0){if(!navigator.onLine){let s=Promise.reject(Si.create("app-offline"));return{installationEntry:t,registrationPromise:s}}let e={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},i=Gw(r,e);return{installationEntry:e,registrationPromise:i}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:zw(r)}:{installationEntry:t}}async function Gw(r,t){try{let e=await Iw(r,t);return ml(r.appConfig,e)}catch(e){throw Dg(e)&&e.customData.serverCode===409?await Wg(r.appConfig):await ml(r.appConfig,{fid:t.fid,registrationStatus:0}),e}}async function zw(r){let t=await lg(r.appConfig);for(;t.registrationStatus===1;)await Vg(100),t=await lg(r.appConfig);if(t.registrationStatus===0){let{installationEntry:e,registrationPromise:i}=await Nu(r);return i||e}return t}function lg(r){return bl(r,t=>{if(!t)throw Si.create("installation-not-found");return Yg(t)})}function Yg(r){return jw(r)?{fid:r.fid,registrationStatus:0}:r}function jw(r){return r.registrationStatus===1&&r.registrationTime+Bg<Date.now()}async function Vw({appConfig:r,heartbeatServiceProvider:t},e){let i=Hw(r,e),s=Sw(r,e),o=t.getImmediate({optional:!0});if(o){let h=await o.getHeartbeatsHeader();h&&s.append("x-firebase-client",h)}let n={installation:{sdkVersion:kg,appId:r.appId}},a={method:"POST",headers:s,body:JSON.stringify(n)},l=await jg(()=>fetch(i,a));if(l.ok){let h=await l.json();return Ug(h)}else throw await Gg("Generate Auth Token",l)}function Hw(r,{fid:t}){return`${Ng(r)}/${t}/authTokens:generate`}async function Uu(r,t=!1){let e,i=await bl(r.appConfig,s=>{if(!qg(s))throw Si.create("not-registered");let o=s.authToken;if(!t&&Ww(o))return s;if(o.requestStatus===1)return e=$w(r,t),s;{if(!navigator.onLine)throw Si.create("app-offline");let n=qw(s);return e=Xw(r,n),n}});return e?await e:i.authToken}async function $w(r,t){let e=await hg(r.appConfig);for(;e.authToken.requestStatus===1;)await Vg(100),e=await hg(r.appConfig);let i=e.authToken;return i.requestStatus===0?Uu(r,t):i}function hg(r){return bl(r,t=>{if(!qg(t))throw Si.create("not-registered");let e=t.authToken;return Kw(e)?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}async function Xw(r,t){try{let e=await Vw(r,t),i=Object.assign(Object.assign({},t),{authToken:e});return await ml(r.appConfig,i),e}catch(e){if(Dg(e)&&(e.customData.serverCode===401||e.customData.serverCode===404))await Wg(r.appConfig);else{let i=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await ml(r.appConfig,i)}throw e}}function qg(r){return r!==void 0&&r.registrationStatus===2}function Ww(r){return r.requestStatus===2&&!Yw(r)}function Yw(r){let t=Date.now();return t<r.creationTime||r.creationTime+r.expiresIn<t+_w}function qw(r){let t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},r),{authToken:t})}function Kw(r){return r.requestStatus===1&&r.requestTime+Bg<Date.now()}async function Zw(r){let t=r,{installationEntry:e,registrationPromise:i}=await Nu(t);return i?i.catch(console.error):Uu(t).catch(console.error),e.fid}async function Qw(r,t=!1){let e=r;return await Jw(e),(await Uu(e,t)).token}async function Jw(r){let{registrationPromise:t}=await Nu(r);t&&await t}function tT(r){if(!r||!r.options)throw iu("App Configuration");if(!r.name)throw iu("App Name");let t=["projectId","apiKey","appId"];for(let e of t)if(!r.options[e])throw iu(e);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function iu(r){return Si.create("missing-app-config-values",{valueName:r})}var Kg="installations",eT="installations-internal",rT=r=>{let t=r.getProvider("app").getImmediate(),e=tT(t),i=ln(t,"heartbeat");return{app:t,appConfig:e,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},iT=r=>{let t=r.getProvider("app").getImmediate(),e=ln(t,Kg).getImmediate();return{getId:()=>Zw(e),getToken:i=>Qw(e,i)}};function sT(){Gr(new ze(Kg,rT,"PUBLIC")),Gr(new ze(eT,iT,"PRIVATE"))}sT();ir(Lg,Ou);ir(Lg,Ou,"esm2017");var su="@firebase/remote-config",cg="0.4.4";var Tu=class{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}};var Zg="remote-config";var oT={"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"},fe=new Ti("remoteconfig","Remote Config",oT);function nT(r,t){return r instanceof xr&&r.code.indexOf(t)!==-1}var aT=!1,lT="",ug=0,hT=["1","true","t","yes","y","on"],sn=class{constructor(t,e=lT){this._source=t,this._value=e}asString(){return this._value}asBoolean(){return this._source==="static"?aT:hT.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return ug;let t=Number(this._value);return isNaN(t)&&(t=ug),t}getSource(){return this._source}};function cT(r=Ig()){return r=zr(r),ln(r,Zg).getImmediate()}async function uT(r){let t=zr(r),[e,i]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!e||!e.config||!e.eTag||e.eTag===i?!1:(await Promise.all([t._storageCache.setActiveConfig(e.config),t._storage.setActiveConfigEtag(e.eTag)]),!0)}function dT(r){let t=zr(r);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then(()=>{t._isInitializationComplete=!0})),t._initializePromise}async function pT(r){let t=zr(r),e=new Tu;setTimeout(async()=>{e.abort()},t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:e}),await t._storageCache.setLastFetchStatus("success")}catch(i){let s=nT(i,"fetch-throttle")?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(s),i}}function dg(r,t){let e=zr(r);e._isInitializationComplete||e._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);let i=e._storageCache.getActiveConfig();return i&&i[t]!==void 0?new sn("remote",i[t]):e.defaultConfig&&e.defaultConfig[t]!==void 0?new sn("default",String(e.defaultConfig[t])):(e._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new sn("static"))}var Cu=class{constructor(t,e,i,s){this.client=t,this.storage=e,this.storageCache=i,this.logger=s}isCachedDataFresh(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;let i=Date.now()-e,s=i<=t;return this.logger.debug(`Config fetch cache check. Cache age millis: ${i}. Cache max age millis (minimumFetchIntervalMillis setting): ${t}. Is cache hit: ${s}.`),s}async fetch(t){let[e,i]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(i&&this.isCachedDataFresh(t.cacheMaxAgeMillis,e))return i;t.eTag=i&&i.eTag;let s=await this.client.fetch(t),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return s.status===200&&o.push(this.storage.setLastSuccessfulFetchResponse(s)),await Promise.all(o),s}};function fT(r=navigator){return r.languages&&r.languages[0]||r.language}var Su=class{constructor(t,e,i,s,o,n){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=i,this.projectId=s,this.apiKey=o,this.appId=n}async fetch(t){let[e,i]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),s=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,o={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},n={sdk_version:this.sdkVersion,app_instance_id:e,app_instance_id_token:i,app_id:this.appId,language_code:fT()},a={method:"POST",headers:o,body:JSON.stringify(n)},l=fetch(s,a),h=new Promise((m,x)=>{t.signal.addEventListener(()=>{let y=new Error("The operation was aborted.");y.name="AbortError",x(y)})}),c;try{await Promise.race([l,h]),c=await l}catch(m){let x="fetch-client-network";throw m?.name==="AbortError"&&(x="fetch-timeout"),fe.create(x,{originalErrorMessage:m?.message})}let u=c.status,d=c.headers.get("ETag")||void 0,p,f;if(c.status===200){let m;try{m=await c.json()}catch(x){throw fe.create("fetch-client-parse",{originalErrorMessage:x?.message})}p=m.entries,f=m.state}if(f==="INSTANCE_STATE_UNSPECIFIED"?u=500:f==="NO_CHANGE"?u=304:(f==="NO_TEMPLATE"||f==="EMPTY_CONFIG")&&(p={}),u!==304&&u!==200)throw fe.create("fetch-status",{httpStatus:u});return{status:u,eTag:d,config:p}}};function mT(r,t){return new Promise((e,i)=>{let s=Math.max(t-Date.now(),0),o=setTimeout(e,s);r.addEventListener(()=>{clearTimeout(o),i(fe.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function gT(r){if(!(r instanceof xr)||!r.customData)return!1;let t=Number(r.customData.httpStatus);return t===429||t===500||t===503||t===504}var Eu=class{constructor(t,e){this.client=t,this.storage=e}async fetch(t){let e=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(t,e)}async attemptFetch(t,{throttleEndTimeMillis:e,backoffCount:i}){await mT(t.signal,e);try{let s=await this.client.fetch(t);return await this.storage.deleteThrottleMetadata(),s}catch(s){if(!gT(s))throw s;let o={throttleEndTimeMillis:Date.now()+lu(i),backoffCount:i+1};return await this.storage.setThrottleMetadata(o),this.attemptFetch(t,o)}}};var yT=60*1e3,xT=12*60*60*1e3,Au=class{constructor(t,e,i,s,o){this.app=t,this._client=e,this._storageCache=i,this._storage=s,this._logger=o,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:yT,minimumFetchIntervalMillis:xT},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}};function ul(r,t){let e=r.target.error||void 0;return fe.create(t,{originalErrorMessage:e&&e?.message})}var _i="app_namespace_store",vT="firebase_remote_config",bT=1;function _T(){return new Promise((r,t)=>{try{let e=indexedDB.open(vT,bT);e.onerror=i=>{t(ul(i,"storage-open"))},e.onsuccess=i=>{r(i.target.result)},e.onupgradeneeded=i=>{let s=i.target.result;switch(i.oldVersion){case 0:s.createObjectStore(_i,{keyPath:"compositeKey"})}}}catch(e){t(fe.create("storage-open",{originalErrorMessage:e?.message}))}})}var Iu=class{constructor(t,e,i,s=_T()){this.appId=t,this.appName=e,this.namespace=i,this.openDbPromise=s}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(t){return this.set("last_fetch_status",t)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(t){return this.set("last_successful_fetch_timestamp_millis",t)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(t){return this.set("last_successful_fetch_response",t)}getActiveConfig(){return this.get("active_config")}setActiveConfig(t){return this.set("active_config",t)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(t){return this.set("active_config_etag",t)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(t){return this.set("throttle_metadata",t)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(t){let e=await this.openDbPromise;return new Promise((i,s)=>{let o=e.transaction([_i],"readonly").objectStore(_i),n=this.createCompositeKey(t);try{let a=o.get(n);a.onerror=l=>{s(ul(l,"storage-get"))},a.onsuccess=l=>{let h=l.target.result;i(h?h.value:void 0)}}catch(a){s(fe.create("storage-get",{originalErrorMessage:a?.message}))}})}async set(t,e){let i=await this.openDbPromise;return new Promise((s,o)=>{let n=i.transaction([_i],"readwrite").objectStore(_i),a=this.createCompositeKey(t);try{let l=n.put({compositeKey:a,value:e});l.onerror=h=>{o(ul(h,"storage-set"))},l.onsuccess=()=>{s()}}catch(l){o(fe.create("storage-set",{originalErrorMessage:l?.message}))}})}async delete(t){let e=await this.openDbPromise;return new Promise((i,s)=>{let o=e.transaction([_i],"readwrite").objectStore(_i),n=this.createCompositeKey(t);try{let a=o.delete(n);a.onerror=l=>{s(ul(l,"storage-delete"))},a.onsuccess=()=>{i()}}catch(a){s(fe.create("storage-delete",{originalErrorMessage:a?.message}))}})}createCompositeKey(t){return[this.appId,this.appName,this.namespace,t].join()}};var Pu=class{constructor(t){this.storage=t}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){let t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),i=this.storage.getActiveConfig(),s=await t;s&&(this.lastFetchStatus=s);let o=await e;o&&(this.lastSuccessfulFetchTimestampMillis=o);let n=await i;n&&(this.activeConfig=n)}setLastFetchStatus(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)}setLastSuccessfulFetchTimestampMillis(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)}setActiveConfig(t){return this.activeConfig=t,this.storage.setActiveConfig(t)}};function wT(){Gr(new ze(Zg,r,"PUBLIC").setMultipleInstances(!0)),ir(su,cg),ir(su,cg,"esm2017");function r(t,{instanceIdentifier:e}){let i=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw fe.create("registration-window");if(!Lu())throw fe.create("indexed-db-unavailable");let{projectId:o,apiKey:n,appId:a}=i.options;if(!o)throw fe.create("registration-project-id");if(!n)throw fe.create("registration-api-key");if(!a)throw fe.create("registration-app-id");e=e||"firebase";let l=new Iu(a,i.name,e),h=new Pu(l),c=new nn(su);c.logLevel=dt.ERROR;let u=new Su(s,J1,e,o,n,a),d=new Eu(u,l),p=new Cu(d,l,h,c),f=new Au(i,p,h,l,c);return dT(f),f}}async function TT(r){return r=zr(r),await pT(r),uT(r)}wT();var gl="analytics",CT="firebase_id",ST="origin",ET=60*1e3,AT="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Gu="https://www.googletagmanager.com/gtag/js";var me=new nn("@firebase/analytics");var IT={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},be=new Ti("analytics","Analytics",IT);function PT(r){if(!r.startsWith(Gu)){let t=be.create("invalid-gtag-resource",{gtagURL:r});return me.warn(t.message),""}return r}function Qg(r){return Promise.all(r.map(t=>t.catch(e=>e)))}function MT(r,t){let e;return window.trustedTypes&&(e=window.trustedTypes.createPolicy(r,t)),e}function RT(r,t){let e=MT("firebase-js-sdk-policy",{createScriptURL:PT}),i=document.createElement("script"),s=`${Gu}?l=${r}&id=${t}`;i.src=e?e?.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}function FT(r){let t=[];return Array.isArray(window[r])?t=window[r]:window[r]=t,t}async function LT(r,t,e,i,s,o){let n=i[s];try{if(n)await t[n];else{let a=(await Qg(e)).find(l=>l.measurementId===s);a&&await t[a.appId]}}catch(a){me.error(a)}r("config",s,o)}async function BT(r,t,e,i,s){try{let o=[];if(s&&s.send_to){let n=s.send_to;Array.isArray(n)||(n=[n]);let a=await Qg(e);for(let l of n){let h=a.find(u=>u.measurementId===l),c=h&&t[h.appId];if(c)o.push(c);else{o=[];break}}}o.length===0&&(o=Object.values(t)),await Promise.all(o),r("event",i,s||{})}catch(o){me.error(o)}}function kT(r,t,e,i){async function s(o,...n){try{if(o==="event"){let[a,l]=n;await BT(r,t,e,a,l)}else if(o==="config"){let[a,l]=n;await LT(r,t,e,i,a,l)}else if(o==="consent"){let[a]=n;r("consent","update",a)}else if(o==="get"){let[a,l,h]=n;r("get",a,l,h)}else if(o==="set"){let[a]=n;r("set",a)}else r(o,...n)}catch(a){me.error(a)}}return s}function OT(r,t,e,i,s){let o=function(...n){window[i].push(arguments)};return window[s]&&typeof window[s]=="function"&&(o=window[s]),window[s]=kT(o,r,t,e),{gtagCore:o,wrappedGtag:window[s]}}function DT(r){let t=window.document.getElementsByTagName("script");for(let e of Object.values(t))if(e.src&&e.src.includes(Gu)&&e.src.includes(r))return e;return null}var NT=30,UT=1e3,Mu=class{constructor(t={},e=UT){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}},Jg=new Mu;function GT(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function zT(r){var t;let{appId:e,apiKey:i}=r,s={method:"GET",headers:GT(i)},o=AT.replace("{app-id}",e),n=await fetch(o,s);if(n.status!==200&&n.status!==304){let a="";try{let l=await n.json();!((t=l.error)===null||t===void 0)&&t.message&&(a=l.error.message)}catch{}throw be.create("config-fetch-failed",{httpStatus:n.status,responseMessage:a})}return n.json()}async function jT(r,t=Jg,e){let{appId:i,apiKey:s,measurementId:o}=r.options;if(!i)throw be.create("no-app-id");if(!s){if(o)return{measurementId:o,appId:i};throw be.create("no-api-key")}let n=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Ru;return setTimeout(async()=>{a.abort()},e!==void 0?e:ET),ty({appId:i,apiKey:s,measurementId:o},n,a,t)}async function ty(r,{throttleEndTimeMillis:t,backoffCount:e},i,s=Jg){var o;let{appId:n,measurementId:a}=r;try{await VT(i,t)}catch(l){if(a)return me.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l?.message}]`),{appId:n,measurementId:a};throw l}try{let l=await zT(r);return s.deleteThrottleMetadata(n),l}catch(l){let h=l;if(!HT(h)){if(s.deleteThrottleMetadata(n),a)return me.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:n,measurementId:a};throw l}let c=Number((o=h?.customData)===null||o===void 0?void 0:o.httpStatus)===503?lu(e,s.intervalMillis,NT):lu(e,s.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:e+1};return s.setThrottleMetadata(n,u),me.debug(`Calling attemptFetch again in ${c} millis`),ty(r,u,i,s)}}function VT(r,t){return new Promise((e,i)=>{let s=Math.max(t-Date.now(),0),o=setTimeout(e,s);r.addEventListener(()=>{clearTimeout(o),i(be.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function HT(r){if(!(r instanceof xr)||!r.customData)return!1;let t=Number(r.customData.httpStatus);return t===429||t===500||t===503||t===504}var Ru=class{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}};async function $T(r,t,e,i,s){if(s&&s.global){r("event",e,i);return}else{let o=await t,n=Object.assign(Object.assign({},i),{send_to:o});r("event",e,n)}}async function XT(){if(Lu())try{await Cg()}catch(r){return me.warn(be.create("indexeddb-unavailable",{errorInfo:r?.toString()}).message),!1}else return me.warn(be.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function WT(r,t,e,i,s,o,n){var a;let l=jT(r);l.then(p=>{e[p.measurementId]=p.appId,r.options.measurementId&&p.measurementId!==r.options.measurementId&&me.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>me.error(p)),t.push(l);let h=XT().then(p=>{if(p)return i.getId()}),[c,u]=await Promise.all([l,h]);DT(o)||RT(o,c.measurementId),s("js",new Date);let d=(a=n?.config)!==null&&a!==void 0?a:{};return d[ST]="firebase",d.update=!0,u!=null&&(d[CT]=u),s("config",c.measurementId,d),c.measurementId}var Fu=class{constructor(t){this.app=t}_delete(){return delete on[this.app.options.appId],Promise.resolve()}},on={},pg=[],fg={},ou="dataLayer",YT="gtag",mg,ey,gg=!1;function qT(){let r=[];if(Q_()&&r.push("This is a browser extension environment."),J_()||r.push("Cookies are not available."),r.length>0){let t=r.map((i,s)=>`(${s+1}) ${i}`).join(" "),e=be.create("invalid-analytics-context",{errorInfo:t});me.warn(e.message)}}function KT(r,t,e){qT();let i=r.options.appId;if(!i)throw be.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)me.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw be.create("no-api-key");if(on[i]!=null)throw be.create("already-exists",{id:i});if(!gg){FT(ou);let{wrappedGtag:s,gtagCore:o}=OT(on,pg,fg,ou,YT);ey=s,mg=o,gg=!0}return on[i]=WT(r,pg,fg,t,mg,ou,e),new Fu(r)}function ZT(r=Ig()){r=zr(r);let t=ln(r,gl);return t.isInitialized()?t.getImmediate():QT(r)}function QT(r,t={}){let e=ln(r,gl);if(e.isInitialized()){let i=e.getImmediate();if(pl(t,e.getOptions()))return i;throw be.create("already-initialized")}return e.initialize({options:t})}function rn(r,t,e,i){r=zr(r),$T(ey,on[r.app.options.appId],t,e,i).catch(s=>me.error(s))}var yg="@firebase/analytics",xg="0.10.0";function JT(){Gr(new ze(gl,(t,{options:e})=>{let i=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();return KT(i,s,e)},"PUBLIC")),Gr(new ze("analytics-internal",r,"PRIVATE")),ir(yg,xg),ir(yg,xg,"esm2017");function r(t){try{let e=t.getProvider(gl).getImmediate();return{logEvent:(i,s,o)=>rn(e,i,s,o)}}catch(e){throw be.create("interop-component-reg-failed",{reason:e})}}}JT();var tC='[{"id":"bs2d-6","show":"BubbleShooter2d","when":"onLevelEnd","levels":[10,30]},{"id":"bs2d-dog-1","from":"BubbleShooter2d","show":"DogEscape","when":"onLevelEnd","levels":[5,20,50]}]',eC=`[
  {
    "id": "BubbleShooter2d",
    "title": "Glossy Bubble Challenge",
    "url": "https://yandex.ru/games/app/268294",
    "icon": "bubble-icon.png",
    "cover": "buble-cover.jpg"
  },
  {
    "id": "DogEscape",
    "title": "Dog Escape",
    "url": "https://yandex.com/games/app/255645",
    "icon": "dogescape-icon.png",
    "cover": "dogescape-cover.jpg"
  },
  {
    "id": "WeaponWars",
    "title": "Weapon Wars",
    "url": "https://yandex.com/games/app/268058",
    "icon": "weaponwars-icon.png",
    "cover": "weaponwars-cover.jpg"
  }
]`,rC={single:tC,all:eC},yl=class{constructor(){wt(this,"container"),wt(this,"content")}};function iC(r,t,e,i,s){let o=document.createElement("div");o.setAttribute("class","item");let n=document.createElement("img");n.setAttribute("src",e+"img/cover/"+r.cover);let a=document.createElement("button");a.setAttribute("class","play-btn"),a.innerHTML=s.localize("play"),a.onclick=()=>{window.open(s.resolveDomain(r.url),"_blank"),i(r.id)},o.appendChild(n),o.appendChild(a),t.appendChild(o)}var dl=class Os{constructor(){wt(this,"lang"),wt(this,"domain")}setContext(t){console.log(t),this.lang=t.i18n.lang,this.domain=t.i18n.tld,console.log("GameFuse Lang:"+this.lang),console.log("GameFuse Domain:"+this.domain)}localize(t){let e=Os.Words[t+"-"+this.lang];return console.log(t+this.lang+" :"+e),e==null&&(e=Os.Words[t+"-"+Os.defaultLang],console.log(t+Os.defaultLang+" :"+e)),e}resolveDomain(t){let e=this.domain!=null?this.domain:Os.defaultDomain;return t.replace("yandex.com","yandex."+e)}};wt(dl,"Words",{"play-en":"Play","play-ru":"\u0418\u0433\u0440\u0430\u0442\u044C","more-en":"More Games","more-ru":"\u0411\u043E\u043B\u044C\u0448\u0435 \u0438\u0433\u0440"}),wt(dl,"defaultLang","en"),wt(dl,"defaultDomain","com");var sC=dl,vg={apiKey:"AIzaSyDDLHPj-rb7QtuQVNNH43zZomBRh9945eI",authDomain:"game-fuse-e54ee.firebaseapp.com",projectId:"game-fuse-e54ee",storageBucket:"game-fuse-e54ee.appspot.com",messagingSenderId:"944870108663",appId:"1:944870108663:web:40e3cf0562dc7811dcd2f2",measurementId:"G-6C21JSMX0K"},oC="modal-all",nC="modal-single",xl=class{constructor(){wt(this,"analytics"),wt(this,"remoteConfig"),wt(this,"popupAll",new yl),wt(this,"popupSingle",new yl),wt(this,"host"),wt(this,"currentGame"),wt(this,"allEntries"),wt(this,"singleEntries"),wt(this,"currentSingle"),wt(this,"showCallback"),wt(this,"isSetup",!1),wt(this,"retryTime",5e3),wt(this,"retryCount",0),wt(this,"localization",new sC),wt(this,"container")}setup(t){if(this.isSetup)return;this.isSetup=!0,this.currentGame=t;let e=Ag(vg),i=ZT(e);this.analytics=i;let s=cT(e);this.remoteConfig=s,s.settings.minimumFetchIntervalMillis=36e5,s.defaultConfig=rC,this.setConfigValues(),this.fetchConfig();let o="https://"+vg.projectId+".web.app/";this.host=o;let n=o+"gamefuse.css";this.injectCSS(n);let a=document.createElement("div");this.container=a,a.hidden=!0,a.setAttribute("id","gf-ui"),this.popupAll.container=a.appendChild(this.createModal(this.popupAll,oC)),this.popupSingle.container=a.appendChild(this.createModal(this.popupSingle,nC,!0)),document.body.append(a)}setConfigValues(){this.allEntries=JSON.parse(dg(this.remoteConfig,"all").asString()),this.singleEntries=JSON.parse(dg(this.remoteConfig,"single").asString())}fetchConfig(){try{TT(this.remoteConfig).then(()=>{this.setConfigValues()}).catch(()=>{this.fetchRetry()})}catch{this.fetchRetry()}}fetchRetry(){this.retryCount++,setTimeout(this.fetchConfig.bind(this),this.retryCount*this.retryTime)}onListItemClick(t){rn(this.analytics,"open_link",{from:this.currentGame,to:t,via:"MoreGames"})}onSingleItemClick(){this.currentSingle&&rn(this.analytics,"open_link",{from:this.currentGame,to:this.currentSingle.show,via:"Popup"})}onAllCloseClick(){this.popupAll.container.classList.remove("active"),rn(this.analytics,"close_more_games",{from:this.currentGame})}onSingleCloseClick(){this.currentSingle=void 0,this.popupSingle.container.classList.remove("active"),rn(this.analytics,"close_single",{from:this.currentGame}),this.showCallback()}showAll(){if(!this.isSetup)return;this.container.hidden=!1;let t=this.allEntries,e=this.popupAll.content;for(;e.firstChild;)e.removeChild(e.firstChild);let i=document.createElement("div");i.setAttribute("class","close-btn"),i.onclick=()=>{this.onAllCloseClick()};let s=document.createElement("h2");s.innerText=this.localization.localize("more"),e.appendChild(i),e.appendChild(s);let o=document.createElement("div");o.setAttribute("class","list"),t.forEach(n=>{n.id.trim()!=this.currentGame.trim()&&iC(n,o,this.host,this.onListItemClick.bind(this),this.localization)}),e.appendChild(o),this.popupAll.container.classList.add("active")}showPopup(t,e,i){if(!this.isSetup){i();return}this.container.hidden=!1,this.showCallback=i;let s=this.singleEntries.filter(f=>f.when==t.trim()),o=-1;for(let f=0;f<s.length;f++){let m=s[f];if(!(m.show.trim()==this.currentGame.trim()||!(m.from==null||m.from.trim()==this.currentGame.trim()))){if(m.levels!=null)for(let x=0;x<m.levels.length;x++){if(e<m.levels[x])continue;let y=m.id+m.levels[x].toString();if(localStorage.getItem(y)==null){o=f,localStorage.setItem(y,"true");break}}else if(localStorage.getItem(m.id)==null){localStorage.setItem(m.id,"true"),o=f;break}if(o>=0)break}}if(o<0){this.showCallback();return}let n=s[o];this.currentSingle=n;let a=this.popupSingle.content;for(;a.firstChild;)a.removeChild(a.firstChild);let l=document.createElement("div");l.setAttribute("class","close-btn"),l.onclick=()=>{this.onSingleCloseClick()};let h=document.createElement("img");h.setAttribute("class","cover"),a.appendChild(l),a.appendChild(h);let c=document.createElement("div");c.setAttribute("class","cover-info");let u=document.createElement("img");u.setAttribute("class","icon");let d=document.createElement("h3"),p=this.allEntries.find(f=>f.id.trim()==n.show.trim());if(a.appendChild(c),c.appendChild(u),c.appendChild(d),p){h.setAttribute("src",this.host+"img/cover/"+p.cover),u.setAttribute("src",this.host+"img/icon/"+p.icon),d.innerText=p.title;let f=document.createElement("button");f.setAttribute("class","play-btn"),f.innerHTML=this.localization.localize("play"),f.onclick=()=>{window.open(this.localization.resolveDomain(p.url),"_blank"),this.onSingleItemClick()},c.appendChild(f)}this.popupSingle.container.classList.add("active")}setLocalization(t){this.localization.setContext(t)}injectCSS(t){let e=document.createElement("link");e.rel="stylesheet",e.type="text/css",e.href=t,document.head.appendChild(e)}createModal(t,e,i=!1){let s=document.createElement("section");s.setAttribute("id",e),s.setAttribute("class","modal"+(i?" single":""));let o=document.createElement("div");return o.setAttribute("class","popup"),t.content=s.appendChild(o),s}};var zu=class{level=0;gameLevelKey="cars-n-guns-level-key";gf;setup(t){console.log("promo setup");let e=localStorage.getItem(this.gameLevelKey);e?this.level=Number.parseInt(e):this.processLevel(),this.gf=new xl,this.gf.setup(t)}processLevel(){this.level++,localStorage.setItem(this.gameLevelKey,this.level.toString())}showMoreGames(){this.gf.showAll()}showPopup(t,e){t=="onLevelStart"&&this.processLevel(),this.gf.showPopup(t,this.level,e)}},aC=new zu,jr=aC;var _l=class extends I{titleContainer;titleBg;titleText;repCounter;moneyCounter;continueButton;constructor(t,e,i){super(),this.titleContainer=new I,this.titleBg=new C(b.from("panel-end")),this.titleBg.anchor.set(.5,0),this.titleText=new J(F.getText(t?"Victory":"Defeat").toUpperCase(),{fontFamily:F.font,fontSize:144,fill:16777215,align:"center",strokeThickness:4,stroke:4134513}),this.titleText.anchor.set(.5),this.titleText.y=this.titleBg.height/2,this.repCounter=new cl,this.repCounter.updateValue(i.data.reputation),this.moneyCounter=new Ht("Money"),this.moneyCounter.scale.set(1.5),this.moneyCounter.updateValue(i.data.money),this.continueButton=new yt(F.getText("Continue").toUpperCase(),b.from("btn-green"),{fontFamily:F.font,fontSize:72,fill:84798,align:"center"}),this.continueButton.on("pointerdown",()=>{e.adsManager.showInterstitial(),ot.emit("START_MENU"),jr.showPopup("onLevelEnd",()=>{})}),this.titleContainer.addChild(this.titleBg),this.titleContainer.addChild(this.titleText),this.addChild(this.repCounter),this.addChild(this.moneyCounter),this.addChild(this.titleContainer),this.addChild(this.continueButton),this.positionElements()}positionElements(){this.titleContainer.position.set(P.width/2,0),this.repCounter.position.set(P.width/2,P.height/2),this.moneyCounter.position.set(P.width/2,P.height-550),this.continueButton.position.set(P.width/2,P.height-250)}};var Ds=class extends C{constructor(){super(b.WHITE),new C,this.scale.set(P.width/this.texture.width,P.height/this.texture.height),this.tint=0,this.alpha=.8,this.anchor.set(.5),this.eventMode="static",this.on("pointerdown",t=>t.stopImmediatePropagation())}};var wl=class extends I{overlay;info;bg;title;countdownText;countdownValue=5;countdown;button;onTimeUp;onContinue;constructor(t,e){super(),this.onContinue=t,this.onTimeUp=e,this.overlay=new Ds,this.info=new I,this.bg=new C(b.from("panel-continue")),this.bg.anchor.set(.5),this.title=new J(F.getText("Continue?"),{fontFamily:F.font,fill:16777215,fontSize:144,stroke:1386821,strokeThickness:16}),this.title.anchor.set(.5),this.countdownText=new J(this.countdownValue.toString(),{fontFamily:F.font,dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#16306d",dropShadowDistance:10,fill:["#ecf2ff","#b8ccff"],fillGradientStops:[.4],fontSize:144*3,stroke:"#3967d0"}),this.countdownText.anchor.set(.5),this.button=new yt(F.getText("Yes").toUpperCase(),b.from("btn-orange"),{fontFamily:F.font,fontSize:72}),this.button.on("pointerdown",()=>{this.countdown.stop(),this.onContinue()});let i=new C(b.from("icon-video"));i.anchor.set(.5),this.button.addChild(i),i.x-=120,this.button.text.x+=50,this.addChild(this.overlay),this.addChild(this.info),this.info.addChild(this.bg),this.info.addChild(this.title),this.info.addChild(this.countdownText),this.addChild(this.button),this.positionElements(),this.startCounting(4)}startCounting(t){this.countdown=new at(this.countdownText).from({alpha:1}).to({alpha:0},1e3).start().repeat(t).easing(it.Quadratic.In).onRepeat(()=>{this.countdownText.text=(--this.countdownValue).toString()}).onComplete(()=>this.onTimeUp())}positionElements(){this.info.position.set(0,-170),this.title.position.set(0,-this.bg.height/2+10),this.countdownText.position.set(0,10),this.button.position.set(0,350)}};var mt={roadWidth:5,timeDilation:8,enemySpeed:.1,scrollSpeed:1,timeToBossMS:5e3,collisionDamageToPlayer:10,projectileDamageToPlayer:15,mysteryCarPeriodMS:14e3},Tl=class extends I{game;slowed=!0;paused=!0;race;road;projectiles;explosions;pickups;threatSpawner;pickupSpawner;bossCar;playerCar;steering;globalMousePos;progress;ui;pauseScreen;level=1;isOver=!1;stopped=!1;bossReady=!1;revivedOnce=!1;moneyMultiplier=1;moneyMultiplierRemainingTimeMS=0;magnetRemainingTimeMS=0;constructor(t,e,i){super(),this.game=t,this.progress=e,this.game.audio.playSound(`engine_start_${rr(1,3)}`),this.race=new I,this.projectiles=new I,this.explosions=new I,this.pickups=new I,this.road=i||new Ns,this.playerCar=new _s(e.data.selectedCar,e.getCarUpgrades()),this.threatSpawner=new Ja(this.road),this.pickupSpawner=new Ha,this.bossCar=new il(this.level),this.bossCar.setTarget(this.playerCar),this.bossCar.visible=!1,this.ui=new nl,this.ui.setMoney(this.progress.data.money),this.ui.setReputation(this.progress.data.reputation),this.pauseScreen=new hl,mt.scrollSpeed=1,this.playerCar.guns.forEach(s=>s.onFire.add(o=>{this.game.audio.playSound("projectile"),o.forEach(n=>{let a=this.toLocal({x:this.playerCar.position.x+s.body.x+n.x,y:this.playerCar.position.y+s.body.y+n.y});this.projectiles.addChild(n),n.position.set(a.x*this.scale.x,a.y*this.scale.y)})})),this.bossCar.gun.onFire.add(s=>{s.forEach(o=>{o.position.copyFrom(this.toLocal(this.position,o)),this.projectiles.addChild(o)})}),this.addChild(this.race),this.race.addChild(this.road),this.race.addChild(this.threatSpawner.container),this.race.addChild(this.playerCar),this.race.addChild(this.bossCar),this.race.addChild(this.explosions),this.race.addChild(this.pickups),this.race.addChild(this.projectiles),this.addChild(this.ui),this.steering=new $a(this.playerCar),this.steering.setBounds(-2,2),this.eventMode="static",ot.on("BOSS_APPEAR",()=>this.spawnBoss()),this.on("pointerdown",s=>{s.preventDefault(),this.globalMousePos=s.global,this.steering.start(s.global),this.unpause(),this.playerCar.setFiringPermission(!It.disablePlayerGun)}),this.on("pointermove",s=>{s.preventDefault(),this.globalMousePos=s.global}),this.on("pointerup",s=>{s.preventDefault(),this.steering.stop(),this.pause(),this.playerCar.setFiringPermission(!1)}),this.on("pointerupoutside",s=>{s.preventDefault(),this.steering.stop(),this.pause(),this.playerCar.setFiringPermission(!1)}),t.ticker.add(this.update,this),It.manualRaceEnd&&document.addEventListener("keydown",this.debugControls.bind(this)),new at(this.playerCar).from({y:P.height+this.playerCar.height}).to({y:this.getPlayerCarDefaultY()},600).easing(it.Quadratic.Out).onComplete(()=>{this.pause(!0)}).start()}debugControls(t){switch(t.key){case"o":this.gameOver();break}}resize(){this.pickups.position.x=this.road.x,this.explosions.position.x=this.road.x,this.threatSpawner.container.x=this.road.x}pause(t=!1){(!this.stopped&&!this.paused||t)&&(this.paused=!0,this.slowed=!0,this.pauseScreen.tweenShow(),this.addChild(this.pauseScreen))}unpause(){!this.stopped&&this.paused&&(this.paused=!1,this.slowed=!1,this.removeChild(this.pauseScreen))}update(){if(ui.shared.update(this.game.ticker.deltaMS),this.stopped)return;this.steering.active&&this.steering.update(this.globalMousePos);let t=this.slowed?this.game.ticker.deltaMS/mt.timeDilation:this.game.ticker.deltaMS;this.threatSpawner.bossMode||(mt.scrollSpeed+=t*1e-5),this.ui.setProgress((mt.timeToBossMS-this.threatSpawner.timeToBossMS)/mt.timeToBossMS),this.threatSpawner.update(t),this.moneyMultiplier!=1&&(this.moneyMultiplierRemainingTimeMS-=t,this.playerCar.moneyEffect.visible=!0,this.moneyMultiplierRemainingTimeMS<=0&&(this.moneyMultiplier=1,this.playerCar.moneyEffect.visible=!1)),this.magnetRemainingTimeMS>0?(this.playerCar.magnetEffect.visible=!0,this.magnetRemainingTimeMS-=t):this.playerCar.magnetEffect.visible=!1,this.isOver||(this.road.update(t),this.explosions.children.forEach(i=>{i.y+=mt.scrollSpeed*t})),this.threatSpawner.activeObstacles.forEach(i=>{if(i.y+=mt.scrollSpeed*t,i.getBounds().top>P.height){this.threatSpawner.releaseObstacle(i);return}this.isOver||this.detectOverlap(i.hitbox.getBounds(),this.playerCar.body.getBounds())&&this.setPlayerHealth(0)}),this.bossReady&&(this.bossCar.update(t),this.playerCar.guns.forEach(i=>i.projectiles.activeInstances.forEach(s=>{this.detectOverlap(s.getBounds(),this.bossCar.getBounds())&&(i.projectiles.release(s),this.bossCar.takeDamage(i.getProjectileDamage()),this.bossCar.health<=0&&this.defeatBoss())})),this.bossCar.gun.projectiles.activeInstances.forEach(i=>{this.detectOverlap(i.getBounds(),this.playerCar.body.getBounds())&&(this.bossCar.gun.projectiles.release(i),this.setPlayerHealth(this.playerCar.health-mt.projectileDamageToPlayer))}),this.updateBossCarPosition()),this.bossCar.gun.update(t),this.threatSpawner.activeEnemies.forEach(i=>{if(i.position.y+=(mt.scrollSpeed-mt.enemySpeed)*t,i.position.y>P.height+i.height){this.threatSpawner.releaseEnemy(i);return}this.playerCar.guns.forEach(s=>s.projectiles.activeInstances.forEach(o=>{this.detectOverlap(o.getBounds(),i.getBounds())&&(s.projectiles.release(o),i.takeDamage(s.getProjectileDamage()),i.health<=0&&this.onPlayerKillEnemy(i))})),this.isOver||this.detectOverlap(i.getBounds(),this.playerCar.body.getBounds())&&(this.onPlayerKillEnemy(i),this.setPlayerHealth(this.playerCar.health-mt.collisionDamageToPlayer))});let e=this.road.getDriveableBounds();this.pickupSpawner.pickups.activeInstances.forEach(i=>{i.applyGravity(t),this.magnetRemainingTimeMS>0&&i.applyMagnet(this.playerCar,t),i.move(t);let s=i.getBounds();if(i.bounceOffRoadBorders(e,s),s.top>P.height&&this.pickupSpawner.pickups.release(i),this.detectOverlap(this.playerCar.body.getBounds(),s)){switch(i.kind){case"MoneyBill":this.collectMoney(1*this.moneyMultiplier);break;case"MoneyStack":this.collectMoney(10*this.moneyMultiplier);break;case"Health":this.game.audio.playSound("power_up_4"),this.playerCar.resetHP(this.progress.getCarUpgrade("armor")),this.onPlayerHealthUpdate(),this.playerCar.hpEffect.visible=!0,this.playerCar.hpEffect.alpha=.8,this.playerCar.hpEffect.gotoAndPlay(0),this.playerCar.hpEffect.onComplete=()=>{this.playerCar.hpEffect.visible=!1};break;case"Magnet":this.game.audio.playSound("power_up_5"),this.magnetRemainingTimeMS=Va.Magnet.durationMS;break;case"MoneyX2":this.game.audio.playSound("power_up_4"),this.moneyMultiplier=2,this.moneyMultiplierRemainingTimeMS=Va.MoneyX2.durationMS;break}this.pickupSpawner.pickups.release(i)}}),this.playerCar.updateGuns(t),this.isOver||this.updatePlayerCarPosition()}detectOverlap(t,e){let i=t.right>=e.left&&e.right>=t.left,s=t.bottom>=e.top&&e.bottom>=t.top;return i&&s}onPlayerKillEnemy(t){if(t.dead)return;t.dead=!0;let e=this.pickupSpawner.getFromEnemy(Ko[t.kind]);e&&(e.position.copyFrom(t.position),this.pickups.addChild(e)),this.game.audio.playSound(`explosion_${rr(1,4)}`),t.kind=="fuel"?(this.showExplosion(t.position,2),this.explodeFuelTank(t)):this.showExplosion(t.position),this.increaseReputation(Ko[t.kind].rep),this.threatSpawner.releaseEnemy(t)}explodeFuelTank(t){this.threatSpawner.activeEnemies.forEach(e=>{if(t!=e){let i=Km(t.position,e.position);if(i<yr.maxRadius){let s=Es.getFuelExplosionDamage(i);e.takeDamage(s),e.health<=0&&this.onPlayerKillEnemy(e)}}})}setPlayerHealth(t){It.playerInvulnerable||(this.playerCar.health=Math.max(0,t),this.onPlayerHealthUpdate())}onPlayerHealthUpdate(){this.ui.setHealth(this.playerCar.health/this.playerCar.getMaxHealth(this.progress.getCarUpgrade("armor"))),this.playerCar.health<=0&&(this.game.audio.playSound("player_car_crash"),this.gameOver())}collectMoney(t){this.game.audio.playSound(`money_collect_${rr(2,4)}`),this.progress.data.money+=t,this.progress.saveLocal(),this.ui.setMoney(this.progress.data.money)}increaseReputation(t){this.progress.data.reputation+=t,this.progress.saveLocal(),this.ui.setReputation(this.progress.data.reputation)}spawnBoss(){this.bossCar.revive(this.level),this.bossCar.visible=!0,this.bossCar.roadX=0,this.bossCar.position.set(P.width/2,-this.bossCar.height);let t=new al(this.bossCar.getRewardForLevel(this.level));t.alpha=0,t.position.set(-t.width,P.height/2),this.addChild(t);let e=new at(t).to({alpha:1},300).easing(it.Quadratic.InOut),i=new at(t).from({x:-t.width}).to({x:P.width/2},400).easing(it.Back.Out),s=new at(t).to({x:P.width+t.width},400).easing(it.Back.In).onComplete(()=>{this.removeChild(t),t.destroy({children:!0})}),o=new at(this.bossCar.position).to({y:this.bossCar.body.height/2+200},1e3).onStart(()=>{this.game.audio.playSound(`engine_start_${rr(1,3)}`)}).onComplete(()=>{this.bossReady=!0,this.bossCar.gun.canFire=!0});this.game.audio.playSound("ui_menu_whoosh"),e.start(),i.start().onComplete(()=>{s.start(1200),o.start(600)})}defeatBoss(){this.bossCar.gun.projectiles.activeInstances.forEach(o=>this.bossCar.gun.projectiles.release(o));let t=new ll(this.bossCar.getRewardForLevel(this.level)),e=new at(t).to({alpha:1},300).easing(it.Quadratic.InOut),i=new at(t).from({x:-t.width}).to({x:P.width/2},400).easing(it.Back.Out),s=new at(t).to({x:P.width+t.width},400).easing(it.Back.In).onComplete(()=>{this.removeChild(t),t.destroy({children:!0})});e.start(),i.start().onComplete(()=>{s.start(1200)}),t.alpha=0,t.position.set(-t.width,P.height/2),this.addChild(t),this.collectMoney(this.bossCar.getRewardForLevel(this.level)),this.level++,this.threatSpawner.bossMode=!1,this.threatSpawner.resetTimers(2e3),this.game.audio.playSound(`explosion_${rr(1,4)}`),this.showExplosion(this.bossCar.position,2.5),this.bossCar.visible=!1,this.bossCar.gun.canFire=!1,this.bossReady=!1,this.threatSpawner.disableBossMode()}updatePlayerCarPosition(){let t=P.width/2+this.playerCar.roadX*this.getRoadPxPerUnit();this.playerCar.position.x=t}getPlayerCarDefaultY(){return P.height-this.playerCar.height/2-50}updateBossCarPosition(){let t=P.width/2+this.bossCar.roadX*this.getRoadPxPerUnit(),e=this.bossCar.body.height/2+200;this.bossCar.position.set(t,e)}getRoadPxPerUnit(){return this.road.width*.75/mt.roadWidth}getExplosionAnim(t,e,i,s,o){let n=pe.get(t),a=new di(n.animations[e]);return a.anchor.set(.5),a.scale.set(s),a.alpha=i,a.position.copyFrom(o),a.loop=!1,a.animationSpeed=.5,a.play(),a.onComplete=()=>{a.parent.removeChild(a)},a}showExplosion(t,e=1.5,i){let s=this.getExplosionAnim("mc","explosion",1,e,t);s.rotation=Math.random()*Math.PI;let o=this.getExplosionAnim("explosion","explosion",1,e,t);i&&(s.onFrameChange=n=>{n>s.totalFrames*i&&s.stop()},o.onFrameChange=n=>{n>s.totalFrames*i&&o.stop()}),o.blendMode=j.SCREEN,this.explosions.addChild(s),this.explosions.addChild(o)}gameOver(){if(this.stopped=!0,this.removeChild(this.pauseScreen),!this.revivedOnce&&!It.noRevive){let t=!1,e=new wl(()=>{this.game.adsManager.showRewarded(()=>{t?(this.removeChild(e),this.revivedOnce=!0,this.threatSpawner.clearThreats(),this.threatSpawner.resetTimers(2e3),this.stopped=!1,this.setPlayerHealth(this.playerCar.getMaxHealth(this.progress.getCarUpgrade("armor")))):(this.removeChild(e),this.trueGameOver())},()=>{t=!0})},()=>{this.removeChild(e),this.trueGameOver()});e.position.set(P.width/2,P.height/2),this.addChild(e)}else this.trueGameOver()}trueGameOver(){this.isOver=!0,this.playerCar.visible=!1,this.showExplosion(this.playerCar.position,1.5,.4),this.removeChild(this.ui),this.removeListeners(),this.removeChild(this.pauseScreen);let t=P.width/2+(this.playerCar.x-P.width/2),e=P.height;this.steering.stop(),this.race.pivot.set(t,e),this.race.position.set(this.race.position.x+t,this.race.position.y+e),new at(this.race.scale).to({x:this.race.scale.x*2,y:this.race.scale.y*2},600).start(),new at(this.race).to({angle:-30},600).easing(it.Sinusoidal.InOut).onComplete(()=>{this.game.ticker.remove(this.update,this),this.game.audio.stopMusic(),this.game.leaderboardsManager&&this.game.leaderboardsManager.setPlayerEntry(tr.name,this.progress.data.reputation,!0).then(i=>{console.log(i)}).catch(i=>{console.error("Error when setting player lb data",i)}),this.addChild(new _l(!1,this.game,this.progress))}).start()}destroy(t){this.game.ticker.remove(this.update,this),this.removeListeners(),this.playerCar.guns.forEach(e=>e.onFire.removeAll()),this.bossCar.gun.onFire.removeAll(),this.threatSpawner.clearSignals(),super.destroy(t)}removeListeners(){this.off("pointerdown"),this.off("pointerup"),this.off("pointermove"),this.off("pointeroutside"),document.removeEventListener("keydown",this.debugControls)}};var lC=["Crack-Left","Crack-Right","Crack-Center"],hn=class r extends C{type;constructor(){super()}static create(){let t=new r;return t.anchor.set(.5),r.reset(t),t}static reset(t){switch(t.type=r.getRandomType(),t.texture=b.from(t.type),t.type){case"Crack-Left":t.x=-320;break;case"Crack-Right":t.x=320;break;case"Crack-Center":{t.x=Math.random()*500-500/2;break}}t.y=0}static getRandomType(){return Ut([...lC],[30,30,40])}};var ry=[10],cn=class r extends C{constructor(){super()}static create(){let t=new r;return t.anchor.set(.5),t.scale.set(.5),r.reset(t),It.disableShadows||(t.filters=[new fi({blur:1,offset:{x:-4,y:2}})]),t}static reset(t){let e=r.getRandomId();r.resetGraphics(t,e),r.resetPosition(t,e)}static resetGraphics(t,e){t.texture=b.from(`Obs-${e}`)}static resetPosition(t,e){Math.random()>.5?(t.x=-475,e==10&&(t.scale.x=-Math.abs(t.scale.x),t.x+=25)):(t.x=475,e==10&&(t.x-=25,t.scale.x=Math.abs(t.scale.x))),t.y=-t.height}static getRandomId(){return Ut([...ry],Array(ry.length).fill(1))}};var Jt={laneCount:5,heightOffset:10,minCrackPeriod:2e3,maxCrackPeriod:4e3,linePeriod:350,driveable:.75},Ns=class extends I{lanes;bgPt1;bgPt2;crackTimer=0;lineTimer=0;timeTillCrack=Jt.minCrackPeriod;cracks=new Nt(hn.create,hn.reset,t=>{});lines=new Nt(()=>{let t=new C(b.from("Road-Lines"));return t.anchor.set(.5,0),t.position.set(0,-t.height),t.alpha=Math.random()*.8+.1,t},t=>{t.position.set(0,-t.height),t.alpha=Math.random()*.6+.2},t=>{t.destroy()});obstacles=new Nt(cn.create,cn.reset,t=>{});roadTiles;constructor(){super(),this.clearLanes(),this.roadTiles=[new C(b.from("road")),new C(b.from("road")),new C(b.from("road"))],this.roadTiles.forEach((t,e)=>{t.anchor.set(.5,0),t.y=t.height*e,this.addChild(t)}),this.addChild(this.cracks.getInstance());for(let t=0;t<6;t++){let e=this.lines.getInstance();e.position.y+=t*400,this.addChild(e)}}listObstacles(){let t=0,e=0,i=0;for(let s=1;s<=11;s++){let o=new C(b.from(`Obs-${s}`));o.scale.set(.5),o.position.set(t,e),o.height>i&&(i=o.height),t+=o.width,t>500&&(t=0,e+=i,i=0),this.addChild(o)}}clearLanes(){this.lanes=new Array(Jt.laneCount).fill(0)}scrollRoadTile(t,e,i,s){t.y>P.height&&(t.y=this.roadTiles[(this.roadTiles.length+(e-1))%this.roadTiles.length].y-t.texture.height+Jt.heightOffset),t.y+=mt.scrollSpeed*i}update(t){let e=iy().height;this.roadTiles.forEach((i,s)=>{this.scrollRoadTile(i,s,t,e)}),this.crackTimer+=t,this.crackTimer>this.timeTillCrack&&(this.crackTimer-=this.timeTillCrack,this.timeTillCrack=Math.random()*(Jt.maxCrackPeriod-Jt.minCrackPeriod)+Jt.minCrackPeriod,this.addChild(this.cracks.getInstance()),this.addChild(this.obstacles.getInstance())),this.lineTimer+=t,this.lineTimer>Jt.linePeriod&&(this.lineTimer-=Jt.linePeriod,this.addChild(this.lines.getInstance())),this.lines.activeInstances.forEach(i=>{i.y+=mt.scrollSpeed*t}),this.obstacles.activeInstances.forEach(i=>{i.y+=mt.scrollSpeed*t,i.getBounds().top>e&&this.obstacles.release(i)}),this.cracks.activeInstances.forEach(i=>{i.y+=mt.scrollSpeed*t,i.getBounds().top>e&&this.cracks.release(i)})}decreaseLaneOccupancy(t){this.lanes[t]--}increaseLaneOccupancy(t){this.lanes[t]++}getFreeLane(){let t=this.lanes.map((s,o)=>o),e=this.lanes.map(s=>s>0?0:1);return Ut(t,e)}getRandomLane(){return Math.floor(Math.random()*Jt.laneCount)}getLaneX(t){t=t??this.getRandomLane();let e=P.width*Jt.driveable,i=(P.width-e)/2,s=e/Jt.laneCount;return i+t*s+s/2}getDriveableBounds(){let t=this.getBounds(!1,new $),e=t.width;return t.width*=Jt.driveable,t.x+=(e-t.width)/2,t}};var hC={fontSize:36,fill:16777215,stroke:1849961,strokeThickness:8};function ju(r,t){let e=Object.assign({fontFamily:F.font},hC),i=new yt(t,b.from("btn-blue"),e);i.text.position.set(-5,40);let s=new C(b.from(r));return s.anchor.set(.5),s.y=-60,i.addChild(s),i}var cC={bg:{on:"btn-green-2",off:"btn-blue-disabled"}},un=class extends I{bg;icon;_toggledOn=!0;textures;constructor(t,e){super(),this.textures=Object.assign({},cC,t),this.bg=new C,this.bg.anchor.set(.5),this.icon=new C,this.icon.anchor.set(.5),this.eventMode="static",this.on("pointerdown",()=>{ot.emit("BUTTON_PRESS"),this.setState(!this.toggledOn),ot.emit(e,this.toggledOn)}),this.addChild(this.bg),this.addChild(this.icon),this.setState(!0)}setState(t){this._toggledOn=t,this.updateTextures(this._toggledOn),this.icon.tint=this._toggledOn?84798:2576510}updateTextures(t){this.bg.texture=b.from(t?this.textures.bg.on:this.textures.bg.off),this.icon.texture=b.from(t?this.textures.icon.on:this.textures.icon.off)}get toggledOn(){return this._toggledOn}};var Cl=class extends I{overlay;bg;title;labelMusic;toggleMusic;labelSounds;toggleSounds;btnClose;btnRestart;btnHome;constructor(t,e){super(),this.overlay=new Ds,this.bg=new C(b.from("panel-settings")),this.bg.anchor.set(.5),this.title=new J(F.getText("Settings").toUpperCase(),{fontFamily:F.font,fontSize:54,fill:16777215}),this.title.anchor.set(.5),this.labelMusic=new J(F.getText("Music").toUpperCase(),{fontFamily:F.font,fontSize:48,fill:16777215}),this.labelMusic.anchor.set(.5),this.labelSounds=new J(F.getText("Sounds").toUpperCase(),{fontFamily:F.font,fontSize:48,fill:16777215}),this.labelSounds.anchor.set(.5),this.toggleMusic=new un({icon:{on:"icon-music",off:"icon-music"}},"MUSIC_TOGGLE"),this.toggleMusic.setState(t.music),this.toggleSounds=new un({icon:{on:"icon-sounds",off:"icon-sounds"}},"SOUNDS_TOGGLE"),this.toggleSounds.setState(t.sounds),this.btnClose=new yt("",b.from("icon-close")),this.btnClose.on("pointerdown",()=>{this.parent.removeChild(this)}),this.btnRestart=new yt(F.getText("Restart").toUpperCase(),b.from("btn-orange-3"),{fontFamily:F.font,fontSize:54,fill:7483392}),this.btnHome=new yt(F.getText("Home").toUpperCase(),b.from("btn-orange"),{fontFamily:F.font,fontSize:54,fill:65792}),this.positionElements(e),this.addChild(this.overlay),this.addChild(this.bg),this.addChild(this.title),this.addChild(this.labelMusic),this.addChild(this.toggleMusic),this.addChild(this.labelSounds),this.addChild(this.toggleSounds),this.addChild(this.btnClose),this.addChild(this.btnRestart),this.addChild(this.btnHome)}positionElements(t){this.title.position.set(0,-270),this.btnClose.position.set(280,-300),this.labelMusic.position.set(-140,t?-150:-50),this.labelSounds.position.set(140,t?-150:-50),this.toggleMusic.position.set(-140,t?0:130),this.toggleSounds.position.set(140,t?0:130),this.btnRestart.visible=t,this.btnHome.visible=t,this.btnRestart.position.set(0,220),this.btnHome.position.set(0,500)}};var dn=class extends I{game;road;header;leaderboard;bottomShadow;repCounter;moneyCounter;settingsButton;raceButton;garageButton;moreGamesButton;constructor(t,e){super(),this.game=t,this.header=new C(b.from("panel-header")),this.header.anchor.set(.5,0),this.leaderboard=new za,this.leaderboard.visible=!1,this.game.leaderboardsManager&&this.game.leaderboardsManager.getLeaderboardEntries(tr.name,tr.rows).then(s=>{this.leaderboard.visible=!0;let o=[];s.userRank>tr.rows?(o=s.entries.slice(0,tr.rows),o.push(s.entries.find(n=>n.rank==s.userRank))):o=s.entries,this.leaderboard.displayEntries(o,s.userRank)}).catch(s=>{console.error("Error when fetching lb entries",s)}),this.repCounter=new ks,this.repCounter.updateValue(e.data.reputation),this.moneyCounter=new Ht("Money"),this.moneyCounter.updateValue(e.data.money),this.settingsButton=new yt("",b.from("btn-settings")),this.settingsButton.on("pointerdown",()=>{let s=new Cl(e.data,!1);s.position.set(P.width/2,P.height/2),this.addChild(s)}),this.road=new Ns,this.raceButton=Da(),this.raceButton.on("pointerdown",()=>{new at(this.raceButton).to({y:-this.raceButton.height},300).easing(it.Back.In).start(),new at(this.garageButton).to({y:P.height+this.garageButton.height},300).easing(it.Back.In).start(),new at(this.moreGamesButton).to({y:P.height+this.garageButton.height},300).easing(it.Back.In).start(),new at(this.bottomShadow).to({alpha:0},300).easing(it.Quadratic.In).onComplete(()=>{ot.emit("START_RACE",this.road)}).start()}),this.garageButton=ju("icon-upgrade",F.getText("Upgrade")),this.garageButton.on("pointerdown",()=>{this.game.audio.playSound("ui_menu_whoosh"),ot.emit("START_GARAGE")}),Oa.map(s=>Cs.getPrice(e.data.selectedCar,e.getCarUpgrade(s),s)).filter(s=>s>0&&s<=e.data.money).length>0&&new at(this.garageButton).to({alpha:.7},300).yoyo().easing(it.Quadratic.InOut).repeat(1/0).start(),this.moreGamesButton=ju("icon-more-games",F.getText("More games")),this.moreGamesButton.on("pointerdown",()=>{this.game.audio.playSound("ui_menu_whoosh"),jr.showMoreGames()}),this.bottomShadow=new Ts("shadow"),this.addChild(this.road),this.addChild(this.bottomShadow),this.addChild(this.header),this.addChild(this.repCounter),this.addChild(this.moneyCounter),this.addChild(this.settingsButton),this.addChild(this.leaderboard),this.addChild(this.raceButton),this.addChild(this.garageButton),this.addChild(this.moreGamesButton),this.positionElements(),this.game.ticker.add(this.update,this)}positionElements(){this.header.position.set(P.width/2,0),this.settingsButton.position.set(P.width-this.settingsButton.width-20,this.header.height/2),this.repCounter.position.set(250,this.header.height/2),this.moneyCounter.position.set(P.width/2+200,this.header.height/2),this.road.pivot.x=-this.road.width/2,this.bottomShadow.position.set(P.width/2,P.height-this.bottomShadow.height),this.leaderboard.position.set(P.width/2,400),this.leaderboard.scale.set(this.leaderboard.width/this.road.width),this.raceButton.position.set(P.width/2,1300),this.garageButton.position.set(P.width/2-170,1700),this.moreGamesButton.position.set(P.width/2+170,1700)}update(){ui.shared.update(this.game.ticker.deltaMS),this.road.update(this.game.ticker.deltaMS/mt.timeDilation)}destroy(t){this.game.ticker.remove(this.update,this),super.destroy(t)}};var It={forceLocale:void 0,exposePIXI:!1,disablePlayerGun:!1,manualRaceEnd:!1,cheats:!1,freeUpgrades:!1,noRevive:!1,disableShadows:!1,weakBosses:!0,playerInvulnerable:!0},P={width:1080,height:1920},Sl=class extends ca{scene;progress;audio;leaderboardsManager;adsManager;isInitialised=!1;constructor(){super({view:document.getElementById("pixi-canvas"),resolution:window.devicePixelRatio||1,width:P.width,height:P.height,autoDensity:!0,backgroundColor:0})}init(){this.isInitialised||(this.progress=new Ca,console.log(`music on: ${this.progress.data.music}, sound on: ${this.progress.data.sounds}`),this.audio=new wa,this.audio.init(this.progress.data.sounds,this.progress.data.music),window.addEventListener("blur",()=>{this.audio.setMusicEnabled(!1,"AppPaused"),this.audio.setSoundEnabled(!1,"AppPaused")}),window.addEventListener("focus",()=>{this.audio.setMusicEnabled(!0,"AppPaused"),this.audio.setSoundEnabled(!0,"AppPaused")}),ot.on("BUTTON_PRESS",()=>{this.audio.playSound("ui_click_1")}),ot.on("MUSIC_TOGGLE",t=>{this.audio.setMusicEnabled(t,"UserAction"),this.progress.data.music=t,this.progress.saveLocal()}),ot.on("SOUNDS_TOGGLE",t=>{this.audio.setSoundEnabled(t,"UserAction"),this.progress.data.sounds=t,this.progress.saveLocal()}),ot.on("AD_STARTED",()=>{this.audio.setMusicEnabled(!1,"AdPlaying"),this.audio.setSoundEnabled(!1,"AdPlaying")}),ot.on("AD_FINISHED",()=>{this.audio.setMusicEnabled(!0,"AdPlaying"),this.audio.setSoundEnabled(!0,"AdPlaying")}),It.cheats&&document.addEventListener("keydown",this.cheats.bind(this)),this.switchScene(new dn(this,this.progress)),this.audio.playMusic("calm"),ot.on("START_RACE",t=>{jr.showPopup("onLevelStart",()=>{this.switchScene(new Tl(this,this.progress,t)),this.audio.setMusicContext("active")})}),ot.on("START_GARAGE",()=>{this.switchScene(new Na(this,this.progress)),this.audio.setMusicContext("calm")}),ot.on("START_MENU",()=>{this.switchScene(new dn(this,this.progress)),this.audio.setMusicContext("calm")}),this.isInitialised=!0)}switchScene(t){this.stage.removeChildren(),this.scene&&this.scene.destroy({children:!0}),this.scene=t,this.onresize(),this.stage.addChild(t)}cheats(t){switch(t.key){case"r":this.progress.reset(),console.log("Game progress dropped",this.progress.data);break;case"m":this.progress.data.money+=1e3,this.progress.saveLocal,console.log(`Free money! ${this.progress.data.money}`);break}}initLeaderboards(t){this.leaderboardsManager=new Ta(t)}initAds(t){this.adsManager=new ua(t)}onresize(){let t=this.getGameScale();this.renderer.resize(P.width*t,P.height*t),this.scene.scale.set(t)}getGameScale(){let t=window.innerHeight/P.height,e=window.innerWidth/P.width;return Math.min(e,t)}};var sy=class pn{constructor(t,e,i=null){this.linkedSheets=[],this._texture=t instanceof b?t:null,this.baseTexture=t instanceof Y?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;let s=this.baseTexture.resource;this.resolution=this._updateResolution(i||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){let{scale:e}=this.data.meta,i=A.getResolutionOfUrl(t,null);return i===null&&(i=parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=pn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t,i=pn.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){let s=this._frameKeys[e],o=this._frames[s],n=o.frame;if(n){let a=null,l=null,h=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,c=new $(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);o.rotated?a=new $(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):a=new $(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(l=new $(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[s]=new b(this.baseTexture,a,c,l,o.rotated?2:0,o.anchor,o.borders),b.addToCache(this.textures[s],s.toString())}e++}}_processAnimations(){let t=this.data.animations||{};for(let e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){let s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){let t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*pn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*pn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(let e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};sy.BATCH_SIZE=1e3;var El=sy;var uC=["jpg","png","jpeg","avif","webp"];function oy(r,t,e){let i={};if(r.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[s]=t.textures[s]}),!e){let s=A.path.dirname(r[0]);t.linkedSheets.forEach((o,n)=>{let a=oy([`${s}/${t.data.meta.related_multi_packs[n]}`],o,!0);Object.assign(i,a)})}return i}var Al={extension:w.Asset,cache:{test:r=>r instanceof El,getCacheableAssets:(r,t)=>oy(r,t,!1)},resolver:{test:r=>{let t=r.split("?")[0].split("."),e=t.pop(),i=t.pop();return e==="json"&&uC.includes(i)},parse:r=>{let t=r.split(".");return{resolution:parseFloat(S.RETINA_PREFIX.exec(r)?.[1]??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:w.LoadParser,priority:Rt.Normal},async testParse(r,t){return A.path.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){let i=A.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let s=i+r.meta.image;s=zo(s,t.src);let o=(await e.load([s]))[s],n=new El(o.baseTexture,r,t.src);await n.parse();let a=r?.meta?.related_multi_packs;if(Array.isArray(a)){let l=[];for(let c of a){if(typeof c!="string")continue;let u=i+c;t.data?.ignoreMultiPack||(u=zo(u,t.src),l.push(e.load({src:u,data:{ignoreMultiPack:!0}})))}let h=await Promise.all(l);n.linkedSheets=h,h.forEach(c=>{c.linkedSheets=[n].concat(n.linkedSheets.filter(u=>u!==c))})}return n},unload(r){r.destroy(!0)}}};T.add(Al);var ny={bundles:[{name:"main",assets:{cars:"./assets/atlases/cars.json",weapons:"./assets/atlases/weapons.json",projectiles:"./assets/atlases/projectiles.json",explosion:"./assets/atlases/explosion.json",pickups:"./assets/atlases/pickups.json",road:"./assets/road.jpg",garage:"./assets/garage.jpg",bg:"./assets/atlases/bg.json",obstacles:"./assets/atlases/obstacles.json",ui:"./assets/atlases/ui.json",rajdhani:"./assets/fonts/rajdhani.ttf",rubik:"./assets/fonts/rubik.ttf",mc:"./assets/atlases/mc.json",hp_loop:"./assets/atlases/hp_loop.json",shield_loop:"./assets/atlases/shield_loop.json",money_loop:"./assets/atlases/money_loop.json"}},{name:"audio",assets:{calm:"./assets/music/calm.mp3",sounds:"./assets/sounds/sounds.mp3",active:"./assets/music/active.mp3"}}]};async function ay(r){T.add(Al),await pe.init({manifest:ny}),await pe.loadBundle("main",r),await pe.loadBundle("audio",r),console.log("assets loaded",pe.cache)}var Vr;jr.setup("CarsNGuns");ay(r=>{}).then(()=>{Vr=new Sl,YaGames.init().then(r=>{r.features.LoadingAPI?.ready(),F.setLocale(It.forceLocale||r.environment.i18n.lang),Vr.initLeaderboards(r),Vr.initAds(r),Vr.adsManager.showInterstitial()}).catch(r=>console.error(r)).finally(()=>{Vr.init(),window.addEventListener("resize",()=>{Vr.onresize()})}),It.exposePIXI&&(globalThis.__PIXI_APP__=Vr)});function iy(){return Vr.screen}})();
/*! Bundled license information:

punycode/punycode.js:
  (*! https://mths.be/punycode v1.4.1 by @mathias *)

tweedle.js/dist/tweedle.es.js:
  (*!
   * tweedle.js - v2.1.0
   * Compiled Wed, 05 Apr 2023 15:21:25 UTC
   *
   * tweedle.js is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   * 
   * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
   *)

@pixi/filter-adjustment/dist/filter-adjustment.mjs:
  (*!
   * @pixi/filter-adjustment - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-adjustment is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-kawase-blur/dist/filter-kawase-blur.mjs:
  (*!
   * @pixi/filter-kawase-blur - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-kawase-blur is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-advanced-bloom/dist/filter-advanced-bloom.mjs:
  (*!
   * @pixi/filter-advanced-bloom - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-advanced-bloom is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-ascii/dist/filter-ascii.mjs:
  (*!
   * @pixi/filter-ascii - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-ascii is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-bevel/dist/filter-bevel.mjs:
  (*!
   * @pixi/filter-bevel - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-bevel is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-bloom/dist/filter-bloom.mjs:
  (*!
   * @pixi/filter-bloom - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-bloom is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-bulge-pinch/dist/filter-bulge-pinch.mjs:
  (*!
   * @pixi/filter-bulge-pinch - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-bulge-pinch is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-color-gradient/dist/filter-color-gradient.mjs:
  (*!
   * @pixi/filter-color-gradient - v5.2.0
   * Compiled Tue, 28 Feb 2023 14:24:35 UTC
   *
   * @pixi/filter-color-gradient is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-color-map/dist/filter-color-map.mjs:
  (*!
   * @pixi/filter-color-map - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-color-map is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-color-overlay/dist/filter-color-overlay.mjs:
  (*!
   * @pixi/filter-color-overlay - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-color-overlay is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-color-replace/dist/filter-color-replace.mjs:
  (*!
   * @pixi/filter-color-replace - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-color-replace is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-convolution/dist/filter-convolution.mjs:
  (*!
   * @pixi/filter-convolution - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-convolution is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-cross-hatch/dist/filter-cross-hatch.mjs:
  (*!
   * @pixi/filter-cross-hatch - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-cross-hatch is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-crt/dist/filter-crt.mjs:
  (*!
   * @pixi/filter-crt - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-crt is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-dot/dist/filter-dot.mjs:
  (*!
   * @pixi/filter-dot - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-dot is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-drop-shadow/dist/filter-drop-shadow.mjs:
  (*!
   * @pixi/filter-drop-shadow - v5.2.0
   * Compiled Tue, 28 Feb 2023 14:24:35 UTC
   *
   * @pixi/filter-drop-shadow is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-emboss/dist/filter-emboss.mjs:
  (*!
   * @pixi/filter-emboss - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-emboss is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-glitch/dist/filter-glitch.mjs:
  (*!
   * @pixi/filter-glitch - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-glitch is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-glow/dist/filter-glow.mjs:
  (*!
   * @pixi/filter-glow - v5.2.1
   * Compiled Fri, 24 Mar 2023 22:12:11 UTC
   *
   * @pixi/filter-glow is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-godray/dist/filter-godray.mjs:
  (*!
   * @pixi/filter-godray - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-godray is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-grayscale/dist/filter-grayscale.mjs:
  (*!
   * @pixi/filter-grayscale - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-grayscale is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-hsl-adjustment/dist/filter-hsl-adjustment.mjs:
  (*!
   * @pixi/filter-hsl-adjustment - v5.2.0
   * Compiled Tue, 28 Feb 2023 14:24:35 UTC
   *
   * @pixi/filter-hsl-adjustment is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-motion-blur/dist/filter-motion-blur.mjs:
  (*!
   * @pixi/filter-motion-blur - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-motion-blur is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-multi-color-replace/dist/filter-multi-color-replace.mjs:
  (*!
   * @pixi/filter-multi-color-replace - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-multi-color-replace is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-old-film/dist/filter-old-film.mjs:
  (*!
   * @pixi/filter-old-film - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-old-film is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-outline/dist/filter-outline.mjs:
  (*!
   * @pixi/filter-outline - v5.2.0
   * Compiled Tue, 28 Feb 2023 14:24:35 UTC
   *
   * @pixi/filter-outline is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-pixelate/dist/filter-pixelate.mjs:
  (*!
   * @pixi/filter-pixelate - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-pixelate is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-radial-blur/dist/filter-radial-blur.mjs:
  (*!
   * @pixi/filter-radial-blur - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-radial-blur is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-reflection/dist/filter-reflection.mjs:
  (*!
   * @pixi/filter-reflection - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-reflection is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-rgb-split/dist/filter-rgb-split.mjs:
  (*!
   * @pixi/filter-rgb-split - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-rgb-split is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-shockwave/dist/filter-shockwave.mjs:
  (*!
   * @pixi/filter-shockwave - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-shockwave is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-simple-lightmap/dist/filter-simple-lightmap.mjs:
  (*!
   * @pixi/filter-simple-lightmap - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-simple-lightmap is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-tilt-shift/dist/filter-tilt-shift.mjs:
  (*!
   * @pixi/filter-tilt-shift - v5.2.0
   * Compiled Tue, 28 Feb 2023 14:24:35 UTC
   *
   * @pixi/filter-tilt-shift is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-twist/dist/filter-twist.mjs:
  (*!
   * @pixi/filter-twist - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-twist is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

@pixi/filter-zoom-blur/dist/filter-zoom-blur.mjs:
  (*!
   * @pixi/filter-zoom-blur - v5.1.1
   * Compiled Wed, 11 Jan 2023 23:10:33 UTC
   *
   * @pixi/filter-zoom-blur is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

pixi-filters/dist/esm/pixi-filters.mjs:
  (*!
   * pixi-filters - v5.2.1
   * Compiled Fri, 24 Mar 2023 22:12:11 UTC
   *
   * pixi-filters is licensed under the MIT License.
   * http://www.opensource.org/licenses/mit-license
   *)

gamefuse/dist/gamefuse.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
